var _=(t,a,e)=>new Promise((u,b)=>{var m=f=>{try{y(e.next(f))}catch(o){b(o)}},g=f=>{try{y(e.throw(f))}catch(o){b(o)}},y=f=>f.done?u(f.value):Promise.resolve(f.value).then(m,g);y((e=e.apply(t,a)).next())});import{B as h,w as Z,a as n,o as i,e as c,b as s,a2 as A,t as p,a6 as D,ae as T,F as j,W as z,_ as E,R as I}from"./vue-vendor-B0shnPjy.js";import{c as L}from"./frappe-ui-DjR51muK.js";const W={class:"relative"},F=["for"],O={key:0,class:"text-red-500"},R={class:"relative"},H=["id","placeholder","required"],Q={key:0,class:"absolute right-3 top-1/2 -translate-y-1/2"},U={key:1,class:"mt-1 text-xs text-gray-500"},G={key:2,class:"mt-1 text-xs text-red-600"},J={key:3,class:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-96 overflow-y-auto"},K={key:0,class:"p-4 text-center text-gray-500"},X={key:1},Y=["onMousedown"],ee={class:"font-medium text-gray-900"},te={key:0,class:"text-sm text-gray-600 mt-1"},se={key:1,class:"text-xs text-gray-500 mt-1"},re={key:2,class:"p-4 text-center text-gray-500"},ae={key:4,class:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg"},le={class:"flex items-start justify-between"},oe={class:"flex-1"},de={class:"text-sm text-green-700 mt-1"},ne={key:0,class:"text-xs text-green-600 mt-1"},ie={key:0},ue={key:1},ce={__name:"AddressLookup",props:{modelValue:{type:Object,default:null},id:{type:String,default:"address-lookup"},label:{type:String,default:"Property Address"},placeholder:{type:String,default:"Start typing address... e.g., 123 Main Street"},description:{type:String,default:"Type to search for addresses in New Zealand"},required:{type:Boolean,default:!1},apiMethod:{type:String,default:"lodgeick.api.search_property_addresses"}},emits:["update:modelValue","address-selected"],setup(t,{expose:a,emit:e}){const u=t,b=e,m=h(""),g=h([]),y=h(!1),f=h(!1),o=h(u.modelValue),v=h("");let k=null;Z(()=>u.modelValue,d=>{o.value=d,d&&(m.value=d.full_address||"")});const S=()=>_(this,null,function*(){k&&clearTimeout(k);const d=m.value.trim();if(v.value="",o.value&&d!==o.value.full_address&&(o.value=null,b("update:modelValue",null)),d.length<3){g.value=[];return}k=setTimeout(()=>_(this,null,function*(){y.value=!0;try{const l=yield q(d);g.value=l||[]}catch(l){console.error("[AddressLookup] Error searching addresses:",l),g.value=[],v.value="Error searching addresses. Please try again."}finally{y.value=!1}}),300)}),q=d=>_(this,null,function*(){try{return(yield L(u.apiMethod,{query:d})).map(r=>{var x,w,V,P,N;return{full_address:r.address||r.full_address,street_address:r.street_address||B(r.address),suburb:r.suburb||r.locality,city:r.city||r.town,postcode:r.postcode||r.postal_code,address_id:r.address_id||r.id,property_id:(x=r.property)==null?void 0:x.parcel_id,legal_description:(w=r.property)==null?void 0:w.legal_description,title_no:(V=r.property)==null?void 0:V.title_no,valuation_reference:(P=r.property)==null?void 0:P.valuation_reference,zone:(N=r.property)==null?void 0:N.zone}})}catch(l){return console.error("[AddressLookup] API error:",l),[]}}),B=d=>{var l;return d?((l=d.split(",")[0])==null?void 0:l.trim())||d:""},C=d=>{o.value=d,m.value=d.full_address,g.value=[],f.value=!1,v.value="",b("update:modelValue",d),b("address-selected",d)},$=()=>{o.value=null,m.value="",g.value=[],v.value="",b("update:modelValue",null),b("address-selected",null)},M=()=>{setTimeout(()=>{f.value=!1},200)};return a({clearAddress:$,selectedAddress:o}),(d,l)=>(i(),n("div",W,[t.label?(i(),n("label",{key:0,for:t.id,class:"block text-sm font-medium text-gray-700 mb-2"},[A(p(t.label)+" ",1),t.required?(i(),n("span",O,"*")):c("",!0)],8,F)):c("",!0),s("div",R,[D(s("input",{id:t.id,"onUpdate:modelValue":l[0]||(l[0]=r=>m.value=r),onInput:S,onFocus:l[1]||(l[1]=r=>f.value=!0),onBlur:M,type:"text",placeholder:t.placeholder,required:t.required,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autocomplete:"off"},null,40,H),[[T,m.value]]),y.value?(i(),n("div",Q,[...l[2]||(l[2]=[s("svg",{class:"animate-spin h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):c("",!0)]),t.description?(i(),n("p",U,p(t.description),1)):c("",!0),v.value?(i(),n("p",G,p(v.value),1)):c("",!0),f.value&&(g.value.length>0||y.value)?(i(),n("div",J,[y.value?(i(),n("div",K,[...l[3]||(l[3]=[s("div",{class:"inline-block animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mb-2"},null,-1),s("p",{class:"text-sm"},"Searching addresses...",-1)])])):(i(),n("div",X,[(i(!0),n(j,null,z(g.value,(r,x)=>(i(),n("button",{key:x,onMousedown:E(w=>C(r),["prevent"]),type:"button",class:"w-full text-left px-4 py-3 hover:bg-blue-50 border-b border-gray-100 last:border-b-0 transition-colors"},[s("div",ee,p(r.full_address),1),r.suburb?(i(),n("div",te,p(r.suburb)+", "+p(r.city),1)):c("",!0),r.address_id?(i(),n("div",se," ID: "+p(r.address_id),1)):c("",!0)],40,Y))),128))])),!y.value&&g.value.length===0&&m.value.length>=3?(i(),n("div",re,[...l[4]||(l[4]=[s("p",{class:"text-sm"},"No addresses found. Try a different search.",-1),s("p",{class:"text-xs mt-2 text-gray-400"},"Make sure to include street number and name",-1)])])):c("",!0)])):c("",!0),o.value?(i(),n("div",ae,[s("div",le,[s("div",oe,[l[5]||(l[5]=s("p",{class:"text-sm font-medium text-green-900"},"Selected Address",-1)),s("p",de,p(o.value.full_address),1),o.value.suburb||o.value.city?(i(),n("div",ne,[o.value.suburb?(i(),n("span",ie,p(o.value.suburb)+", ",1)):c("",!0),s("span",null,p(o.value.city),1),o.value.postcode?(i(),n("span",ue,p(o.value.postcode),1)):c("",!0)])):c("",!0)]),s("button",{onClick:$,type:"button",class:"text-green-600 hover:text-green-700 ml-2",title:"Clear selection"},[...l[6]||(l[6]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])])):c("",!0)]))}},me={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},fe={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},pe={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},ge={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ye={class:"space-y-4"},be=["value"],ve={class:"flex items-center"},he=["checked"],xe={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse gap-2"},$e={__name:"AddPropertyModal",props:{show:{type:Boolean,required:!0},propertyName:{type:String,default:""},selectedPropertyAddress:{type:Object,default:null},isDefault:{type:Boolean,default:!1}},emits:["close","update:propertyName","update:isDefault","property-address-selected","add-property"],setup(t){return(a,e)=>t.show?(i(),n("div",me,[s("div",fe,[s("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:e[0]||(e[0]=u=>a.$emit("close"))}),s("div",pe,[s("div",ge,[e[8]||(e[8]=s("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Add Property",-1)),s("div",ye,[s("div",null,[e[6]||(e[6]=s("label",{for:"property_name_agent",class:"block text-sm font-medium text-gray-700 mb-2"},[A(" Property Name "),s("span",{class:"text-red-500"},"*")],-1)),s("input",{id:"property_name_agent",value:t.propertyName,onInput:e[1]||(e[1]=u=>a.$emit("update:propertyName",u.target.value)),type:"text",required:"",placeholder:"e.g., Office, Client Property A, Development Site",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,be)]),s("div",null,[I(ce,{modelValue:t.selectedPropertyAddress,id:"property_address_modal_agent",label:"Property Address",placeholder:"Start typing the property address...",description:"Search for the property address in New Zealand",required:!0,onAddressSelected:e[2]||(e[2]=u=>a.$emit("property-address-selected",u))},null,8,["modelValue"])]),s("div",null,[s("label",ve,[s("input",{checked:t.isDefault,onChange:e[3]||(e[3]=u=>a.$emit("update:isDefault",u.target.checked)),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,40,he),e[7]||(e[7]=s("span",{class:"ml-2 text-sm text-gray-700"},"Set as default property",-1))])])])]),s("div",xe,[s("button",{type:"button",onClick:e[4]||(e[4]=u=>a.$emit("add-property")),class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"}," Add Property "),s("button",{type:"button",onClick:e[5]||(e[5]=u=>a.$emit("close")),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm"}," Cancel ")])])])])):c("",!0)}};function Ve(t){if(!t||t.trim()==="")return{isValid:!1,message:"Phone number is required",formatted:""};const a=t.replace(/[\s\-()]/g,"");a.startsWith("+64")||a.startsWith("0064");let e=a;if(a.startsWith("+64")?e="0"+a.substring(3):a.startsWith("0064")&&(e="0"+a.substring(4)),!/^[0-9]+$/.test(e))return{isValid:!1,message:"Phone number should contain only numbers, spaces, hyphens, or parentheses",formatted:""};if(/^0(2[1278]|29)[0-9]{6,8}$/.test(e))return{isValid:!0,message:"",formatted:e.replace(/^(0\d{2})(\d{3})(\d{4})$/,"$1 $2 $3")};if(/^0[3-9][0-9]{7,8}$/.test(e)){if(e.length===9)return{isValid:!0,message:"",formatted:e.replace(/^(0\d)(\d{3})(\d{4})$/,"$1 $2 $3")};if(e.length===10)return{isValid:!0,message:"",formatted:e.replace(/^(0\d)(\d{3})(\d{5})$/,"$1 $2 $3")}}return e.length<9?{isValid:!1,message:"Phone number is too short. NZ phone numbers are 9-10 digits.",formatted:""}:e.length>11?{isValid:!1,message:"Phone number is too long. NZ phone numbers are 9-10 digits.",formatted:""}:{isValid:!1,message:"Invalid NZ phone number. Mobile numbers start with 02, landlines with 03-09.",formatted:""}}function Pe(t){return!t||t.trim()===""?{isValid:!1,message:"Email address is required"}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?{isValid:!0,message:""}:{isValid:!1,message:"Please enter a valid email address"}}function Ne(t){if(!t||t.trim()==="")return{isValid:!0,message:""};const a=t.replace(/[\s\-]/g,"");return/^\d{13}$/.test(a)?{isValid:!0,message:""}:{isValid:!1,message:"NZBN must be exactly 13 digits"}}function Ae(t){if(!t||t.trim()==="")return{isValid:!1,message:"Password is required",strength:"none"};if(t.length<8)return{isValid:!1,message:"Password must be at least 8 characters long",strength:"weak"};let a="weak",e=0;return t.length>=12&&e++,/[A-Z]/.test(t)&&e++,/[a-z]/.test(t)&&e++,/[0-9]/.test(t)&&e++,/[^A-Za-z0-9]/.test(t)&&e++,e>=4?a="strong":e>=2&&(a="medium"),{isValid:!0,message:"",strength:a}}export{$e as _,Pe as a,Ae as b,ce as c,Ne as d,Ve as v};
//# sourceMappingURL=validation-C80dm2Yt.js.map
