{"version":3,"mappings":"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","names":["_createElementBlock","_createVNode","_component_router_view","userResource","createResource","error","router","sessionUser","_sessionUser","session","reactive","email","password","__async","call","computed","routes","__vitePreload","n","createRouter","createWebHistory","to","from","next","isLoggedIn","socket","socketInitializationFailed","initSocket","host","siteName","port","socketio_port","url","io","get","obj","path","value","i","set","idx","unset","result","p","deepPick","paths","acc","cur","deepOmit","hydrateStore","store","storage","serializer","key","debug","pick","omit","beforeHydrate","afterHydrate","context","runHooks","fromStorage","deserialized","picked","omitted","persistState","state","toStorage","parsePersistKey","storeId","createPersistence","optionsParser","auto","pinia","persist","originalStore","persistences","_mutation","createPersistedState","options","persistKey","x","_b","_a","_d","_c","data","_f","_e","_g","_h","src_default","globalComponents","Button","TextInput","Input","FormControl","ErrorMessage","Dialog","Alert","Badge","app","createApp","App","createPinia","piniaPluginPersistedstate","setConfig","frappeRequest","resourcesPlugin","pageMetaPlugin","initApp","csrfFromCookie","row","csrfAfterFetch"],"ignoreList":[5],"sources":["../../../../frontend/src/App.vue","../../../../frontend/src/data/user.js","../../../../frontend/src/data/session.js","../../../../frontend/src/router.js","../../../../frontend/src/socket.js","../../../../frontend/node_modules/pinia-plugin-persistedstate/dist/index.js","../../../../frontend/src/main.js"],"sourcesContent":["<template>\n  <div>\n    <router-view />\n  </div>\n</template>\n","import router from \"@/router\"\nimport { createResource } from \"frappe-ui\"\n\nexport const userResource = createResource({\n\turl: \"frappe.auth.get_logged_user\",\n\tcache: \"User\",\n\tonError(error) {\n\t\tif (error && error.exc_type === \"AuthenticationError\") {\n\t\t\trouter.push({ name: \"LoginPage\" })\n\t\t}\n\t},\n})\n","import router from \"@/router\"\nimport { call, createResource } from \"frappe-ui\"\nimport { computed, reactive } from \"vue\"\n\nimport { userResource } from \"./user\"\n\nexport function sessionUser() {\n\tconst cookies = new URLSearchParams(document.cookie.split(\"; \").join(\"&\"))\n\tlet _sessionUser = cookies.get(\"user_id\")\n\tif (_sessionUser === \"Guest\") {\n\t\t_sessionUser = null\n\t}\n\treturn _sessionUser\n}\n\nexport const session = reactive({\n\tlogin: createResource({\n\t\turl: \"login\",\n\t\tmakeParams({ email, password }) {\n\t\t\treturn {\n\t\t\t\tusr: email,\n\t\t\t\tpwd: password,\n\t\t\t}\n\t\t},\n\t\tasync onSuccess() {\n\t\t\tuserResource.reload()\n\t\t\tsession.user = sessionUser()\n\t\t\tsession.login.reset()\n\n\t\t\t// Track login event for analytics\n\t\t\ttry {\n\t\t\t\tawait call(\"lodgeick.api.track_login_event\", {\n\t\t\t\t\tsource: \"web\",\n\t\t\t\t})\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Failed to track login event:\", error)\n\t\t\t\t// Don't block login if tracking fails\n\t\t\t}\n\n\t\t\t// Always redirect to main dashboard (single-tenant)\n\t\t\trouter.replace({ name: \"Dashboard\" })\n\t\t},\n\t}),\n\tlogout: createResource({\n\t\turl: \"logout\",\n\t\tonSuccess() {\n\t\t\tuserResource.reset()\n\t\t\tsession.user = sessionUser()\n\t\t\trouter.replace({ name: \"Login\" })\n\t\t},\n\t}),\n\tuser: sessionUser(),\n\tisLoggedIn: computed(() => !!session.user),\n})\n","import { userResource } from \"@/data/user\"\nimport { createRouter, createWebHistory } from \"vue-router\"\nimport { session } from \"./data/session\"\n\nconst routes = [\n\t{\n\t\tpath: \"/\",\n\t\tname: \"Landing\",\n\t\tcomponent: () => import(\"@/pages/Landing.vue\"),\n\t\tmeta: { public: true },\n\t},\n\t{\n\t\tpath: \"/dashboard\",\n\t\tname: \"Dashboard\",\n\t\tcomponent: () => import(\"@/pages/Dashboard.vue\"),\n\t},\n\t{\n\t\tpath: \"/home\",\n\t\tname: \"Home\",\n\t\tcomponent: () => import(\"@/pages/Home.vue\"),\n\t},\n\t{\n\t\tpath: \"/request/new\",\n\t\tname: \"NewRequest\",\n\t\tcomponent: () => import(\"@/pages/NewRequest.vue\"),\n\t\tmeta: { public: true },\n\t},\n\t{\n\t\tpath: \"/request/:id\",\n\t\tname: \"RequestDetail\",\n\t\tcomponent: () => import(\"@/pages/RequestDetail.vue\"),\n\t},\n\t{\n\t\tpath: \"/internal\",\n\t\tname: \"InternalRequestManagement\",\n\t\tcomponent: () => import(\"@/pages/InternalRequestManagement.vue\"),\n\t},\n\t{\n\t\tpath: \"/internal/request/:id\",\n\t\tname: \"InternalRequestDetail\",\n\t\tcomponent: () => import(\"@/pages/InternalRequestDetail.vue\"),\n\t},\n\t{\n\t\tpath: \"/settings\",\n\t\tname: \"Settings\",\n\t\tcomponent: () => import(\"@/pages/Settings.vue\"),\n\t},\n\t{\n\t\tpath: \"/admin/request-type-builder\",\n\t\tname: \"RequestTypeBuilder\",\n\t\tcomponent: () => import(\"@/pages/RequestTypeBuilder.vue\"),\n\t\tmeta: { requiresAdmin: true },\n\t},\n\t{\n\t\tpath: \"/admin/assessment-template-builder\",\n\t\tname: \"AssessmentTemplateBuilder\",\n\t\tcomponent: () => import(\"@/pages/AssessmentTemplateBuilder.vue\"),\n\t\tmeta: { requiresAdmin: true },\n\t},\n\t{\n\t\tpath: \"/admin/assessment-template-builder/:id\",\n\t\tname: \"AssessmentTemplateBuilderEdit\",\n\t\tcomponent: () => import(\"@/pages/AssessmentTemplateBuilder.vue\"),\n\t\tmeta: { requiresAdmin: true },\n\t},\n\t{\n\t\tpath: \"/company\",\n\t\tname: \"CompanyManagement\",\n\t\tcomponent: () => import(\"@/pages/CompanyManagement.vue\"),\n\t},\n\t{\n\t\tname: \"Login\",\n\t\tpath: \"/account/login\",\n\t\tcomponent: () => import(\"@/pages/Login.vue\"),\n\t\tmeta: { public: true },\n\t},\n\t{\n\t\tname: \"Register\",\n\t\tpath: \"/account/register\",\n\t\tcomponent: () => import(\"@/pages/Register.vue\"),\n\t\tmeta: { public: true },\n\t},\n\t{\n\t\tname: \"CompanyRegistration\",\n\t\tpath: \"/account/register-company\",\n\t\tcomponent: () => import(\"@/pages/CompanyRegistration.vue\"),\n\t\tmeta: { public: true },\n\t},\n]\n\nconst router = createRouter({\n\thistory: createWebHistory(\"/frontend\"),\n\troutes,\n})\n\nrouter.beforeEach(async (to, from, next) => {\n\t// Allow public pages without authentication\n\tif (to.meta.public) {\n\t\tnext()\n\t\treturn\n\t}\n\n\tlet isLoggedIn = session.isLoggedIn\n\ttry {\n\t\tawait userResource.promise\n\t} catch (error) {\n\t\tisLoggedIn = false\n\t}\n\n\tif (to.name === \"Login\" && isLoggedIn) {\n\t\tnext({ name: \"Dashboard\" })\n\t} else if (to.name !== \"Login\" && !isLoggedIn) {\n\t\tnext({ name: \"Login\" })\n\t} else {\n\t\tnext()\n\t}\n})\n\nexport default router\n","import { io } from \"socket.io-client\"\nimport { socketio_port } from \"../../../../sites/common_site_config.json\"\n\nlet socket = null\nlet socketInitializationFailed = false\n\nexport function initSocket() {\n\t// Don't retry if initialization already failed\n\tif (socketInitializationFailed) {\n\t\tconsole.warn(\n\t\t\t\"[Socket.io] Skipping initialization - socketio server not available\",\n\t\t)\n\t\treturn null\n\t}\n\n\ttry {\n\t\tconst host = window.location.hostname\n\t\tconst siteName = window.site_name\n\t\tconst port = window.location.port ? `:${socketio_port}` : \"\"\n\t\tconst protocol = port ? \"http\" : \"https\"\n\t\tconst url = `${protocol}://${host}${port}/${siteName}`\n\n\t\tsocket = io(url, {\n\t\t\twithCredentials: true,\n\t\t\treconnectionAttempts: 3,\n\t\t\treconnectionDelay: 2000,\n\t\t\ttimeout: 5000,\n\t\t})\n\n\t\t// Handle connection errors gracefully\n\t\tsocket.on(\"connect_error\", (error) => {\n\t\t\tconsole.warn(\n\t\t\t\t\"[Socket.io] Connection failed - real-time features disabled:\",\n\t\t\t\terror.message,\n\t\t\t)\n\t\t\tsocketInitializationFailed = true\n\t\t\tif (socket) {\n\t\t\t\tsocket.close()\n\t\t\t\tsocket = null\n\t\t\t}\n\t\t})\n\n\t\tsocket.on(\"connect\", () => {\n\t\t\tconsole.log(\"[Socket.io] Connected successfully\")\n\t\t\tsocketInitializationFailed = false\n\t\t})\n\n\t\treturn socket\n\t} catch (error) {\n\t\tconsole.warn(\"[Socket.io] Initialization error:\", error)\n\t\tsocketInitializationFailed = true\n\t\treturn null\n\t}\n}\n\nexport function useSocket() {\n\treturn socket\n}\n","//#region src/runtime/utils.ts\nfunction get(obj, path) {\n\tif (obj == null) return void 0;\n\tlet value = obj;\n\tfor (let i = 0; i < path.length; i++) {\n\t\tif (value === void 0 || value[path[i]] === void 0) return void 0;\n\t\tif (value === null || value[path[i]] === null) return null;\n\t\tvalue = value[path[i]];\n\t}\n\treturn value;\n}\nfunction set(obj, value, path) {\n\tif (path.length === 0) return value;\n\tconst idx = path[0];\n\tif (path.length > 1) value = set(typeof obj !== \"object\" || obj === null || !Object.prototype.hasOwnProperty.call(obj, idx) ? Number.isInteger(Number(path[1])) ? [] : {} : obj[idx], value, Array.prototype.slice.call(path, 1));\n\tif (Number.isInteger(Number(idx)) && Array.isArray(obj)) return obj.slice()[idx];\n\treturn Object.assign({}, obj, { [idx]: value });\n}\nfunction unset(obj, path) {\n\tif (obj == null || path.length === 0) return obj;\n\tif (path.length === 1) {\n\t\tif (obj == null) return obj;\n\t\tif (Number.isInteger(path[0]) && Array.isArray(obj)) return Array.prototype.slice.call(obj, 0).splice(path[0], 1);\n\t\tconst result = {};\n\t\tfor (const p in obj) result[p] = obj[p];\n\t\tdelete result[path[0]];\n\t\treturn result;\n\t}\n\tif (obj[path[0]] == null) {\n\t\tif (Number.isInteger(path[0]) && Array.isArray(obj)) return Array.prototype.concat.call([], obj);\n\t\tconst result = {};\n\t\tfor (const p in obj) result[p] = obj[p];\n\t\treturn result;\n\t}\n\treturn set(obj, unset(obj[path[0]], Array.prototype.slice.call(path, 1)), [path[0]]);\n}\nfunction deepPick(obj, paths) {\n\treturn paths.map((p) => p.split(\".\")).map((p) => [p, get(obj, p)]).filter((t) => t[1] !== void 0).reduce((acc, cur) => set(acc, cur[1], cur[0]), {});\n}\nfunction deepOmit(obj, paths) {\n\treturn paths.map((p) => p.split(\".\")).reduce((acc, cur) => unset(acc, cur), obj);\n}\n\n//#endregion\n//#region src/runtime/core.ts\nfunction hydrateStore(store, { storage, serializer, key, debug, pick, omit, beforeHydrate, afterHydrate }, context, runHooks = true) {\n\ttry {\n\t\tif (runHooks) beforeHydrate?.(context);\n\t\tconst fromStorage = storage.getItem(key);\n\t\tif (fromStorage) {\n\t\t\tconst deserialized = serializer.deserialize(fromStorage);\n\t\t\tconst picked = pick ? deepPick(deserialized, pick) : deserialized;\n\t\t\tconst omitted = omit ? deepOmit(picked, omit) : picked;\n\t\t\tstore.$patch(omitted);\n\t\t}\n\t\tif (runHooks) afterHydrate?.(context);\n\t} catch (error) {\n\t\tif (debug) console.error(\"[pinia-plugin-persistedstate]\", error);\n\t}\n}\nfunction persistState(state, { storage, serializer, key, debug, pick, omit }) {\n\ttry {\n\t\tconst picked = pick ? deepPick(state, pick) : state;\n\t\tconst omitted = omit ? deepOmit(picked, omit) : picked;\n\t\tconst toStorage = serializer.serialize(omitted);\n\t\tstorage.setItem(key, toStorage);\n\t} catch (error) {\n\t\tif (debug) console.error(\"[pinia-plugin-persistedstate]\", error);\n\t}\n}\nfunction parsePersistKey(key, storeId) {\n\treturn typeof key === \"function\" ? key(storeId) : typeof key === \"string\" ? key : storeId;\n}\nfunction createPersistence(context, optionsParser, auto) {\n\tconst { pinia, store, options: { persist = auto } } = context;\n\tif (!persist) return;\n\t// v8 ignore if -- @preserve\n\tif (!(store.$id in pinia.state.value)) {\n\t\tconst originalStore = pinia._s.get(store.$id.replace(\"__hot:\", \"\"));\n\t\tif (originalStore) Promise.resolve().then(() => originalStore.$persist());\n\t\treturn;\n\t}\n\tconst persistences = (Array.isArray(persist) ? persist : persist === true ? [{}] : [persist]).map(optionsParser);\n\tstore.$hydrate = ({ runHooks = true } = {}) => {\n\t\tpersistences.forEach((p) => {\n\t\t\thydrateStore(store, p, context, runHooks);\n\t\t});\n\t};\n\tstore.$persist = () => {\n\t\tpersistences.forEach((p) => {\n\t\t\tpersistState(store.$state, p);\n\t\t});\n\t};\n\tpersistences.forEach((p) => {\n\t\thydrateStore(store, p, context);\n\t\tstore.$subscribe((_mutation, state) => persistState(state, p), { detached: true });\n\t});\n}\n\n//#endregion\n//#region src/index.ts\n/**\n* Create a Pinia persistence plugin.\n* @see https://codeberg.org/praz/pinia-plugin-persistedstate\n*/\nfunction createPersistedState(options = {}) {\n\treturn function(context) {\n\t\tcreatePersistence(context, (p) => {\n\t\t\tconst persistKey = parsePersistKey(p.key, context.store.$id);\n\t\t\treturn {\n\t\t\t\tkey: (options.key ? options.key : (x) => x)(persistKey),\n\t\t\t\tdebug: p.debug ?? options.debug ?? false,\n\t\t\t\tserializer: p.serializer ?? options.serializer ?? {\n\t\t\t\t\tserialize: (data) => JSON.stringify(data),\n\t\t\t\t\tdeserialize: (data) => JSON.parse(data)\n\t\t\t\t},\n\t\t\t\tstorage: p.storage ?? options.storage ?? window.localStorage,\n\t\t\t\tbeforeHydrate: p.beforeHydrate ?? options.beforeHydrate,\n\t\t\t\tafterHydrate: p.afterHydrate ?? options.afterHydrate,\n\t\t\t\tpick: p.pick,\n\t\t\t\tomit: p.omit\n\t\t\t};\n\t\t}, options.auto ?? false);\n\t};\n}\n/**\n* Pinia plugin to persist stores.\n* @see https://codeberg.org/praz/pinia-plugin-persistedstate\n*/\nvar src_default = createPersistedState();\n\n//#endregion\nexport { createPersistedState, src_default as default };","import { createPinia } from \"pinia\"\nimport { createApp } from \"vue\"\n\nimport App from \"./App.vue\"\nimport router from \"./router\"\nimport { initSocket } from \"./socket\"\n\nimport {\n\tAlert,\n\tBadge,\n\tButton,\n\tDialog,\n\tErrorMessage,\n\tFormControl,\n\tInput,\n\tTextInput,\n\tfrappeRequest,\n\tpageMetaPlugin,\n\tresourcesPlugin,\n\tsetConfig,\n} from \"frappe-ui\"\n\nimport \"./index.css\"\n\nconst globalComponents = {\n\tButton,\n\tTextInput,\n\tInput,\n\tFormControl,\n\tErrorMessage,\n\tDialog,\n\tAlert,\n\tBadge,\n}\n\nconst app = createApp(App)\nconst pinia = createPinia()\n\n// Add Pinia persistence plugin\nimport piniaPluginPersistedstate from 'pinia-plugin-persistedstate'\npinia.use(piniaPluginPersistedstate)\n\nsetConfig(\"resourceFetcher\", frappeRequest)\n\napp.use(pinia)\napp.use(router)\napp.use(resourcesPlugin)\napp.use(pageMetaPlugin)\n\n// Initialize CSRF token before mounting\nasync function initApp() {\n\t// Check if CSRF token is already in boot data (injected by backend)\n\tif (window.csrf_token) {\n\t\tconsole.log('[main.js] ✅ CSRF token loaded from boot data')\n\t} else {\n\t\t// Fallback: try to get from cookies\n\t\tconsole.log('[main.js] No boot CSRF token, trying cookies...')\n\t\tconst csrfFromCookie = document.cookie.split('; ').find(row => row.startsWith('csrf_token='))\n\n\t\tif (csrfFromCookie) {\n\t\t\twindow.csrf_token = csrfFromCookie.split('=')[1]\n\t\t\tconsole.log('[main.js] ✅ CSRF token found in cookies')\n\t\t} else {\n\t\t\t// Final fallback: fetch from API\n\t\t\ttry {\n\t\t\t\tconsole.log('[main.js] Fetching CSRF token from API...')\n\t\t\t\tconst response = await fetch('/api/method/frappe.auth.get_logged_user', {\n\t\t\t\t\tcredentials: 'include'\n\t\t\t\t})\n\n\t\t\t\tif (response.ok) {\n\t\t\t\t\t// Check cookies again after API call\n\t\t\t\t\tconst csrfAfterFetch = document.cookie.split('; ').find(row => row.startsWith('csrf_token='))\n\t\t\t\t\tif (csrfAfterFetch) {\n\t\t\t\t\t\twindow.csrf_token = csrfAfterFetch.split('=')[1]\n\t\t\t\t\t\tconsole.log('[main.js] ✅ CSRF token set after API fetch')\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn('[main.js] ⚠️ No CSRF token available')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('[main.js] ❌ Could not fetch CSRF token:', error)\n\t\t\t}\n\t\t}\n\t}\n\n\tconst socket = initSocket()\n\tapp.config.globalProperties.$socket = socket\n\n\tfor (const key in globalComponents) {\n\t\tapp.component(key, globalComponents[key])\n\t}\n\n\tapp.mount(\"#app\")\n}\n\ninitApp()\n"],"file":"assets/index-DdsHFTRi.js"}