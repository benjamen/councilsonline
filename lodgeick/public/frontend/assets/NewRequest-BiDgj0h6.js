const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SaveDraftModal-oGpggCl4.js","assets/frappe-ui-E4oUKPDc.js","assets/vue-vendor-D9RCx05D.js","assets/ui-components-88qJBhde.js","assets/frappe-ui-BcYQ_VTL.css","assets/ValidationErrorModal-CCRGsN7_.js","assets/BookMeetingModal-xTVIUdDO.js","assets/SubmissionSuccessModal-B0tA-oV4.js","assets/SubmissionSuccessModal-ydH3POPv.css","assets/DynamicStepRenderer-VkOY7kMr.js","assets/request.service-91aYHjAe.js","assets/RequestHeader-CAKatJu2.js","assets/index-K6MExjoD.js","assets/index-CPJozdnU.css","assets/DynamicStepRenderer-vBu3IAGa.css"])))=>i.map(i=>d[i]);
var Ce=Object.defineProperty,Te=Object.defineProperties;var De=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var re=(e,s,o)=>s in e?Ce(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o,ae=(e,s)=>{for(var o in s||(s={}))Re.call(s,o)&&re(e,o,s[o]);if(ie)for(var o of ie(s))$e.call(s,o)&&re(e,o,s[o]);return e},le=(e,s)=>Te(e,De(s));var T=(e,s,o)=>new Promise((u,v)=>{var y=g=>{try{f(o.next(g))}catch(w){v(w)}},m=g=>{try{f(o.throw(g))}catch(w){v(w)}},f=g=>g.done?u(g.value):Promise.resolve(g.value).then(y,m);f((o=o.apply(e,s)).next())});import{a as ue,i as L,_ as Me,b as B}from"./frappe-ui-E4oUKPDc.js";import{ap as ce,a5 as O,B as D,c as k,aq as Fe,w as Ne,ar as Ae,a as c,o as r,b as t,Q as Pe,t as b,O as I,e as h,P as R,a2 as $,u as l,ab as de,F as j,W as G,n as P,aj as z,D as Ie,R as A,as as E,y as J}from"./vue-vendor-D9RCx05D.js";import{r as U}from"./request.service-91aYHjAe.js";import{_ as Le}from"./RequestHeader-CAKatJu2.js";import{s as Be}from"./index-K6MExjoD.js";const H=ce("request",{persist:{key:"requestStore",storage:localStorage,paths:["currentRequestId","formData","currentStep","requestTypeCode"]},state:()=>({currentRequestId:null,requestTypeCode:null,requestTypeConfig:null,formData:{},currentStep:0,stepValidationStatus:{},isSaving:!1,isSubmitting:!1,lastSaved:null,error:null}),getters:{isFirstStep:e=>e.currentStep===0,totalSteps:e=>{var s;return(s=e.requestTypeConfig)!=null&&s.steps?e.requestTypeConfig.steps.length+3:3},isLastStep:e=>e.currentStep===e.totalSteps-1,currentStepConfig:e=>{var s,o;return(o=(s=e.requestTypeConfig)==null?void 0:s.steps)==null?void 0:o[e.currentStep]},canNavigateNext:e=>e.stepValidationStatus[e.currentStep]===!0,completionPercentage:e=>e.totalSteps===0?0:Math.round((e.currentStep+1)/e.totalSteps*100),hasUnsavedChanges:e=>e.lastSaved?new Date-e.lastSaved>3e4:Object.keys(e.formData).length>0},actions:{nextStep(){var u;const e=this.currentStep+1,s=this.totalSteps-1;if(e>s){console.error("[Store] Navigation beyond bounds prevented",{currentStep:this.currentStep,newStep:e,maxStep:s});return}if(e>=2&&e<s&&((u=this.requestTypeConfig)!=null&&u.steps)){const v=e-2;if(!this.requestTypeConfig.steps[v]){console.error("[Store] Missing step config, redirecting to review",{currentStep:this.currentStep,newStep:e,configIndex:v,totalConfigSteps:this.requestTypeConfig.steps.length}),this.currentStep=s;return}}this.currentStep=e},previousStep(){this.isFirstStep||this.currentStep--},goToStep(e){e>=0&&e<this.totalSteps&&(this.currentStep=e)},initialize(e,s=null){return T(this,null,function*(){try{this.requestTypeCode=e,this.error=null,console.log("[RequestStore] initialize called:",{requestTypeCode:e,draftId:s});const o=U.getRequestTypeConfig(e);yield new Promise(u=>{const v=setInterval(()=>{o.loading||(clearInterval(v),u())},100)}),this.requestTypeConfig=o.data,s&&(yield this.loadDraft(s))}catch(o){console.error("Failed to initialize request:",o),this.error=o.message||"Failed to load request type"}})},loadDraft(e){return T(this,null,function*(){try{const s=U.getRequest(e);yield new Promise(y=>{const m=setInterval(()=>{s.loading||(clearInterval(m),y())},100)});const o=s.data;if(this.currentRequestId=e,o.draft_full_data)try{this.formData=JSON.parse(o.draft_full_data)}catch(y){console.error("Failed to parse draft_full_data:",y),this.formData=o.form_data||{}}else this.formData=o.form_data||{};const u=o.draft_current_step||0,v=this.totalSteps-1;this.currentStep=Math.min(Math.max(0,u),v),u!==this.currentStep&&console.warn(`[RequestStore] Draft had invalid step ${u}, clamped to ${this.currentStep} (max: ${v})`)}catch(s){console.error("Failed to load draft:",s),this.error=s.message||"Failed to load draft"}})},saveProgress(){return T(this,null,function*(){if(this.isSaving){console.log("[RequestStore] Save already in progress, skipping");return}this.currentRequestId&&!this.formData.request_id&&(console.warn("[RequestStore] Syncing request_id to formData"),this.formData.request_id=this.currentRequestId),console.log("[RequestStore] saveProgress called",{hasRequestId:!!this.currentRequestId,formDataHasId:!!this.formData.request_id,currentStep:this.currentStep,isSaving:this.isSaving}),this.isSaving=!0,this.error=null;try{const e={};for(const[o,u]of Object.entries(this.formData)){if(u instanceof File){console.warn(`[RequestStore] Skipping File object for key: ${o}`);continue}if(Array.isArray(u)&&u.length>0&&u.some(y=>y&&typeof y=="object"&&y.file_url)){const y=u[0].file_url;if(y&&typeof y=="string"){console.log(`[RequestStore] Converting file array to URL string for ${o}:`,y),e[o]=y;continue}else{console.warn(`[RequestStore] File array for ${o} does not have valid file_url, skipping`);continue}}u!=null&&(e[o]=u)}if(Object.keys(e).length===0&&!this.currentRequestId)throw new Error("No form data to save. Please fill in at least one field.");console.log("[RequestStore] Sending sanitized data with",Object.keys(e).length,"fields"),console.log("[RequestStore] Sanitized data keys:",Object.keys(e)),console.log("[RequestStore] Sanitized data:",JSON.stringify(e,null,2));const s=yield U.createDraft(e,this.currentStep);return this.currentRequestId||(this.currentRequestId=s.request_id,this.formData.request_id=s.request_id,localStorage.setItem("current_draft_id",s.request_id)),this.lastSaved=new Date,s}catch(e){throw console.error("Save failed:",e),this.error=e.message||"Failed to save progress",e}finally{this.isSaving=!1}})},saveDraft(){return T(this,null,function*(){return this.saveProgress()})},submitRequest(){return T(this,null,function*(){this.isSubmitting=!0,this.error=null;try{this.currentRequestId||(yield this.saveProgress());const e=yield U.submitRequest(this.currentRequestId);return this.reset(),e}catch(e){throw console.error("Submit failed:",e),this.error=e.message||"Failed to submit request",e}finally{this.isSubmitting=!1}})},updateField(e,s){this.formData[e]=s},updateFields(e){Object.assign(this.formData,e)},setStepValidation(e,s){this.stepValidationStatus[e]=s},clearError(){this.error=null},reset(){console.log("[RequestStore] reset() called - clearing all state"),this.currentRequestId=null,this.requestTypeCode=null,this.requestTypeConfig=null,Object.keys(this.formData).forEach(e=>{delete this.formData[e]}),this.formData={},this.currentStep=0,this.stepValidationStatus={},this.isSaving=!1,this.isSubmitting=!1,this.lastSaved=null,this.error=null,localStorage.removeItem("current_draft_id")}}});function Ee(){const e=O(),s=H(),o=D(!1),u=D(!1),v=D(!1),y=D(!1),m=D(null);function f(){v.value=!0}function g(d){console.log("Meeting booked:",d),v.value=!1}function w(d){u.value=!0}function n(){return T(this,null,function*(){try{yield s.saveDraft(),s.currentRequestId?e.push(`/request/${s.currentRequestId}`):o.value=!0}catch(d){console.error("Failed to save draft:",d)}})}function a(){return T(this,null,function*(){try{yield s.saveDraft(),s.reset(),e.push({name:"Dashboard"})}catch(d){console.error("Failed to save draft:",d)}})}function p(){return T(this,null,function*(){try{const d=yield s.submitRequest();m.value=d,y.value=!0}catch(d){console.error("Failed to submit request:",d)}})}function _(d){y.value=!1,e.push(`/request/${d}`)}function S(){y.value=!1;const d=s.formData.council;d?e.push(`/council/${d}/dashboard`):e.push("/dashboard")}return{showSaveDraftModal:o,showValidationModal:u,showMeetingModal:v,showSubmissionSuccessModal:y,submissionResult:m,handleBookMeeting:f,handleMeetingBooked:g,showValidationErrors:w,handleSaveDraft:n,handleSaveAndClose:a,handleSubmit:p,handleViewRequestFromModal:_,handleGoToDashboardFromModal:S}}const me=ce("siteCouncil",{state:()=>({council:null,requestTypes:[],loading:!1,error:null,lastFetched:null}),getters:{councilData:e=>e.council,isLoaded:e=>!!e.council,availableRequestTypes:e=>e.requestTypes,branding:e=>{var s,o,u,v;return{primaryColor:((s=e.council)==null?void 0:s.primary_color)||"#0066CC",secondaryColor:((o=e.council)==null?void 0:o.secondary_color)||"#1E40AF",logo:(u=e.council)==null?void 0:u.logo,councilName:((v=e.council)==null?void 0:v.council_name)||"Council"}},meetingConfig:e=>{var s,o,u,v;return{defaultDuration:((s=e.council)==null?void 0:s.default_meeting_duration)||60,availableDurations:((u=(o=e.council)==null?void 0:o.available_meeting_durations)==null?void 0:u.split(",").map(y=>Number.parseInt(y.trim())))||[30,60,90],bufferTime:((v=e.council)==null?void 0:v.meeting_buffer_time)||15}}},actions:{loadCouncil(e=!1){return T(this,null,function*(){const o=Date.now();if(!e&&this.council&&this.lastFetched&&o-this.lastFetched<3e5){console.log("[siteCouncil] Using cached council data");return}this.loading=!0,this.error=null;try{console.log("[siteCouncil] Fetching council data..."),this.council=yield ue("lodgeick.api.get_council"),this.requestTypes=yield ue("lodgeick.api.get_request_types"),this.lastFetched=o,console.log(`[siteCouncil] Loaded: ${this.council.council_name}`),console.log(`[siteCouncil] Request Types: ${this.requestTypes.length}`)}catch(u){throw console.error("[siteCouncil] Failed to load council data:",u),this.error=u.message||"Failed to load council data",u}finally{this.loading=!1}})},reload(){return T(this,null,function*(){return this.loadCouncil(!0)})},clearCache(){this.council=null,this.requestTypes=[],this.lastFetched=null,console.log("[siteCouncil] Cache cleared")}}});function je(){const e=H(),s=me(),o=k(()=>{var n;return(n=e.requestTypeConfig)!=null&&n.steps?e.requestTypeConfig.steps.length+3:3}),u=k(()=>{var a;const n=["Type","Process Info"];return(a=e.requestTypeConfig)!=null&&a.steps&&n.push(...e.requestTypeConfig.steps.map(p=>p.step_title)),n.push("Review"),n}),v=k(()=>{var n;return((n=e.requestTypeConfig)==null?void 0:n.steps)&&e.requestTypeConfig.steps.length>0}),y=k(()=>{var a;if(!((a=e.requestTypeConfig)!=null&&a.steps))return null;const n=e.currentStep-2;return n>=0&&n<e.requestTypeConfig.steps.length?e.requestTypeConfig.steps[n]:null}),m=k(()=>{var n;return e.currentStep>1&&e.currentStep<o.value-1&&((n=e.requestTypeConfig)==null?void 0:n.council_meeting_available)===1});function f(){const n=e.currentStep;return n>=0&&n<u.value.length?u.value[n]:""}function g(){var p;const n=e.currentStep,a=2;if(n<a||n>=o.value-1)return null;if((p=e.requestTypeConfig)!=null&&p.steps){const _=n-a;if(_>=0&&_<e.requestTypeConfig.steps.length)return e.requestTypeConfig.steps[_]}return null}function w(){var n;return((n=s.councilData)==null?void 0:n.council_name)||"Council"}return{totalSteps:o,stepTitles:u,usesConfigurableSteps:v,currentStepConfig:y,shouldShowMeetingBanner:m,getCurrentStepTitle:f,getCurrentStepConfig:g,getCouncilName:w}}function X(e,s){if(!e||e.trim()==="")return!0;let o=e.trim();o.startsWith("eval:")&&(o=o.substring(5).trim());try{return new Function("formData","doc",`
      'use strict';
      try {
        return Boolean(${o});
      } catch (e) {
        console.warn('[Conditional Logic] Evaluation error:', e.message);
        return false;
      }
    `)(s,s)}catch(u){return console.error("[Conditional Logic] Failed to evaluate expression:",e,u),!0}}function Ho(e,s){return!e||!e.is_enabled?!1:e.depends_on?X(e.depends_on,s):!0}function Uo(e,s){return e?e.depends_on?X(e.depends_on,s):!0:!1}function ze(e){return e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e):!0}function Oe(e){return e?/^[\+]?[(]?[0-9]{1,4}[)]?[-\s\.]?[(]?[0-9]{1,4}[)]?[-\s\.]?[0-9]{1,9}$/.test(e.replace(/\s/g,"")):!0}function He(e){if(!e)return!0;try{return new URL(e),!0}catch(s){return!1}}function Ue(e){return e===""||e===null||e===void 0?!0:!isNaN(Number.parseFloat(e))&&isFinite(e)}function Ge(e,s,o){let u=e.trim();u.startsWith("eval:")&&(u=u.substring(5).trim());try{return new Function("formData","value",`
			'use strict';
			try {
				return Boolean(${u});
			} catch (e) {
				console.warn('[Field Validation] Evaluation error:', e.message);
				return true; // Fail open on evaluation error
			}
		`)(o,s)}catch(v){return console.error("[Field Validation] Failed to evaluate expression:",e,v),!0}}function Ye(e,s,o={}){if(!s)return{valid:!0,message:""};switch(s.toLowerCase()){case"email":if(!ze(e))return{valid:!1,message:"Please enter a valid email address"};break;case"phone":if(!Oe(e))return{valid:!1,message:"Please enter a valid phone number"};break;case"url":if(!He(e))return{valid:!1,message:"Please enter a valid URL"};break;case"number":if(!Ue(e))return{valid:!1,message:"Please enter a valid number"};break;default:if(s.startsWith("eval:")&&!Ge(s,e,o))return{valid:!1,message:"Validation failed"}}return{valid:!0,message:""}}function We(){const e=D({}),s=D(!1);function o(f,g,w,n={}){const a=Ye(g,w.validation,n);return a.valid?w.is_required&&(g===""||g===null||g===void 0)?(e.value[f]=`${w.field_label} is required`,!1):(delete e.value[f],!0):(e.value[f]=a.message,!1)}function u(f,g){return T(this,null,function*(){s.value=!0,e.value={};let w=!0;for(const n of f.sections||[])if(!(n.depends_on&&!v(n.depends_on,g)))for(const a of n.fields||[]){if(a.depends_on&&!v(a.depends_on,g))continue;let p=g[a.field_name];if(["barangay","municipality","province","city","region","zip_code","postal_code"].includes(a.field_name)&&!p){const d=g.address_line||g.street||g.residential_address||g.property_address;d&&typeof d=="object"&&(p=d[a.field_name])}o(a.field_name,p,a,g)||(w=!1)}return s.value=!1,w})}function v(f,g){try{return X(f,g)}catch(w){return console.error("Error evaluating depends_on:",w),!0}}function y(){e.value={}}function m(f){delete e.value[f]}return{errors:e,isValidating:s,validateConfigField:o,validateStep:u,clearErrors:y,clearFieldError:m}}function Je(e={}){const s=O(),o=H(),{errors:u,validateStep:v}=We(),{getCurrentStepConfig:y=()=>null,totalSteps:m=k(()=>3),usesConfigurableSteps:f=k(()=>!1),onValidationError:g=()=>{}}=e,w=k(()=>!0),n=k(()=>o.currentStep>=2);function a(){return T(this,null,function*(){if(o.currentStep===0&&!o.formData.request_type){alert("Please select a request type before continuing.");return}if(o.currentStep>=1&&f.value&&y()){const S=y();if(!(yield v(S,o.formData))){console.error("[Navigation] Validation failed:",u.value),g(u.value);return}}if(o.currentStep===1&&!o.currentRequestId&&(console.log("[Navigation] Auto-saving draft after Process Info step..."),yield o.saveDraft(),console.log("[Navigation] Draft saved with ID:",o.currentRequestId),!f.value&&o.currentRequestId)){console.log("[Navigation] No dynamic steps, redirecting to detail page..."),s.push(`/request/${o.currentRequestId}`);return}o.currentRequestId&&(yield o.saveProgress()),o.currentStep<m.value-1&&o.nextStep()})}function p(){o.previousStep()}function _(){o.reset(),s.push("/dashboard")}return{canNavigateNext:w,canSaveDraft:n,validationErrors:u,handleNext:a,handlePrevious:p,goBack:_}}const C=D(null),Z=D(!1),Q=D(null);function Ze(){const e=()=>T(this,null,function*(){Z.value=!0,Q.value=null;try{const n={"Content-Type":"application/json"};window.csrf_token&&(n["X-Frappe-CSRF-Token"]=window.csrf_token);const p=yield(yield fetch("/api/method/lodgeick.api.get_user_profile",{method:"GET",headers:n,credentials:"include"})).json();if(p.message)return C.value=p.message,C.value;throw new Error("Failed to load profile")}catch(n){return Q.value=n.message,console.error("Error loading user profile:",n),null}finally{Z.value=!1}}),s=k(()=>{var n;return(n=C.value)!=null&&n.properties?C.value.properties.find(a=>a.is_default)||C.value.properties[0]:null}),o=k(()=>{var n;return(n=C.value)!=null&&n.councils?C.value.councils.find(a=>a.is_default)||C.value.councils[0]:null}),u=()=>{if(!C.value)return{};const n=C.value,a={};if(o.value&&(a.council=o.value.council_id,a.council_name=o.value.council_name),a.requester_name=n.full_name,a.requester_email=n.user,a.requester_phone=n.phone,a.requester_type=n.user_role,n.user_role==="Individual"&&n.postal_street&&(a.applicant_address=`${n.postal_street}, ${n.postal_suburb||""}, ${n.postal_city||""} ${n.postal_postcode||""}`.trim()),n.user_role==="Agent"&&(a.agent_required=!0,a.agent_id=n.user,a.agent_company=n.company_name,a.agent_email=n.business_email||n.user,a.agent_phone=n.business_phone||n.phone,n.business_street&&(a.agent_address=`${n.business_street}, ${n.business_suburb||""}, ${n.business_city||""} ${n.business_postcode||""}`.trim()),n.default_communication_route&&(a.correspondence_recipient=n.default_communication_route==="Agent Only"?"Agent":"Both"),n.default_invoice_recipient&&(a.invoice_responsible_party=n.default_invoice_recipient)),s.value){const p=s.value;a.property=`${p.street}, ${p.suburb||""}, ${p.city||""} ${p.postcode||""}`.trim(),a.property_address=a.property,a.property_legal_description=p.legal_description,a.ownership_status=p.ownership_status}return(n.comm_email||n.comm_phone||n.comm_post)&&(a.communication_preferences={email:n.comm_email||!1,phone:n.comm_phone||!1,post:n.comm_post||!1}),n.invoice_preference&&(a.invoice_delivery_method=n.invoice_preference),a},v=(n,a={})=>{const{overrideExisting:p=!1,fieldsToSkip:_=[]}=a,S=u();return Object.keys(S).forEach(d=>{_.includes(d)||!p&&n[d]||(n[d]=S[d])}),n},y=k(()=>{var n;return((n=C.value)==null?void 0:n.properties)||[]}),m=k(()=>{var n;return((n=C.value)==null?void 0:n.councils)||[]}),f=k(()=>{var n;return((n=C.value)==null?void 0:n.clients)||[]}),g=k(()=>{var p,_,S;if(!C.value)return!1;const n=C.value,a=n.full_name&&n.phone&&n.user_role;return n.user_role==="Individual"?a&&(((p=n.properties)==null?void 0:p.length)>0||!1)&&(((_=n.councils)==null?void 0:_.length)>0||!1):n.user_role==="Agent"?a&&n.company_name&&(((S=n.councils)==null?void 0:S.length)>0||!1):a}),w=k(()=>{if(!C.value)return 0;const n=C.value;let a=0,p=0;return["full_name","phone","user_role"].forEach(S=>{p++,n[S]&&a++}),p++,(n.comm_email||n.comm_phone||n.comm_post)&&a++,p++,n.properties&&n.properties.length>0&&a++,p++,n.councils&&n.councils.length>0&&a++,n.user_role==="Agent"?(p++,n.company_name&&a++):(p++,n.postal_street&&a++),Math.round(a/p*100)});return{userProfile:C,loading:Z,error:Q,loadUserProfile:e,getApplicationAutoFill:u,applyAutoFill:v,defaultProperty:s,defaultCouncil:o,getAllProperties:y,getAllCouncils:m,getAllClients:f,isProfileComplete:g,profileCompletionPercentage:w}}function Qe(e={}){const s=Fe();O();const o=H(),u=me(),{onRequestTypeSelected:v=()=>{}}=e,y=D({loading:!1,data:[]}),m=D(null);function f(){return T(this,null,function*(){y.value.loading=!0,yield u.loadCouncil(),y.value={loading:!1,data:u.availableRequestTypes||[]}})}function g(p){return T(this,null,function*(){if(o.updateField("request_type",p),yield o.initialize(p),m.value=o.requestTypeConfig,!o.requestTypeConfig){console.error("[Lifecycle] Failed to load request type config");return}v(p)})}function w(){return T(this,null,function*(){const p=s.query.type,_=s.query.draft;if(console.log("[Lifecycle] Initialization - type:",p,"draft:",_),!_&&!s.query.draft&&o.reset(),!_){const{getApplicationAutoFill:S,applyAutoFill:d}=Ze();try{yield S(),d(o.formData,{overrideExisting:!1})}catch(i){console.warn("[Lifecycle] Failed to load user profile for auto-fill:",i)}}if(_&&p){yield o.initialize(p,_),m.value=o.requestTypeConfig;return}yield f(),p&&!_&&(console.log("[Lifecycle] Request type provided in URL:",p),yield o.initialize(p),m.value=o.requestTypeConfig,o.updateField("request_type",p),o.currentStep=1,console.log("[Lifecycle] Advanced to step 1 (Process Info)"))})}function n(){Ae((p,_,S)=>{if(o.isSubmitting||!o.currentRequestId){o.reset(),S();return}o.formData&&Object.keys(o.formData).some(i=>o.formData[i]!==void 0&&o.formData[i]!==null&&o.formData[i]!=="")&&!confirm("You have unsaved changes. Do you want to leave without saving?")?S(!1):(p.path.includes("/request/")||o.reset(),S())})}function a(p){Ne(()=>o.formData.birth_date,_=>{var S;if(_&&((S=o.formData.request_type)!=null&&S.includes("SPISC"))){const d=new Date,i=new Date(_);let V=d.getFullYear()-i.getFullYear();const M=d.getMonth()-i.getMonth();(M<0||M===0&&d.getDate()<i.getDate())&&V--,o.updateField("age",V),V<60?p.value.birth_date="Applicant must be 60 years or older for SPISC":delete p.value.birth_date}})}return{requestTypes:y,selectedRequestTypeDetails:m,loadRequestTypes:f,selectRequestType:g,initialize:w,setupRouteGuard:n,setupAgeValidation:a}}const Xe={class:"mb-8"},Ke={class:"relative mb-6"},et={class:"overflow-hidden h-2 text-xs flex rounded bg-gray-200"},tt={class:"flex justify-between mt-2"},st={class:"text-sm font-medium text-gray-700"},ot={class:"text-sm font-medium text-gray-700"},nt={__name:"RequestProgress",props:{currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0},stepTitles:{type:Array,default:()=>[]}},setup(e){const s=e,o=k(()=>s.totalSteps===0?0:Math.round((s.currentStep+1)/s.totalSteps*100));return(u,v)=>(r(),c("div",Xe,[t("div",Ke,[t("div",et,[t("div",{style:Pe({width:o.value+"%"}),class:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-600 transition-all duration-500"},null,4)]),t("div",tt,[t("span",st,b(e.stepTitles[e.currentStep]||`Step ${e.currentStep+1}`),1),t("span",ot,b(o.value)+"% Complete ",1)])])]))}},it={class:"mt-8 pt-6 border-t border-gray-200"},rt={class:"flex items-center justify-between"},at={class:"flex items-center space-x-3"},lt={__name:"StepNavigation",props:{currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0},isLastStep:{type:Boolean,default:!1},canGoNext:{type:Boolean,default:!0},canSaveDraft:{type:Boolean,default:!0},isSaving:{type:Boolean,default:!1},isSubmitting:{type:Boolean,default:!1}},emits:["next","previous","save-draft","submit"],setup(e,{emit:s}){const o=s,u=()=>{o("next")},v=()=>{o("previous")},y=()=>{o("save-draft")},m=()=>{o("submit")};return(f,g)=>(r(),c("div",it,[t("div",rt,[t("div",null,[e.currentStep>0?(r(),I(l(L),{key:0,onClick:v,variant:"outline",disabled:e.isSaving||e.isSubmitting},{prefix:R(()=>[...g[0]||(g[0]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),default:R(()=>[g[1]||(g[1]=$(" Previous ",-1))]),_:1},8,["disabled"])):h("",!0)]),t("div",at,[e.canSaveDraft?(r(),I(l(L),{key:0,onClick:y,variant:"outline",loading:e.isSaving,disabled:e.isSubmitting},de({default:R(()=>[$(" "+b(e.isSaving?"Saving...":"Save Draft"),1)]),_:2},[e.isSaving?void 0:{name:"prefix",fn:R(()=>[g[2]||(g[2]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})],-1))]),key:"0"}]),1032,["loading","disabled"])):h("",!0),e.isLastStep?(r(),I(l(L),{key:2,onClick:m,variant:"solid",theme:"green",loading:e.isSubmitting,disabled:!e.canGoNext||e.isSaving},de({default:R(()=>[$(" "+b(e.isSubmitting?"Submitting...":"Submit Application"),1)]),_:2},[e.isSubmitting?void 0:{name:"prefix",fn:R(()=>[g[5]||(g[5]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1))]),key:"0"}]),1032,["loading","disabled"])):(r(),I(l(L),{key:1,onClick:u,variant:"solid",theme:"blue",disabled:!e.canGoNext||e.isSaving||e.isSubmitting},{suffix:R(()=>[...g[3]||(g[3]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])]),default:R(()=>[g[4]||(g[4]=$(" Next ",-1))]),_:1},8,["disabled"]))])]),g[6]||(g[6]=t("div",{class:"mt-4 text-center"},[t("p",{class:"text-sm text-gray-500"}," Your progress is automatically saved. You can return to complete this application later. ")],-1))]))}},ut={key:0,class:"text-center py-12"},dt={key:1,class:"grid md:grid-cols-2 gap-4"},ct=["onClick"],mt={class:"flex items-start justify-between"},ft={class:"flex-1"},pt={class:"text-lg font-semibold text-gray-900 mb-2"},gt=["innerHTML"],yt={class:"mt-4 flex items-center space-x-4 text-xs text-gray-500"},vt={key:0},ht={key:1},bt={key:2,class:"px-2 py-1 bg-gray-100 rounded"},xt={key:0,class:"ml-4"},_t={__name:"Step2RequestType",props:{modelValue:{type:Object,required:!0},requestTypes:{type:Object,required:!0}},emits:["update:modelValue","type-selected"],setup(e,{emit:s}){const o=e,u=s,v=y=>{console.log("[Step2RequestType] selectType called with:",y.name),console.log("[Step2RequestType] props.modelValue:",o.modelValue),console.log("[Step2RequestType] props.modelValue.council:",o.modelValue.council);const m=le(ae({},o.modelValue),{request_type:y.name});console.log("[Step2RequestType] Emitting updatedValue:",m),u("update:modelValue",m),u("type-selected",y.name)};return(y,m)=>(r(),c("div",null,[m[2]||(m[2]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Select Application Type",-1)),m[3]||(m[3]=t("p",{class:"text-gray-600 mb-8"},"Choose the type of consent you wish to apply for",-1)),e.requestTypes.loading?(r(),c("div",ut,[...m[0]||(m[0]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)])])):(r(),c("div",dt,[(r(!0),c(j,null,G(e.requestTypes.data,f=>(r(),c("div",{key:f.name,onClick:g=>v(f),class:P(["border-2 rounded-lg p-6 cursor-pointer transition-all hover:shadow-md",e.modelValue.request_type===f.name?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-300"])},[t("div",mt,[t("div",ft,[t("h3",pt,b(f.type_name),1),t("p",{class:"text-sm text-gray-600",innerHTML:f.description||"No description available"},null,8,gt),t("div",yt,[f.base_fee?(r(),c("span",vt,"Fee: $"+b(f.base_fee),1)):h("",!0),f.processing_sla_days?(r(),c("span",ht,b(f.processing_sla_days)+" days",1)):h("",!0),f.category?(r(),c("span",bt,b(f.category),1)):h("",!0)])]),e.modelValue.request_type===f.name?(r(),c("div",xt,[...m[1]||(m[1]=[t("div",{class:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center"},[t("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)])])):h("",!0)])],10,ct))),128))]))]))}},wt={class:"text-gray-600 mb-6"},St={key:0,class:"space-y-6"},kt={class:"bg-white border border-gray-200 rounded-lg p-6"},qt={class:"flex items-start justify-between mb-4"},Vt={class:"text-xl font-semibold text-gray-900"},Ct={key:0,class:"text-sm text-gray-500 mt-1"},Tt={class:"grid md:grid-cols-3 gap-4 mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"},Dt={class:"text-2xl font-bold text-blue-900 mt-1"},Rt={class:"text-2xl font-bold text-blue-900 mt-1"},$t={class:"text-2xl font-bold text-blue-900 mt-1"},Mt={key:0,class:"bg-white border border-gray-200 rounded-lg p-6"},Ft=["innerHTML"],Nt={key:1,class:"bg-white border border-gray-200 rounded-lg p-6"},At=["innerHTML"],Pt={key:1,class:"text-center py-12"},It={__name:"Step3ProcessInfo",props:{requestTypeDetails:{type:Object,default:null},councilName:{type:String,default:""},modelValue:{type:Object,default:()=>({})}},emits:["continue","update:modelValue"],setup(e,{emit:s}){const o=O(),u=s,v=()=>{if(!Be.isLoggedIn){const y=window.location.pathname+window.location.search;o.push({name:"Login",query:{redirect:y}});return}u("continue")};return(y,m)=>(r(),c("div",null,[m[11]||(m[11]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Council Process Information",-1)),t("p",wt,"Understanding "+b(e.councilName)+"'s process for this application",1),e.requestTypeDetails?(r(),c("div",St,[t("div",kt,[t("div",qt,[t("div",null,[t("h3",Vt,b(e.requestTypeDetails.request_type_name),1),e.requestTypeDetails.category?(r(),c("p",Ct,b(e.requestTypeDetails.category),1)):h("",!0)])]),t("div",Tt,[t("div",null,[m[0]||(m[0]=t("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Application Fee",-1)),t("div",Dt," $"+b(e.requestTypeDetails.base_fee||"0"),1),m[1]||(m[1]=t("div",{class:"text-xs text-blue-600 mt-1"},"Plus any additional costs",-1))]),t("div",null,[m[3]||(m[3]=t("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Processing Time",-1)),t("div",Rt,[$(b(e.requestTypeDetails.sla_days||"N/A")+" ",1),m[2]||(m[2]=t("span",{class:"text-base"},"days",-1))]),m[4]||(m[4]=t("div",{class:"text-xs text-blue-600 mt-1"},"Standard timeframe",-1))]),t("div",null,[m[5]||(m[5]=t("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Payment Required",-1)),t("div",$t,b(e.requestTypeDetails.requires_payment?"Yes":"No"),1),m[6]||(m[6]=t("div",{class:"text-xs text-blue-600 mt-1"},"Before processing",-1))])])]),e.requestTypeDetails.process_description?(r(),c("div",Mt,[m[7]||(m[7]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"How This Works",-1)),t("div",{class:"prose prose-sm max-w-none text-gray-700",innerHTML:e.requestTypeDetails.process_description},null,8,Ft)])):e.requestTypeDetails.description?(r(),c("div",Nt,[m[8]||(m[8]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"About This Application",-1)),t("div",{class:"prose prose-sm max-w-none text-gray-700",innerHTML:e.requestTypeDetails.description},null,8,At)])):h("",!0),m[9]||(m[9]=z('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><div class="flex items-start"><svg class="w-5 h-5 text-yellow-600 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg><div><h5 class="font-semibold text-yellow-900 text-sm">Before You Continue</h5><p class="text-yellow-800 text-sm mt-1"> Please review this information carefully. Make sure you understand the process, fees, and timeframes before proceeding with your application. </p></div></div></div>',1)),t("div",{class:"flex justify-center pt-4"},[t("button",{type:"button",onClick:v,class:"px-8 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors"}," I Understand - Continue to Application ")])])):(r(),c("div",Pt,[...m[10]||(m[10]=[t("p",{class:"text-gray-500"},"No request type selected. Please go back and select a request type.",-1)])]))]))}},Lt={class:"px-4 sm:px-0"},Bt={class:"space-y-4 sm:space-y-6"},Et={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 sm:p-6"},jt={class:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-0"},zt={class:"text-base sm:text-lg font-semibold text-blue-900"},Ot={class:"text-xs sm:text-sm text-blue-700 mt-1"},Ht={class:"sm:text-right"},Ut={class:"text-xl sm:text-2xl font-bold text-blue-900"},Gt={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Yt={class:"p-4 sm:p-6 space-y-3"},Wt={class:"grid md:grid-cols-2 gap-4"},Jt={class:"font-medium"},Zt={class:"font-medium"},Qt={class:"font-medium"},Xt={key:0},Kt={class:"font-medium"},es={key:0,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},ts={class:"p-4 sm:p-6"},ss={key:0,class:"space-y-2"},os={class:"font-medium"},ns={key:0},is={class:"font-medium"},rs={key:1,class:"text-gray-500"},as={key:1,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},ls={class:"p-4 sm:p-6 space-y-3"},us={class:"font-medium"},ds={class:"font-medium"},cs={class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},ms={class:"font-semibold text-gray-900 text-sm sm:text-base"},fs={class:"p-4 sm:p-6 space-y-4"},ps={key:0,class:"text-sm font-medium text-gray-700 mb-2"},gs={class:"grid md:grid-cols-2 gap-4"},ys={class:"text-sm text-gray-500"},vs={class:"font-medium"},hs={key:0,class:"text-gray-500 text-sm"},bs={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},xs={class:"p-4 sm:p-6"},_s={class:"space-y-3"},ws={class:"mt-2 flex flex-wrap gap-2"},Ss={key:0,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium"},ks={key:1,class:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},qs={key:2,class:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium"},Vs={key:3,class:"px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full text-sm font-medium"},Cs={key:4,class:"px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-sm font-medium"},Ts={key:5,class:"text-gray-500"},Ds={class:"mt-1 inline-flex items-center"},Rs={key:0},$s={class:"font-medium break-words"},Ms={key:0,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Fs={class:"p-4 sm:p-6"},Ns={class:"flex flex-wrap gap-2"},As={key:0,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Ps={key:1,class:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Is={key:2,class:"px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Ls={key:3,class:"px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Bs={key:1,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Es={class:"p-4 sm:p-6"},js={class:"space-y-3"},zs={class:"font-medium"},Os={key:0},Hs={class:"text-sm mt-1 line-clamp-3"},Us={key:1},Gs={class:"text-sm mt-1 line-clamp-3"},Ys={class:"flex items-center gap-2"},Ws={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Js={class:"p-4 sm:p-6"},Zs={class:"space-y-4"},Qs={key:0},Xs=["innerHTML"],Ks={key:1},eo=["innerHTML"],to={key:2},so={class:"text-sm mt-1 line-clamp-3"},oo={key:3},no={class:"text-sm mt-1 space-y-1 list-disc list-inside"},io={key:0},ro={key:1},ao={key:2},lo={key:4},uo=["innerHTML"],co={key:5,class:"text-gray-500 text-sm"},mo={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},fo={class:"p-4 sm:p-6"},po={class:"space-y-2"},go={class:"flex items-start gap-2"},yo={class:"flex items-start gap-2"},vo={class:"flex items-start gap-2"},ho={key:0,class:"mt-4 pt-4 border-t border-gray-200"},bo={class:"font-medium"},xo={key:0,class:"text-sm text-gray-500"},_o={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},wo={__name:"ReviewStep",props:{modelValue:{type:Object,required:!0},councilName:{type:String,default:"Council"},requestTypeName:{type:String,default:"Application"},applicationFee:{type:String,default:"TBD"},isResourceConsent:{type:Boolean,default:!1},stepConfigs:{type:Array,default:()=>[]},usesConfigurableSteps:{type:Boolean,default:!1},requestTypeDetails:{type:Object,default:null}},setup(e){const s=e,o=k(()=>!s.usesConfigurableSteps||!s.stepConfigs?[]:s.stepConfigs.filter(d=>d.show_on_review)),u=k(()=>s.isResourceConsent?!0:!!(s.modelValue.property||s.modelValue.property_address)),v=d=>{if(!d.sections)return!1;for(const i of d.sections)if(i.show_on_review){for(const V of i.fields)if(V.show_on_review&&s.modelValue[V.field_name])return!0}return!1},y=(d,i)=>{if(i==null||i==="")return"Not provided";if(d.field_type==="Check")return i?"Yes":"No";if(d.field_type==="Date"&&i)try{return new Date(i).toLocaleDateString("en-NZ",{year:"numeric",month:"long",day:"numeric"})}catch(V){return i}return d.field_type==="Currency"&&i?`₱${Number(i).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})}`:d.field_type==="Select"?i:d.field_type==="Attach"||d.field_type==="Attach Image"?i?"✓ File attached":"Not provided":i},m=k(()=>!!(s.modelValue.consent_type_land_use||s.modelValue.consent_type_subdivision||s.modelValue.consent_type_discharge||s.modelValue.consent_type_water||s.modelValue.consent_type_coastal)),f=k(()=>{const d=s.modelValue.activity_status_type;return d==="Permitted"?"bg-green-100 text-green-800":d==="Controlled"?"bg-blue-100 text-blue-800":d==="Restricted Discretionary"?"bg-yellow-100 text-yellow-800":d==="Discretionary"?"bg-orange-100 text-orange-800":d==="Non-Complying"?"bg-red-100 text-red-800":d==="Prohibited"?"bg-gray-800 text-white":"bg-gray-100 text-gray-800"}),g=k(()=>!!(s.modelValue.hazard_flooding||s.modelValue.hazard_earthquake||s.modelValue.hazard_landslip||s.modelValue.hazard_coastal)),w=k(()=>!!(s.modelValue.consultation_undertaken||s.modelValue.consultation_summary||s.modelValue.affected_parties_details||s.modelValue.written_approvals_obtained)),n=k(()=>!!(s.modelValue.activity_description||s.modelValue.aee_full_assessment||s.modelValue.positive_effects_description||s.modelValue.effects_visual_amenity||s.modelValue.effects_traffic_parking||s.modelValue.effects_noise||s.modelValue.mitigation_measures||s.modelValue.aee_activity_description||s.modelValue.aee_existing_environment||s.modelValue.assessment_of_effects||s.modelValue.aee_document)),a=d=>{if(!d)return"";const i=document.createElement("div");return i.innerHTML=d,i.textContent||i.innerText||""},p=(d,i)=>{if(!d)return"";const V=a(d);return V.length<=i?V:V.substring(0,i)+"..."},_=d=>{if(!d)return"";try{return new Date(d).toLocaleDateString("en-NZ",{year:"numeric",month:"long",day:"numeric"})}catch(i){return d}},S=k(()=>{const d=!!(s.modelValue.council&&s.modelValue.request_type&&s.modelValue.requester_name&&s.modelValue.requester_email&&s.modelValue.property_address&&s.modelValue.delivery_preference);if(s.isResourceConsent){const i=!!(m.value&&s.modelValue.activity_status_type&&s.modelValue.activity_description&&s.modelValue.aee_full_assessment&&s.modelValue.declaration_accuracy&&s.modelValue.declaration_authority&&s.modelValue.declaration_acknowledgment);return d&&i}return d});return(d,i)=>{var V;return r(),c("div",Lt,[i[39]||(i[39]=t("h2",{class:"text-xl sm:text-2xl font-bold text-gray-900 mb-2"},"Review & Submit",-1)),i[40]||(i[40]=t("p",{class:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8"},"Review your application details before submitting",-1)),t("div",Bt,[t("div",Et,[t("div",jt,[t("div",null,[t("h3",zt,b(e.requestTypeName),1),t("p",Ot,b(e.councilName),1)]),t("div",Ht,[i[0]||(i[0]=t("div",{class:"text-xs sm:text-sm text-blue-600 font-medium"},"Application Fee",-1)),t("div",Ut,b(e.applicationFee),1)])])]),t("div",Gt,[i[5]||(i[5]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Applicant Details")],-1)),t("div",Yt,[t("div",Wt,[t("div",null,[i[1]||(i[1]=t("span",{class:"text-sm text-gray-500"},"Name:",-1)),t("p",Jt,b(e.modelValue.requester_name||"Not provided"),1)]),t("div",null,[i[2]||(i[2]=t("span",{class:"text-sm text-gray-500"},"Email:",-1)),t("p",Zt,b(e.modelValue.requester_email||"Not provided"),1)]),t("div",null,[i[3]||(i[3]=t("span",{class:"text-sm text-gray-500"},"Phone:",-1)),t("p",Qt,b(e.modelValue.requester_phone||"Not provided"),1)]),e.modelValue.applicant_company?(r(),c("div",Xt,[i[4]||(i[4]=t("span",{class:"text-sm text-gray-500"},"Company:",-1)),t("p",Kt,b(e.modelValue.applicant_company),1)])):h("",!0)])])]),u.value?(r(),c("div",es,[i[8]||(i[8]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Property Details")],-1)),t("div",ts,[e.modelValue.property_address?(r(),c("div",ss,[t("div",null,[i[6]||(i[6]=t("span",{class:"text-sm text-gray-500"},"Address:",-1)),t("p",os,b(e.modelValue.property_address),1)]),e.modelValue.legal_description?(r(),c("div",ns,[i[7]||(i[7]=t("span",{class:"text-sm text-gray-500"},"Legal Description:",-1)),t("p",is,b(e.modelValue.legal_description),1)])):h("",!0)])):(r(),c("p",rs,"No property selected"))])])):h("",!0),(V=e.requestTypeDetails)!=null&&V.collect_payment?(r(),c("div",as,[i[11]||(i[11]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Delivery & Payment")],-1)),t("div",ls,[t("div",null,[i[9]||(i[9]=t("span",{class:"text-sm text-gray-500"},"Delivery Preference:",-1)),t("p",us,b(e.modelValue.delivery_preference||"Not selected"),1)]),t("div",null,[i[10]||(i[10]=t("span",{class:"text-sm text-gray-500"},"Invoice To:",-1)),t("p",ds,b(e.modelValue.invoice_to||"Not specified"),1)])])])):h("",!0),e.usesConfigurableSteps&&o.value.length>0?(r(!0),c(j,{key:2},G(o.value,M=>(r(),c("div",{key:M.step_code,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},[t("div",cs,[t("h3",ms,b(M.step_title),1)]),t("div",fs,[(r(!0),c(j,null,G(M.sections.filter(F=>F.show_on_review),F=>(r(),c("div",{key:F.section_code},[F.section_title?(r(),c("h4",ps,b(F.section_title),1)):h("",!0),t("div",gs,[(r(!0),c(j,null,G(F.fields.filter(N=>N.show_on_review),N=>(r(),c("div",{key:N.field_name},[t("span",ys,b(N.review_label||N.field_label)+":",1),t("p",vs,b(y(N,e.modelValue[N.field_name])),1)]))),128))])]))),128)),v(M)?h("",!0):(r(),c("p",hs," No information to display for review "))])]))),128)):h("",!0),e.isResourceConsent?(r(),c(j,{key:3},[t("div",bs,[i[15]||(i[15]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Consent Types & Activity Status")],-1)),t("div",xs,[t("div",_s,[t("div",null,[i[12]||(i[12]=t("span",{class:"text-sm text-gray-500"},"Consent Types:",-1)),t("div",ws,[e.modelValue.consent_type_land_use?(r(),c("span",Ss," Land Use Consent ")):h("",!0),e.modelValue.consent_type_subdivision?(r(),c("span",ks," Subdivision Consent ")):h("",!0),e.modelValue.consent_type_discharge?(r(),c("span",qs," Discharge Permit ")):h("",!0),e.modelValue.consent_type_water?(r(),c("span",Vs," Water Permit ")):h("",!0),e.modelValue.consent_type_coastal?(r(),c("span",Cs," Coastal Permit ")):h("",!0),m.value?h("",!0):(r(),c("span",Ts," None selected "))])]),t("div",null,[i[13]||(i[13]=t("span",{class:"text-sm text-gray-500"},"Activity Status:",-1)),t("div",Ds,[t("span",{class:P(["px-3 py-1 rounded-full text-sm font-medium",f.value])},b(e.modelValue.activity_status_type||"Not specified"),3)])]),e.modelValue.activity_title?(r(),c("div",Rs,[i[14]||(i[14]=t("span",{class:"text-sm text-gray-500"},"Activity Title:",-1)),t("p",$s,b(e.modelValue.activity_title),1)])):h("",!0)])])]),g.value?(r(),c("div",Ms,[i[20]||(i[20]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Natural Hazards")],-1)),t("div",Fs,[t("div",Ns,[e.modelValue.hazard_flooding?(r(),c("span",As,[...i[16]||(i[16]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707"})],-1),$(" Flood Hazard ",-1)])])):h("",!0),e.modelValue.hazard_earthquake?(r(),c("span",Ps,[...i[17]||(i[17]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),$(" Earthquake/Fault Line ",-1)])])):h("",!0),e.modelValue.hazard_landslip?(r(),c("span",Is,[...i[18]||(i[18]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1),$(" Landslip/Slope Instability ",-1)])])):h("",!0),e.modelValue.hazard_coastal?(r(),c("span",Ls,[...i[19]||(i[19]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7l-2 1m2-1l-2-1m2 1v2.5M14 4l-2-1-2 1M4 7l2-1M4 7l2 1M4 7v2.5"})],-1),$(" Coastal Hazard ",-1)])])):h("",!0)])])])):h("",!0),w.value?(r(),c("div",Bs,[i[25]||(i[25]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Consultation & Affected Parties")],-1)),t("div",Es,[t("div",js,[t("div",null,[i[21]||(i[21]=t("span",{class:"text-sm text-gray-500"},"Consultation Undertaken:",-1)),t("p",zs,b(e.modelValue.consultation_undertaken||"Not specified"),1)]),e.modelValue.consultation_summary?(r(),c("div",Os,[i[22]||(i[22]=t("span",{class:"text-sm text-gray-500"},"Consultation Summary:",-1)),t("p",Hs,b(e.modelValue.consultation_summary),1)])):h("",!0),e.modelValue.affected_parties_details?(r(),c("div",Us,[i[23]||(i[23]=t("span",{class:"text-sm text-gray-500"},"Affected Parties:",-1)),t("p",Gs,b(a(e.modelValue.affected_parties_details)),1)])):h("",!0),t("div",Ys,[(r(),c("svg",{class:P(["w-5 h-5",e.modelValue.written_approvals_obtained?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[24]||(i[24]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:P(e.modelValue.written_approvals_obtained?"text-gray-900":"text-gray-500")}," Written Approvals "+b(e.modelValue.written_approvals_obtained?"Obtained":"Not Obtained"),3)])])])])):h("",!0),t("div",Ws,[i[31]||(i[31]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Assessment of Environmental Effects")],-1)),t("div",Js,[t("div",Zs,[e.modelValue.activity_description?(r(),c("div",Qs,[i[26]||(i[26]=t("span",{class:"text-sm text-gray-500"},"Activity Description:",-1)),t("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:e.modelValue.activity_description},null,8,Xs)])):h("",!0),e.modelValue.aee_full_assessment?(r(),c("div",Ks,[i[27]||(i[27]=t("span",{class:"text-sm text-gray-500"},"Full Assessment:",-1)),t("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:e.modelValue.aee_full_assessment},null,8,eo)])):h("",!0),e.modelValue.positive_effects_description?(r(),c("div",to,[i[28]||(i[28]=t("span",{class:"text-sm text-gray-500"},"Positive Effects:",-1)),t("p",so,b(e.modelValue.positive_effects_description),1)])):h("",!0),e.modelValue.effects_visual_amenity||e.modelValue.effects_traffic_parking||e.modelValue.effects_noise?(r(),c("div",oo,[i[29]||(i[29]=t("span",{class:"text-sm text-gray-500"},"Adverse Effects Summary:",-1)),t("ul",no,[e.modelValue.effects_visual_amenity?(r(),c("li",io,"Visual/Amenity: "+b(p(e.modelValue.effects_visual_amenity,50)),1)):h("",!0),e.modelValue.effects_traffic_parking?(r(),c("li",ro,"Traffic/Parking: "+b(p(e.modelValue.effects_traffic_parking,50)),1)):h("",!0),e.modelValue.effects_noise?(r(),c("li",ao,"Noise: "+b(p(e.modelValue.effects_noise,50)),1)):h("",!0)])])):h("",!0),e.modelValue.mitigation_measures?(r(),c("div",lo,[i[30]||(i[30]=t("span",{class:"text-sm text-gray-500"},"Mitigation Measures:",-1)),t("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:e.modelValue.mitigation_measures},null,8,uo)])):h("",!0),n.value?h("",!0):(r(),c("p",co," AEE not yet completed "))])])]),t("div",mo,[i[36]||(i[36]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Statutory Declarations")],-1)),t("div",fo,[t("div",po,[t("div",go,[(r(),c("svg",{class:P(["w-5 h-5 flex-shrink-0 mt-0.5",e.modelValue.declaration_accuracy||e.modelValue.declaration_rma_compliance?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[32]||(i[32]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:P(["text-sm",e.modelValue.declaration_accuracy||e.modelValue.declaration_rma_compliance?"text-gray-900":"text-gray-500"])}," Declaration of Accuracy & RMA Compliance ",2)]),t("div",yo,[(r(),c("svg",{class:P(["w-5 h-5 flex-shrink-0 mt-0.5",e.modelValue.declaration_authority||e.modelValue.declaration_authorized?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[33]||(i[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:P(["text-sm",e.modelValue.declaration_authority||e.modelValue.declaration_authorized?"text-gray-900":"text-gray-500"])}," Declaration of Authority to Apply ",2)]),t("div",vo,[(r(),c("svg",{class:P(["w-5 h-5 flex-shrink-0 mt-0.5",e.modelValue.declaration_acknowledgment||e.modelValue.declaration_public_information?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[34]||(i[34]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:P(["text-sm",e.modelValue.declaration_acknowledgment||e.modelValue.declaration_public_information?"text-gray-900":"text-gray-500"])}," Public Information & Privacy Acknowledgment ",2)]),e.modelValue.requester_signature?(r(),c("div",ho,[i[35]||(i[35]=t("span",{class:"text-sm text-gray-500"},"Signed by:",-1)),t("p",bo,b(e.modelValue.requester_signature),1),e.modelValue.signature_date?(r(),c("p",xo," Date: "+b(_(e.modelValue.signature_date)),1)):h("",!0)])):h("",!0)])])])],64)):h("",!0),i[38]||(i[38]=z('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 sm:p-6" data-v-889f31e6><div class="flex items-start gap-2 sm:gap-3" data-v-889f31e6><svg class="w-5 h-5 sm:w-6 sm:h-6 text-yellow-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-889f31e6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-889f31e6></path></svg><div data-v-889f31e6><h4 class="font-semibold text-yellow-900 text-sm sm:text-base" data-v-889f31e6>Before You Submit</h4><ul class="mt-2 text-xs sm:text-sm text-yellow-800 space-y-1 list-disc list-inside" data-v-889f31e6><li data-v-889f31e6>Review all information carefully for accuracy and completeness</li><li data-v-889f31e6>Ensure all required fields are completed</li><li data-v-889f31e6>For Resource Consent applications, verify all statutory declarations are confirmed</li><li data-v-889f31e6>Once submitted, you cannot edit the application (you may need to withdraw and resubmit)</li></ul></div></div></div>',1)),S.value?h("",!0):(r(),c("div",_o,[...i[37]||(i[37]=[z('<div class="flex items-start gap-2 sm:gap-3" data-v-889f31e6><svg class="w-5 h-5 text-red-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-889f31e6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-889f31e6></path></svg><div data-v-889f31e6><h5 class="font-semibold text-red-900 text-xs sm:text-sm" data-v-889f31e6>Application Incomplete</h5><p class="text-red-800 text-xs sm:text-sm mt-1" data-v-889f31e6> Please complete all required sections before submitting. Use the Previous button to go back and fill in missing information. </p></div></div>',1)])]))])])}}},So=Me(wo,[["__scopeId","data-v-889f31e6"]]),ko={class:"min-h-screen bg-gray-50"},qo={class:"bg-white border-b border-gray-200"},Vo={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},Co={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},To={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},Do={key:0},Ro={key:1},$o={key:2},Mo={key:4,class:"text-center py-12"},Fo={class:"flex gap-3 justify-center"},No={key:0,class:"mt-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6 shadow-sm"},Ao={class:"flex items-start justify-between"},Po={class:"flex-1"},Io={__name:"NewRequest",setup(e){const s=E(()=>B(()=>import("./SaveDraftModal-oGpggCl4.js"),__vite__mapDeps([0,1,2,3,4]))),o=E(()=>B(()=>import("./ValidationErrorModal-CCRGsN7_.js"),__vite__mapDeps([5,1,2,3,4]))),u=E(()=>B(()=>import("./BookMeetingModal-xTVIUdDO.js"),__vite__mapDeps([6,2,1,3,4]))),v=E(()=>B(()=>import("./SubmissionSuccessModal-B0tA-oV4.js"),__vite__mapDeps([7,1,2,3,4,8]))),y=E(()=>B(()=>import("./DynamicStepRenderer-VkOY7kMr.js"),__vite__mapDeps([9,2,1,3,4,10,11,12,13,14]))),m=O(),f=H(),{totalSteps:g,stepTitles:w,usesConfigurableSteps:n,shouldShowMeetingBanner:a,getCurrentStepTitle:p,getCurrentStepConfig:_,getCouncilName:S}=je(),{showSaveDraftModal:d,showValidationModal:i,showMeetingModal:V,showSubmissionSuccessModal:M,submissionResult:F,handleBookMeeting:N,handleMeetingBooked:fe,handleSaveDraft:K,handleSaveAndClose:pe,handleSubmit:ge,handleViewRequestFromModal:ye,handleGoToDashboardFromModal:ve}=Ee(),{canNavigateNext:he,canSaveDraft:Y,validationErrors:ee,handleNext:te,handlePrevious:W,goBack:be}=Je({getCurrentStepConfig:_,totalSteps:g,usesConfigurableSteps:n,onValidationError:()=>{i.value=!0}}),{requestTypes:xe,selectedRequestTypeDetails:_e,selectRequestType:we,initialize:Se,setupRouteGuard:ke,setupAgeValidation:qe}=Qe();return ke(),qe(ee),Ie(()=>{Se()}),(Ve,x)=>{var se,oe,ne;return r(),c("div",ko,[A(Le,{title:"New Application",onBack:l(be)},{actions:R(()=>[l(Y)?(r(),I(l(L),{key:0,onClick:l(K),variant:"outline",theme:"gray",loading:l(f).isSaving},{default:R(()=>[...x[12]||(x[12]=[$(" Save Draft ",-1)])]),_:1},8,["onClick","loading"])):h("",!0),l(Y)?(r(),I(l(L),{key:1,onClick:l(pe),variant:"outline",theme:"gray",loading:l(f).isSaving},{default:R(()=>[...x[13]||(x[13]=[$(" Save and Close ",-1)])]),_:1},8,["onClick","loading"])):h("",!0)]),_:1},8,["onBack"]),t("div",qo,[t("div",Vo,[A(nt,{"current-step":l(f).currentStep,"total-steps":l(g),"step-titles":l(w)},null,8,["current-step","total-steps","step-titles"])])]),t("main",Co,[t("div",To,[l(p)()==="Type"?(r(),c("div",Do,[A(_t,{modelValue:l(f).formData,"onUpdate:modelValue":x[0]||(x[0]=q=>l(f).formData=q),"request-types":l(xe),onTypeSelected:l(we)},null,8,["modelValue","request-types","onTypeSelected"])])):l(p)()==="Process Info"?(r(),c("div",Ro,[A(It,{"request-type-details":l(_e),"council-name":l(S)(),modelValue:l(f).formData,"onUpdate:modelValue":x[1]||(x[1]=q=>l(f).formData=q),onContinue:l(te)},null,8,["request-type-details","council-name","modelValue","onContinue"])])):l(f).currentStep>=l(g)-1?(r(),c("div",$o,[A(So,{modelValue:l(f).formData,"onUpdate:modelValue":x[2]||(x[2]=q=>l(f).formData=q),"request-type-config":l(f).requestTypeConfig},null,8,["modelValue","request-type-config"])])):l(n)&&l(_)()?(r(),I(l(y),{key:3,stepConfig:l(_)(),modelValue:l(f).formData,"onUpdate:modelValue":x[3]||(x[3]=q=>l(f).formData=q)},null,8,["stepConfig","modelValue"])):(r(),c("div",Mo,[x[14]||(x[14]=z('<div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4"><svg class="h-8 w-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">Unable to Load This Step</h3><p class="text-sm text-gray-600 mb-6"> We&#39;re having trouble loading this step. Please try refreshing or go back to continue your application. </p>',3)),t("div",Fo,[t("button",{onClick:x[4]||(x[4]=q=>Ve.location.reload()),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"}," Refresh Page "),t("button",{onClick:x[5]||(x[5]=(...q)=>l(W)&&l(W)(...q)),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition"}," Go Back "),t("button",{onClick:x[6]||(x[6]=q=>l(m).push("/dashboard")),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition"}," Return to Dashboard ")])]))]),l(a)?(r(),c("div",No,[t("div",Ao,[t("div",Po,[x[15]||(x[15]=z('<div class="flex items-center gap-2 mb-2"><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><h3 class="text-lg font-semibold text-gray-900">Council Meeting Available</h3></div><p class="text-sm text-gray-700 mb-3"> Schedule a meeting with council planners to discuss your application before submitting. This optional step can help clarify requirements and improve your application. </p>',2)),t("button",{onClick:x[7]||(x[7]=(...q)=>l(N)&&l(N)(...q)),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium"}," Request Council Meeting ")])])])):h("",!0),A(lt,{"current-step":l(f).currentStep,"total-steps":l(g),"is-last-step":l(f).isLastStep,"can-go-next":l(he),"can-save-draft":l(Y),"is-saving":l(f).isSaving,"is-submitting":l(f).isSubmitting,onNext:l(te),onPrevious:l(W),onSaveDraft:l(K),onSubmit:l(ge)},null,8,["current-step","total-steps","is-last-step","can-go-next","can-save-draft","is-saving","is-submitting","onNext","onPrevious","onSaveDraft","onSubmit"])]),A(l(s),{show:l(d),"onUpdate:show":x[8]||(x[8]=q=>J(d)?d.value=q:null),"draft-id":l(f).currentRequestId},null,8,["show","draft-id"]),A(l(o),{show:l(i),"onUpdate:show":x[9]||(x[9]=q=>J(i)?i.value=q:null),errors:l(ee)},null,8,["show","errors"]),A(l(u),{show:l(V),"onUpdate:show":x[10]||(x[10]=q=>J(V)?V.value=q:null),"request-id":l(f).currentRequestId,"request-type-code":l(f).formData.request_type,"council-code":l(f).formData.council,onBooked:l(fe)},null,8,["show","request-id","request-type-code","council-code","onBooked"]),A(l(v),{open:l(M),"request-number":(se=l(F))==null?void 0:se.request_number,"request-id":(oe=l(F))==null?void 0:oe.request_id,"sla-info":(ne=l(F))==null?void 0:ne.sla_info,onClose:x[11]||(x[11]=q=>M.value=!1),onViewRequest:l(ye),onGoToDashboard:l(ve)},null,8,["open","request-number","request-id","sla-info","onViewRequest","onGoToDashboard"])])}}},Go=Object.freeze(Object.defineProperty({__proto__:null,default:Io},Symbol.toStringTag,{value:"Module"}));export{Go as N,We as a,Ho as b,Uo as i,Ze as u};
//# sourceMappingURL=NewRequest-BiDgj0h6.js.map
