{"version":3,"file":"RequestTypeBuilder-D8yTJQ1u.js","sources":["../../../../frontend/src/pages/RequestTypeBuilder.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen bg-gray-50\">\n    <div class=\"bg-white shadow-sm border-b border-gray-200\">\n      <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n        <div class=\"flex items-center justify-between\">\n          <div>\n            <h1 class=\"text-2xl font-bold text-gray-900\">Request Type Builder</h1>\n            <p class=\"mt-1 text-sm text-gray-500\">Visual configuration editor for Request Types</p>\n          </div>\n          <div class=\"flex gap-3\">\n            <button\n              @click=\"loadTemplate\"\n              :disabled=\"loading\"\n              class=\"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {{ loading ? 'Loading...' : 'Load Request Type' }}\n            </button>\n            <button\n              @click=\"saveRequestType\"\n              :disabled=\"saving || loading\"\n              class=\"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {{ saving ? 'Saving...' : 'Save Request Type' }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n      <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        <div class=\"lg:col-span-1\">\n          <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n            <h2 class=\"text-lg font-semibold text-gray-900 mb-4\">Basic Information</h2>\n\n            <div class=\"space-y-4\">\n              <div>\n                <label class=\"block text-sm font-medium text-gray-700 mb-1\">Request Type Name</label>\n                <input\n                  v-model=\"requestType.name\"\n                  type=\"text\"\n                  class=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"e.g., Building Consent\"\n                />\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-gray-700 mb-1\">Category</label>\n                <select\n                  v-model=\"requestType.category\"\n                  class=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"\">Select Category</option>\n                  <option value=\"Planning\">Planning</option>\n                  <option value=\"Building\">Building</option>\n                  <option value=\"Social Assistance\">Social Assistance</option>\n                  <option value=\"Environmental\">Environmental</option>\n                  <option value=\"Other\">Other</option>\n                </select>\n              </div>\n\n              <div>\n                <label class=\"block text-sm font-medium text-gray-700 mb-1\">Description</label>\n                <textarea\n                  v-model=\"requestType.description\"\n                  rows=\"4\"\n                  class=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  placeholder=\"Describe this request type...\"\n                ></textarea>\n              </div>\n\n              <div class=\"flex items-center gap-4\">\n                <label class=\"flex items-center\">\n                  <input\n                    v-model=\"requestType.collects_payment\"\n                    type=\"checkbox\"\n                    class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                  />\n                  <span class=\"ml-2 text-sm text-gray-700\">Collects Payment</span>\n                </label>\n                <label class=\"flex items-center\">\n                  <input\n                    v-model=\"requestType.make_payment\"\n                    type=\"checkbox\"\n                    class=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                  />\n                  <span class=\"ml-2 text-sm text-gray-700\">Makes Payment</span>\n                </label>\n              </div>\n            </div>\n          </div>\n\n          <div class=\"mt-6 bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n            <h2 class=\"text-lg font-semibold text-gray-900 mb-4\">Template Library</h2>\n            <div v-if=\"loading\" class=\"text-center py-4 text-gray-500\">Loading templates...</div>\n            <div v-else-if=\"availableTemplates.length === 0\" class=\"text-center py-4 text-gray-500\">No templates available</div>\n            <div v-else class=\"space-y-2\">\n              <button\n                v-for=\"template in availableTemplates\"\n                :key=\"template.name\"\n                @click=\"applyTemplate(template.name)\"\n                class=\"w-full text-left px-4 py-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors\"\n              >\n                <div class=\"font-medium text-gray-900\">{{ template.title }}</div>\n                <div class=\"text-xs text-gray-500 mt-1\">{{ template.description }}</div>\n              </button>\n            </div>\n          </div>\n\n          <div class=\"mt-6 bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n            <h2 class=\"text-lg font-semibold text-gray-900 mb-4\">JSON Export</h2>\n            <button\n              @click=\"showJsonPreview = !showJsonPreview\"\n              class=\"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200\"\n            >\n              {{ showJsonPreview ? 'Hide' : 'Show' }} JSON Preview\n            </button>\n            <div v-if=\"showJsonPreview\" class=\"mt-4\">\n              <textarea\n                :value=\"jsonPreview\"\n                readonly\n                rows=\"12\"\n                class=\"w-full px-3 py-2 border border-gray-300 rounded-lg font-mono text-xs bg-gray-50\"\n              ></textarea>\n              <button\n                @click=\"copyJsonToClipboard\"\n                class=\"mt-2 w-full px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700\"\n              >\n                Copy to Clipboard\n              </button>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"lg:col-span-2\">\n          <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\n            <div class=\"flex items-center justify-between mb-6\">\n              <h2 class=\"text-lg font-semibold text-gray-900\">Steps Configuration</h2>\n              <button\n                @click=\"addStep\"\n                class=\"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700\"\n              >\n                + Add Step\n              </button>\n            </div>\n\n            <div v-if=\"requestType.steps.length === 0\" class=\"text-center py-12 text-gray-500\">\n              <svg class=\"mx-auto h-12 w-12 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"/>\n              </svg>\n              <p class=\"mt-2 text-sm\">No steps configured yet</p>\n              <p class=\"text-xs text-gray-400 mt-1\">Click \"Add Step\" or use a template to get started</p>\n            </div>\n\n            <div v-else class=\"space-y-4\">\n              <div\n                v-for=\"(step, stepIndex) in requestType.steps\"\n                :key=\"stepIndex\"\n                class=\"border border-gray-200 rounded-lg overflow-hidden\"\n              >\n                <div class=\"bg-gray-50 px-4 py-3 flex items-center justify-between border-b border-gray-200\">\n                  <div class=\"flex items-center gap-3\">\n                    <div class=\"flex items-center gap-2\">\n                      <button\n                        @click=\"moveStep(stepIndex, 'up')\"\n                        :disabled=\"stepIndex === 0\"\n                        class=\"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed\"\n                      >\n                        <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 15l7-7 7 7\"/>\n                        </svg>\n                      </button>\n                      <button\n                        @click=\"moveStep(stepIndex, 'down')\"\n                        :disabled=\"stepIndex === requestType.steps.length - 1\"\n                        class=\"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed\"\n                      >\n                        <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 9l-7 7-7-7\"/>\n                        </svg>\n                      </button>\n                    </div>\n                    <span class=\"text-sm font-medium text-gray-900\">Step {{ stepIndex + 1 }}</span>\n                    <input\n                      v-model=\"step.step_title\"\n                      type=\"text\"\n                      class=\"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                      placeholder=\"Step Title\"\n                    />\n                  </div>\n                  <div class=\"flex items-center gap-2\">\n                    <button\n                      @click=\"toggleStep(stepIndex)\"\n                      class=\"text-sm text-gray-600 hover:text-gray-900\"\n                    >\n                      {{ step.expanded ? 'Collapse' : 'Expand' }}\n                    </button>\n                    <button\n                      @click=\"deleteStep(stepIndex)\"\n                      class=\"text-sm text-red-600 hover:text-red-700\"\n                    >\n                      Delete\n                    </button>\n                  </div>\n                </div>\n\n                <div v-if=\"step.expanded\" class=\"p-4\">\n                  <div class=\"grid grid-cols-2 gap-4 mb-4\">\n                    <div>\n                      <label class=\"block text-xs font-medium text-gray-700 mb-1\">Step Code</label>\n                      <input\n                        v-model=\"step.step_code\"\n                        type=\"text\"\n                        class=\"w-full px-2 py-1 border border-gray-300 rounded text-sm\"\n                        placeholder=\"e.g., applicant_details\"\n                      />\n                    </div>\n                    <div>\n                      <label class=\"block text-xs font-medium text-gray-700 mb-1\">Component</label>\n                      <select\n                        v-model=\"step.step_component\"\n                        class=\"w-full px-2 py-1 border border-gray-300 rounded text-sm\"\n                      >\n                        <option value=\"DynamicStepRenderer\">Dynamic Step Renderer</option>\n                        <option value=\"Custom\">Custom Component</option>\n                      </select>\n                    </div>\n                  </div>\n\n                  <div class=\"flex gap-4 mb-4\">\n                    <label class=\"flex items-center text-sm\">\n                      <input v-model=\"step.is_required\" type=\"checkbox\" class=\"mr-2\"/>\n                      Required\n                    </label>\n                    <label class=\"flex items-center text-sm\">\n                      <input v-model=\"step.show_on_review\" type=\"checkbox\" class=\"mr-2\"/>\n                      Show on Review\n                    </label>\n                  </div>\n\n                  <div class=\"mt-4\">\n                    <div class=\"flex items-center justify-between mb-2\">\n                      <h4 class=\"text-sm font-medium text-gray-700\">Sections</h4>\n                      <button\n                        @click=\"addSection(stepIndex)\"\n                        class=\"text-xs px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200\"\n                      >\n                        + Add Section\n                      </button>\n                    </div>\n\n                    <div v-if=\"!step.sections || step.sections.length === 0\" class=\"text-xs text-gray-500 text-center py-4\">\n                      No sections yet\n                    </div>\n\n                    <div v-else class=\"space-y-3\">\n                      <div\n                        v-for=\"(section, sectionIndex) in step.sections\"\n                        :key=\"sectionIndex\"\n                        class=\"bg-gray-50 p-3 rounded border border-gray-200\"\n                      >\n                        <div class=\"flex items-center justify-between mb-2\">\n                          <input\n                            v-model=\"section.section_title\"\n                            type=\"text\"\n                            class=\"flex-1 px-2 py-1 border border-gray-300 rounded text-sm mr-2\"\n                            placeholder=\"Section Title\"\n                          />\n                          <button\n                            @click=\"deleteSection(stepIndex, sectionIndex)\"\n                            class=\"text-xs text-red-600 hover:text-red-700\"\n                          >\n                            Delete\n                          </button>\n                        </div>\n\n                        <div class=\"grid grid-cols-2 gap-2 mb-2\">\n                          <div>\n                            <label class=\"block text-xs text-gray-600 mb-1\">Section Code</label>\n                            <input\n                              v-model=\"section.section_code\"\n                              type=\"text\"\n                              class=\"w-full px-2 py-1 border border-gray-300 rounded text-xs\"\n                              placeholder=\"e.g., personal_info\"\n                            />\n                          </div>\n                          <div>\n                            <label class=\"block text-xs text-gray-600 mb-1\">Section Type</label>\n                            <select\n                              v-model=\"section.section_type\"\n                              class=\"w-full px-2 py-1 border border-gray-300 rounded text-xs\"\n                            >\n                              <option value=\"Standard\">Standard</option>\n                              <option value=\"Tab\">Tab</option>\n                              <option value=\"Accordion\">Accordion</option>\n                            </select>\n                          </div>\n                        </div>\n\n                        <div class=\"mt-3\">\n                          <div class=\"flex items-center justify-between mb-2\">\n                            <span class=\"text-xs font-medium text-gray-700\">Fields</span>\n                            <button\n                              @click=\"addField(stepIndex, sectionIndex)\"\n                              class=\"text-xs px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200\"\n                            >\n                              + Add Field\n                            </button>\n                          </div>\n\n                          <div v-if=\"!section.fields || section.fields.length === 0\" class=\"text-xs text-gray-400 text-center py-2\">\n                            No fields yet\n                          </div>\n\n                          <div v-else class=\"space-y-2\">\n                            <div\n                              v-for=\"(field, fieldIndex) in section.fields\"\n                              :key=\"fieldIndex\"\n                              class=\"bg-white p-2 rounded border border-gray-200\"\n                            >\n                              <div class=\"grid grid-cols-3 gap-2\">\n                                <div class=\"col-span-2\">\n                                  <input\n                                    v-model=\"field.field_label\"\n                                    type=\"text\"\n                                    class=\"w-full px-2 py-1 border border-gray-300 rounded text-xs\"\n                                    placeholder=\"Field Label\"\n                                  />\n                                </div>\n                                <div>\n                                  <select\n                                    v-model=\"field.field_type\"\n                                    class=\"w-full px-2 py-1 border border-gray-300 rounded text-xs\"\n                                  >\n                                    <option value=\"Data\">Text</option>\n                                    <option value=\"Text\">Textarea</option>\n                                    <option value=\"Select\">Select</option>\n                                    <option value=\"Date\">Date</option>\n                                    <option value=\"Check\">Checkbox</option>\n                                    <option value=\"Currency\">Currency</option>\n                                    <option value=\"Int\">Integer</option>\n                                    <option value=\"Float\">Float</option>\n                                  </select>\n                                </div>\n                              </div>\n\n                              <div class=\"grid grid-cols-3 gap-2 mt-2\">\n                                <div class=\"col-span-2\">\n                                  <input\n                                    v-model=\"field.field_name\"\n                                    type=\"text\"\n                                    class=\"w-full px-2 py-1 border border-gray-300 rounded text-xs\"\n                                    placeholder=\"field_name\"\n                                  />\n                                </div>\n                                <div class=\"flex items-center gap-2\">\n                                  <label class=\"flex items-center text-xs\">\n                                    <input v-model=\"field.is_required\" type=\"checkbox\" class=\"mr-1 text-xs\"/>\n                                    Required\n                                  </label>\n                                  <button\n                                    @click=\"deleteField(stepIndex, sectionIndex, fieldIndex)\"\n                                    class=\"text-xs text-red-600 hover:text-red-700 ml-auto\"\n                                  >\n                                    âœ•\n                                  </button>\n                                </div>\n                              </div>\n\n                              <div v-if=\"field.field_type === 'Select'\" class=\"mt-2\">\n                                <textarea\n                                  v-model=\"field.options\"\n                                  rows=\"2\"\n                                  class=\"w-full px-2 py-1 border border-gray-300 rounded text-xs\"\n                                  placeholder=\"Options (one per line)\"\n                                ></textarea>\n                              </div>\n\n                              <div class=\"mt-2\">\n                                <input\n                                  v-model=\"field.validation\"\n                                  type=\"text\"\n                                  class=\"w-full px-2 py-1 border border-gray-300 rounded text-xs\"\n                                  placeholder=\"Validation: email, phone, eval:value >= 18\"\n                                />\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script setup>\nimport { call } from \"frappe-ui\"\nimport { computed, onMounted, reactive, ref } from \"vue\"\n\n// Request Type Data Model\nconst requestType = reactive({\n\tname: \"\",\n\tcategory: \"\",\n\tdescription: \"\",\n\tcollects_payment: false,\n\tmake_payment: false,\n\tsteps: [],\n})\n\n// Available Templates\nconst availableTemplates = ref([])\nconst loading = ref(false)\nconst saving = ref(false)\nconst showJsonPreview = ref(false)\n\n// JSON Preview computed\nconst jsonPreview = computed(() => {\n\treturn JSON.stringify(requestType, null, 2)\n})\n\n// --- Utility Functions ---\n\n// Function to renumber steps after move/delete\nfunction renumberSteps() {\n\trequestType.steps.forEach((step, i) => {\n\t\tstep.step_number = i + 1\n\t})\n}\n\n// Function to generate a stable unique ID for v-for keys\nfunction generateUniqueId() {\n\treturn Date.now().toString(36) + Math.random().toString(36).substr(2, 5)\n}\n\n// --- Step Management ---\n\nfunction addStep() {\n\trequestType.steps.push({\n\t\tid: generateUniqueId(), // Added stable ID\n\t\tstep_number: requestType.steps.length + 1,\n\t\tstep_code: `step_${requestType.steps.length + 1}`,\n\t\tstep_title: `Step ${requestType.steps.length + 1}`,\n\t\tstep_component: \"DynamicStepRenderer\",\n\t\tis_required: true,\n\t\tshow_on_review: true,\n\t\texpanded: true, // Ensure it's expanded by default\n\t\tsections: [],\n\t})\n}\n\nfunction deleteStep(index) {\n\tif (confirm(\"Are you sure you want to delete this step?\")) {\n\t\trequestType.steps.splice(index, 1)\n\t\trenumberSteps() // Renumber after deletion\n\t}\n}\n\nfunction moveStep(index, direction) {\n\tconst newIndex = direction === \"up\" ? index - 1 : index + 1\n\tif (newIndex >= 0 && newIndex < requestType.steps.length) {\n\t\t// Standard swap logic\n\t\tconst temp = requestType.steps[index]\n\t\trequestType.steps[index] = requestType.steps[newIndex]\n\t\trequestType.steps[newIndex] = temp\n\t\trenumberSteps() // Renumber after move\n\t}\n}\n\nfunction toggleStep(index) {\n\t// Ensure the property exists before toggling\n\tconst step = requestType.steps[index]\n\tstep.expanded = step.expanded === undefined ? false : !step.expanded\n}\n\n// --- Section Management ---\nfunction addSection(stepIndex) {\n\tif (!requestType.steps[stepIndex].sections) {\n\t\trequestType.steps[stepIndex].sections = []\n\t}\n\trequestType.steps[stepIndex].sections.push({\n\t\tid: generateUniqueId(), // Added stable ID\n\t\tsection_code: `section_${requestType.steps[stepIndex].sections.length + 1}`,\n\t\tsection_title: \"\",\n\t\tsection_type: \"Standard\",\n\t\tsequence: requestType.steps[stepIndex].sections.length + 1,\n\t\tis_enabled: true,\n\t\tis_required: true,\n\t\tshow_on_review: true,\n\t\tfields: [],\n\t})\n}\n\nfunction deleteSection(stepIndex, sectionIndex) {\n\trequestType.steps[stepIndex].sections.splice(sectionIndex, 1)\n}\n\n// --- Field Management ---\nfunction addField(stepIndex, sectionIndex) {\n\tif (!requestType.steps[stepIndex].sections[sectionIndex].fields) {\n\t\trequestType.steps[stepIndex].sections[sectionIndex].fields = []\n\t}\n\trequestType.steps[stepIndex].sections[sectionIndex].fields.push({\n\t\tid: generateUniqueId(), // Added stable ID\n\t\tfield_name: \"\",\n\t\tfield_label: \"\",\n\t\tfield_type: \"Data\",\n\t\tis_required: false,\n\t\tshow_on_review: true,\n\t\toptions: \"\",\n\t\tvalidation: \"\",\n\t})\n}\n\nfunction deleteField(stepIndex, sectionIndex, fieldIndex) {\n\trequestType.steps[stepIndex].sections[sectionIndex].fields.splice(\n\t\tfieldIndex,\n\t\t1,\n\t)\n}\n\n// --- API Calls / Load / Save ---\n\nasync function loadAvailableTemplates() {\n\ttry {\n\t\tloading.value = true\n\t\tconst response = await call(\"lodgeick.api.get_step_templates\")\n\t\tavailableTemplates.value = response || []\n\t} catch (error) {\n\t\tconsole.error(\"Failed to load templates:\", error)\n\t\talert(\"Failed to load templates from backend\")\n\t} finally {\n\t\tloading.value = false\n\t}\n}\n\nasync function applyTemplate(templateName) {\n\ttry {\n\t\tloading.value = true\n\t\tconst response = await call(\"lodgeick.api.load_step_template\", {\n\t\t\ttemplate_name: templateName,\n\t\t})\n\n\t\tif (!response || !response.success || !response.template) {\n\t\t\talert(`Failed to load template: ${response?.error || \"Unknown error\"}`)\n\t\t\treturn\n\t\t}\n\n\t\tconst template = response.template\n\n\t\t// Create new step from template\n\t\tconst newStep = {\n\t\t\tid: generateUniqueId(), // Ensure new step has a unique ID\n\t\t\tstep_number: requestType.steps.length + 1,\n\t\t\tstep_code: template.step_config.step_code,\n\t\t\tstep_title: template.step_config.step_title,\n\t\t\tstep_component: template.step_config.step_component,\n\t\t\tis_enabled: template.step_config.is_enabled ?? true,\n\t\t\tis_required: template.step_config.is_required ?? true,\n\t\t\tshow_on_review: template.step_config.show_on_review ?? true,\n\t\t\tdescription: template.step_config.description || \"\",\n\t\t\texpanded: true, // IMPORTANT: Ensure step is expanded for visibility\n\t\t\tsections: [],\n\t\t}\n\n\t\t// Add sections from template (Defensive checks added for existence)\n\t\tif (template.sections && Array.isArray(template.sections)) {\n\t\t\tfor (const section of template.sections) {\n\t\t\t\tconst newSection = {\n\t\t\t\t\tid: generateUniqueId(), // Ensure new section has a unique ID\n\t\t\t\t\tsection_code: section.section_code,\n\t\t\t\t\tsection_title: section.section_title,\n\t\t\t\t\tsection_type: section.section_type,\n\t\t\t\t\t// ... (other section properties)\n\t\t\t\t\tfields: [],\n\t\t\t\t}\n\n\t\t\t\t// Add fields from template\n\t\t\t\tif (section.fields && Array.isArray(section.fields)) {\n\t\t\t\t\tfor (const field of section.fields) {\n\t\t\t\t\t\tnewSection.fields.push({\n\t\t\t\t\t\t\tid: generateUniqueId(), // Ensure new field has a unique ID\n\t\t\t\t\t\t\tfield_name: field.field_name,\n\t\t\t\t\t\t\t// ... (other field properties)\n\t\t\t\t\t\t\t// Note: Only necessary properties for the builder were kept for brevity\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tnewStep.sections.push(newSection)\n\t\t\t}\n\t\t}\n\n\t\t// Add step to request type\n\t\trequestType.steps.push(newStep)\n\n\t\talert(`Template \"${template.template_title}\" applied successfully!`)\n\t} catch (error) {\n\t\tconsole.error(\"Failed to apply template:\", error)\n\t\talert(\"Failed to apply template\")\n\t} finally {\n\t\tloading.value = false\n\t}\n}\n\nfunction loadTemplate() {\n\tconst rtName = prompt(\"Enter Request Type name to load:\")\n\tif (!rtName) return\n\n\tloadRequestTypeConfig(rtName)\n}\n\nasync function loadRequestTypeConfig(rtName) {\n\ttry {\n\t\tloading.value = true\n\t\tconst response = await call(\"lodgeick.api.load_request_type_config\", {\n\t\t\trequest_type_name: rtName,\n\t\t})\n\n\t\tif (!response.success) {\n\t\t\talert(`Failed to load Request Type: ${response.error}`)\n\t\t\treturn\n\t\t}\n\n\t\tconst config = response.config\n\n\t\t// 1. Update basic metadata\n\t\trequestType.name = config.name\n\t\trequestType.category = config.category\n\t\trequestType.description = config.description\n\t\trequestType.collects_payment = config.collects_payment\n\t\trequestType.make_payment = config.make_payment\n\n\t\t// 2. Process steps to ensure IDs and expanded status\n\t\trequestType.steps = (config.steps || []).map((step) => {\n\t\t\t// Ensure the step is expanded and has an ID for proper rendering\n\t\t\tstep.expanded = true\n\t\t\tstep.id = step.id || generateUniqueId()\n\n\t\t\t// Ensure sections also have IDs\n\t\t\tstep.sections = (step.sections || []).map((section) => {\n\t\t\t\tsection.id = section.id || generateUniqueId()\n\n\t\t\t\t// Ensure fields also have IDs\n\t\t\t\tsection.fields = (section.fields || []).map((field) => {\n\t\t\t\t\tfield.id = field.id || generateUniqueId()\n\t\t\t\t\treturn field\n\t\t\t\t})\n\n\t\t\t\treturn section\n\t\t\t})\n\n\t\t\treturn step\n\t\t})\n\n\t\talert(`Request Type \"${rtName}\" loaded successfully!`)\n\t} catch (error) {\n\t\tconsole.error(\"Failed to load Request Type:\", error)\n\t\talert(\"Failed to load Request Type\")\n\t} finally {\n\t\tloading.value = false\n\t}\n}\n\n// Save\nasync function saveRequestType() {\n\t// ... (Existing validation logic remains, but more robust checks are highly recommended)\n\t// --- New: Preliminary Uniqueness Check (Crucial for robust API/DB saves) ---\n\tconst stepCodes = new Set()\n\tconst fieldNames = new Set()\n\n\tfor (const step of requestType.steps) {\n\t\tif (stepCodes.has(step.step_code)) {\n\t\t\talert(`Error: Duplicate Step Code found: ${step.step_code}`)\n\t\t\treturn\n\t\t}\n\t\tstepCodes.add(step.step_code)\n\n\t\tif (!step.step_code || !step.step_title) {\n\t\t\talert(\"All steps must have a step code and title\")\n\t\t\treturn\n\t\t}\n\n\t\tfor (const section of step.sections) {\n\t\t\tif (!section.section_code || !section.section_title) {\n\t\t\t\talert(\"All sections must have a code and title\")\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tfor (const field of section.fields) {\n\t\t\t\tif (!field.field_name || !field.field_label || !field.field_type) {\n\t\t\t\t\talert(\"All fields must have a name, label, and type\")\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (fieldNames.has(field.field_name)) {\n\t\t\t\t\talert(\n\t\t\t\t\t\t`Error: Duplicate Field Name found: ${field.field_name}. Field names must be unique across the entire Request Type.`,\n\t\t\t\t\t)\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tfieldNames.add(field.field_name)\n\t\t\t}\n\t\t}\n\t}\n\t// --- End Uniqueness Check ---\n\n\ttry {\n\t\tsaving.value = true\n\t\t// NOTE: It is advisable to clean the data before sending, removing the temporary 'id' and 'expanded' properties.\n\t\tconst configToSave = JSON.parse(JSON.stringify(requestType)) // Deep clone\n\t\tconfigToSave.steps.forEach((step) => {\n\t\t\tdelete step.id // Remove temporary ID\n\t\t\tdelete step.expanded // Remove temporary UI state\n\n\t\t\tif (step.sections) {\n\t\t\t\tstep.sections.forEach((section) => {\n\t\t\t\t\tdelete section.id\n\t\t\t\t\tif (section.fields) {\n\t\t\t\t\t\tsection.fields.forEach((field) => {\n\t\t\t\t\t\t\tdelete field.id\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\n\t\tconst response = await call(\"lodgeick.api.save_request_type_config\", {\n\t\t\tconfig: configToSave,\n\t\t})\n\n\t\tif (!response.success) {\n\t\t\talert(`Failed to save: ${response.error}`)\n\t\t\treturn\n\t\t}\n\n\t\talert(response.message)\n\t} catch (error) {\n\t\tconsole.error(\"Failed to save Request Type:\", error)\n\t\talert(\"Failed to save Request Type\")\n\t} finally {\n\t\tsaving.value = false\n\t}\n}\n\n// JSON Export\nfunction copyJsonToClipboard() {\n\tnavigator.clipboard\n\t\t.writeText(jsonPreview.value)\n\t\t.then(() => {\n\t\t\talert(\"JSON copied to clipboard!\")\n\t\t})\n\t\t.catch((err) => {\n\t\t\tconsole.error(\"Failed to copy:\", err)\n\t\t\talert(\"Failed to copy to clipboard\")\n\t\t})\n}\n\n// Load templates on mount\nonMounted(() => {\n\tloadAvailableTemplates()\n})\n</script>"],"names":["requestType","reactive","availableTemplates","ref","loading","saving","showJsonPreview","jsonPreview","computed","renumberSteps","step","i","generateUniqueId","addStep","deleteStep","index","moveStep","direction","newIndex","temp","toggleStep","addSection","stepIndex","deleteSection","sectionIndex","addField","deleteField","fieldIndex","loadAvailableTemplates","__async","response","call","error","applyTemplate","templateName","template","newStep","_a","_b","_c","section","newSection","field","loadTemplate","rtName","loadRequestTypeConfig","config","saveRequestType","stepCodes","fieldNames","configToSave","copyJsonToClipboard","err","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_cache","_hoisted_12","$event","_vModelText","_vModelSelect","_hoisted_13","_hoisted_14","_vModelCheckbox","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_Fragment","_renderList","_hoisted_21","_toDisplayString","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_35","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","_hoisted_44","_hoisted_45","_hoisted_47","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_56","_hoisted_57","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_69","_hoisted_70","_hoisted_72","_hoisted_73","_hoisted_75","_hoisted_76","_hoisted_78"],"mappings":"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"}