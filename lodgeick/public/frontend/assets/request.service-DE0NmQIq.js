const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/errorStore-HMmHMoay.js","assets/index-CQ4Fw3yC.js","assets/index-BlUHqveC.css"])))=>i.map(i=>d[i]);
var h=Object.defineProperty;var _=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable;var f=(a,e,t)=>e in a?h(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,p=(a,e)=>{for(var t in e||(e={}))y.call(e,t)&&f(a,t,e[t]);if(_)for(var t of _(e))m.call(e,t)&&f(a,t,e[t]);return a};var s=(a,e,t)=>new Promise((c,r)=>{var o=d=>{try{u(t.next(d))}catch(l){r(l)}},i=d=>{try{u(t.throw(d))}catch(l){r(l)}},u=d=>d.done?c(d.value):Promise.resolve(d.value).then(o,i);u((t=t.apply(a,e)).next())});import{n as w,K as g}from"./index-CQ4Fw3yC.js";class q{constructor(){this.defaultOptions={onError:this.handleError.bind(this),onSuccess:this.handleSuccess.bind(this)}}createResource(e){return w(p(p({},this.defaultOptions),e))}handleError(e){console.error("[API Error]",e);const t=e!=null&&e.exc_type?e.exc_type:(e==null?void 0:e.message)||"An unexpected error occurred";return g(()=>s(this,null,function*(){const{useErrorStore:c}=yield import("./errorStore-HMmHMoay.js");return{useErrorStore:c}}),__vite__mapDeps([0,1,2])).then(({useErrorStore:c})=>{c().addError({message:t,type:"api_error",context:e})}).catch(c=>{console.error("Could not add error to store:",c)}),{error:t}}handleSuccess(e){return e}call(c){return s(this,arguments,function*(e,t={}){try{console.log(`[BaseAPIClient] Calling ${e} with args:`,t),console.log("[BaseAPIClient] Args JSON:",JSON.stringify(t,null,2));const r={"Content-Type":"application/json"};window.csrf_token&&(r["X-Frappe-CSRF-Token"]=window.csrf_token);const o=yield fetch("/api/method/"+e,{method:"POST",headers:r,credentials:"include",body:JSON.stringify(t)});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const i=yield o.json();if(i.exc)throw new Error(i.exc);return i.message}catch(r){throw this.handleError(r),r}})}uploadFile(c){return s(this,arguments,function*(e,t={}){try{const r=new FormData;r.append("file",e),t.doctype&&r.append("doctype",t.doctype),t.docname&&r.append("docname",t.docname),t.fieldname&&r.append("fieldname",t.fieldname),t.is_private!==void 0&&r.append("is_private",t.is_private?"1":"0");const o={};window.csrf_token&&(o["X-Frappe-CSRF-Token"]=window.csrf_token);const i=yield fetch("/api/method/upload_file",{method:"POST",headers:o,credentials:"include",body:r});if(!i.ok)throw new Error(`Upload failed: ${i.statusText}`);const u=yield i.json();if(u.exc)throw new Error(u.exc);return u.message}catch(r){throw this.handleError(r),r}})}}const n=new q;class R{createDraft(e,t){return s(this,null,function*(){return n.call("lodgeick.api.create_draft_request",{data:e,current_step:t})})}getRequest(e){return n.createResource({url:"frappe.client.get",params:{doctype:"Request",name:e},auto:!0})}getRequestTypeConfig(e){return n.createResource({url:"lodgeick.api.get_request_type_config",params:{request_type_code:e},auto:!0})}updateRequest(e,t){return s(this,null,function*(){return n.call("frappe.client.set_value",{doctype:"Request",name:e,fieldname:t})})}submitRequest(e){return s(this,null,function*(){return n.call("lodgeick.api.submit_request",{request_id:e})})}getUserRequests(){return n.createResource({url:"lodgeick.api.get_user_requests",auto:!0,cache:["user-requests"]})}getRequestsByStatus(e){return n.createResource({url:"frappe.client.get_list",params:{doctype:"Request",filters:{status:e},fields:["name","request_type","requester_name","status","created_at","brief_description"],order_by:"modified desc"},auto:!0})}deleteDraft(e){return s(this,null,function*(){return n.call("frappe.client.delete",{doctype:"Request",name:e})})}getRequestWithApplication(e){return s(this,null,function*(){return n.call("lodgeick.api.get_request_with_application",{request_id:e})})}validateStep(e,t,c){return s(this,null,function*(){return n.call("lodgeick.api.validate_request_step",{request_id:e,step_number:t,step_data:c})})}}const E=new R;export{E as r};
//# sourceMappingURL=request.service-DE0NmQIq.js.map
