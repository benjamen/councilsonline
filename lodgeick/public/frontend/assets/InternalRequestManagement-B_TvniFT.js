var z=(j,M,g)=>new Promise((x,m)=>{var w=u=>{try{y(g.next(u))}catch(v){m(v)}},b=u=>{try{y(g.throw(u))}catch(v){m(v)}},y=u=>u.done?x(u.value):Promise.resolve(u.value).then(w,b);y((g=g.apply(j,M)).next())});import{f as F,j as C,k as E,i as $,r as W,c as a,o as i,a as e,d as c,w as q,h as V,u as _,F as U,m as N,b as h,p as R,t as d,s as I,g as B,I as Q,l as S,v as A,n as H}from"./index-CFWHMjxf.js";import{D as Z}from"./Dropdown-CeZIIK0_.js";import{_ as G}from"./StatusBadge-BMh13qZj.js";import{_ as f}from"./StatCard-JyEL3ZIY.js";const J={class:"space-y-6"},K={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},X={class:"bg-white rounded-lg shadow-sm border border-gray-200"},Y={class:"p-6 border-b border-gray-200"},ee={class:"flex justify-between items-center"},te={class:"divide-y divide-gray-200"},se={key:0,class:"p-12 text-center"},oe={key:1,class:"p-12 text-center text-gray-500"},ne={class:"flex items-start justify-between"},re={class:"flex items-start space-x-4 flex-1"},le=["checked","onChange"],ae={class:"flex-1"},ie={class:"flex items-center space-x-3 mb-2"},de={class:"text-sm text-gray-600 mb-3"},ue={class:"flex items-center space-x-4 text-sm text-gray-500"},ce={key:0,class:"flex items-center"},pe={key:1,class:"flex items-center"},ge={key:2,class:"flex items-center"},me={key:3,class:"flex items-center"},ve={class:"flex items-center space-x-2 ml-4"},xe=["onClick"],ye=["onClick"],he={__name:"TaskManagement",setup(j){const M=F(),g=C(!1),x=E({url:"lodgeick.lodgeick.doctype.task.task.get_my_tasks",auto:!0}),m=$(()=>{const l=x.data||[],o=new Date().toDateString();return{myTasks:l.length,inProgress:l.filter(p=>p.status==="Open"||p.status==="Working").length,completedToday:l.filter(p=>p.status==="Completed"&&new Date(p.completed_on).toDateString()===o).length,overdue:l.filter(p=>p.status!=="Completed"&&p.due_date&&new Date(p.due_date)<new Date).length}}),w=l=>{const o={Low:"bg-gray-100 text-gray-800",Medium:"bg-blue-100 text-blue-800",High:"bg-orange-100 text-orange-800",Urgent:"bg-red-100 text-red-800"};return o[l]||o.Medium},b=l=>l?new Date(l)<new Date:!1,y=l=>l?new Date(l).toLocaleDateString("en-NZ",{day:"numeric",month:"short",year:"numeric"}):"",u=l=>z(this,null,function*(){const o=l.status==="Completed"?"Open":"Completed";console.log("Toggle task status:",l.name,o),x.reload()}),v=l=>{M.push({name:"InternalRequestDetail",params:{id:l}})},D=l=>{console.log("Edit task:",l.name)};return(l,o)=>{const p=W("Button");return i(),a("div",J,[e("div",K,[c(f,{title:"My Tasks",value:m.value.myTasks,icon:"clipboard",color:"blue"},null,8,["value"]),c(f,{title:"In Progress",value:m.value.inProgress,icon:"clock",color:"yellow"},null,8,["value"]),c(f,{title:"Completed Today",value:m.value.completedToday,icon:"check",color:"green"},null,8,["value"]),c(f,{title:"Overdue",value:m.value.overdue,icon:"alert-triangle",color:"red"},null,8,["value"])]),e("div",X,[e("div",Y,[e("div",ee,[o[3]||(o[3]=e("h2",{class:"text-lg font-semibold text-gray-900"},"My Tasks",-1)),c(p,{onClick:o[0]||(o[0]=r=>g.value=!0),variant:"solid",theme:"green"},{prefix:q(()=>[...o[1]||(o[1]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:q(()=>[o[2]||(o[2]=V(" New Task ",-1))]),_:1})])]),e("div",te,[_(x).loading?(i(),a("div",se,[...o[4]||(o[4]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"},null,-1)])])):!_(x).data||_(x).data.length===0?(i(),a("div",oe,[...o[5]||(o[5]=[e("svg",{class:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),e("p",null,"No tasks assigned",-1)])])):(i(!0),a(U,{key:2},N(_(x).data,r=>(i(),a("div",{key:r.name,class:"p-6 hover:bg-gray-50 transition-colors"},[e("div",ne,[e("div",re,[e("input",{type:"checkbox",checked:r.status==="Completed",onChange:T=>u(r),class:"mt-1 h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded cursor-pointer"},null,40,le),e("div",ae,[e("div",ie,[e("h3",{class:R(["text-base font-medium",r.status==="Completed"?"text-gray-400 line-through":"text-gray-900"])},d(r.subject),3),r.priority?(i(),a("span",{key:0,class:R(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",w(r.priority)])},d(r.priority),3)):h("",!0)]),e("p",de,d(r.description),1),e("div",ue,[r.request?(i(),a("div",ce,[o[6]||(o[6]=e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),V(" "+d(r.request_number),1)])):h("",!0),r.expected_time?(i(),a("div",pe,[o[7]||(o[7]=e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),V(" "+d(r.expected_time)+" hours ",1)])):h("",!0),r.costing_amount?(i(),a("div",ge,[o[8]||(o[8]=e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),V(" $"+d(r.costing_amount),1)])):h("",!0),r.due_date?(i(),a("div",me,[o[9]||(o[9]=e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("span",{class:R(b(r.due_date)?"text-red-600 font-medium":"")},d(y(r.due_date)),3)])):h("",!0)])])]),e("div",ve,[r.request?(i(),a("button",{key:0,onClick:T=>v(r.request),class:"p-2 text-gray-400 hover:text-blue-600 transition",title:"View Request"},[...o[10]||(o[10]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])],8,xe)):h("",!0),e("button",{onClick:T=>D(r),class:"p-2 text-gray-400 hover:text-green-600 transition",title:"Edit Task"},[...o[11]||(o[11]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,ye)])])]))),128))])])])}}},_e={class:"min-h-screen bg-gray-50"},fe={class:"bg-white shadow-sm border-b border-gray-200"},we={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},be={class:"flex justify-between items-center py-4"},ke={class:"flex items-center space-x-4"},Ce={class:"flex items-center space-x-2 text-gray-700 hover:text-gray-900"},Me={class:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},$e={class:"text-sm font-medium text-green-600"},Re={class:"text-sm font-medium"},Te={class:"flex space-x-6 border-t border-gray-200 -mb-px"},Ve=["onClick"],je={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},De={key:0},Ie={class:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8"},Be={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},Se={class:"grid md:grid-cols-4 gap-4"},Ae={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},qe={class:"overflow-x-auto"},Ue={class:"min-w-full divide-y divide-gray-200"},Ne={class:"bg-white divide-y divide-gray-200"},Le={key:0},Pe={key:1},ze=["onClick"],He={class:"text-sm font-medium text-gray-900"},Fe={class:"text-sm text-gray-500"},Ee={class:"px-6 py-4 whitespace-nowrap"},Oe={class:"text-sm text-gray-900"},We={class:"text-sm text-gray-500"},Qe={class:"px-6 py-4"},Ze={class:"text-sm text-gray-900"},Ge={class:"px-6 py-4 whitespace-nowrap"},Je={class:"px-6 py-4 whitespace-nowrap"},Ke={key:0,class:"flex items-center"},Xe={class:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-2"},Ye={class:"text-xs font-medium text-green-600"},et={class:"text-sm text-gray-900"},tt={key:1,class:"text-sm text-gray-400"},st={class:"px-6 py-4 whitespace-nowrap"},ot={class:"text-sm text-gray-900"},nt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},rt=["onClick"],lt=["onClick"],at={key:1},it={key:2},mt={__name:"InternalRequestManagement",setup(j){const M=F(),g=C("requests"),x=[{id:"requests",label:"All Requests"},{id:"tasks",label:"My Tasks"},{id:"analytics",label:"Analytics"}],m=C(""),w=C(""),b=C(""),y=C(""),u=E({url:"lodgeick.lodgeick.doctype.request.request.get_all_requests_for_staff",auto:!0}),v=$(()=>{const n=u.data||[];return{total:n.length,unassigned:n.filter(t=>!t.assigned_to).length,inProgress:n.filter(t=>t.status==="Under Review").length,rfi:n.filter(t=>t.status==="RFI Issued").length,completed:n.filter(t=>["Approved","Declined","Withdrawn"].includes(t.status)).length}}),D=$(()=>{let n=u.data||[];if(m.value){const t=m.value.toLowerCase();n=n.filter(s=>{var k,L,P;return((k=s.request_number)==null?void 0:k.toLowerCase().includes(t))||((L=s.property_address)==null?void 0:L.toLowerCase().includes(t))||((P=s.applicant_name)==null?void 0:P.toLowerCase().includes(t))})}return w.value&&(n=n.filter(t=>t.status===w.value)),b.value==="unassigned"?n=n.filter(t=>!t.assigned_to):b.value==="me"&&(n=n.filter(t=>t.assigned_to===I.user)),y.value&&(n=n.filter(t=>t.request_type===y.value)),n}),l=$(()=>I.user||"User"),o=$(()=>l.value.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2)),p=n=>n?n.split(" ").map(t=>t[0]).join("").toUpperCase().substring(0,2):"?",r=n=>{M.push({name:"InternalRequestDetail",params:{id:n}})},T=n=>{console.log("Assign request:",n)},O=[{label:"My Profile",onClick:()=>console.log("Profile")},{label:"Settings",onClick:()=>console.log("Settings")},{label:"Logout",onClick:()=>I.logout.submit()}];return(n,t)=>(i(),a("div",_e,[e("header",fe,[e("div",we,[e("div",be,[t[5]||(t[5]=B('<div class="flex items-center space-x-3"><div class="w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path></svg></div><div><h1 class="text-xl font-bold text-gray-900">Easy Council</h1><p class="text-xs text-gray-500">Internal Request Management</p></div></div>',1)),e("div",ke,[c(_(Z),{options:O},{default:q(({open:s})=>[e("button",Ce,[e("div",Me,[e("span",$e,d(o.value),1)]),e("span",Re,d(l.value),1),t[4]||(t[4]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),_:1})])]),e("div",Te,[(i(),a(U,null,N(x,s=>e("button",{key:s.id,onClick:k=>g.value=s.id,class:R(["py-4 px-1 border-b-2 font-medium text-sm transition-colors",g.value===s.id?"border-green-600 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},d(s.label),11,Ve)),64))])])]),e("main",je,[g.value==="requests"?(i(),a("div",De,[e("div",Ie,[c(f,{title:"Total Requests",value:v.value.total,icon:"inbox",color:"blue"},null,8,["value"]),c(f,{title:"New/Unassigned",value:v.value.unassigned,icon:"alert-circle",color:"red"},null,8,["value"]),c(f,{title:"In Progress",value:v.value.inProgress,icon:"clock",color:"yellow"},null,8,["value"]),c(f,{title:"RFI Issued",value:v.value.rfi,icon:"help-circle",color:"orange"},null,8,["value"]),c(f,{title:"Completed",value:v.value.completed,icon:"check-circle",color:"green"},null,8,["value"])]),e("div",Be,[e("div",Se,[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),c(_(Q),{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),placeholder:"Request number, property..."},null,8,["modelValue"])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Status",-1)),S(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>w.value=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg"},[...t[7]||(t[7]=[B('<option value="">All Statuses</option><option value="Submitted">Submitted</option><option value="Under Review">Under Review</option><option value="RFI Issued">RFI Issued</option><option value="Approved">Approved</option><option value="Declined">Declined</option>',6)])],512),[[A,w.value]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Assigned To",-1)),S(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>b.value=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg"},[...t[9]||(t[9]=[e("option",{value:""},"All Staff",-1),e("option",{value:"unassigned"},"Unassigned",-1),e("option",{value:"me"},"Assigned to Me",-1)])],512),[[A,b.value]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Request Type",-1)),S(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>y.value=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg"},[...t[11]||(t[11]=[e("option",{value:""},"All Types",-1),e("option",{value:"Building Consent"},"Building Consent",-1),e("option",{value:"Resource Consent"},"Resource Consent",-1),e("option",{value:"LIM"},"LIM Report",-1)])],512),[[A,y.value]])])])]),e("div",Ae,[e("div",qe,[e("table",Ue,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Request "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Applicant "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Property "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Assigned To "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Days Elapsed "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",Ne,[_(u).loading?(i(),a("tr",Le,[...t[13]||(t[13]=[e("td",{colspan:"7",class:"px-6 py-12 text-center text-gray-500"},[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})],-1)])])):!_(u).data||_(u).data.length===0?(i(),a("tr",Pe,[...t[14]||(t[14]=[e("td",{colspan:"7",class:"px-6 py-12 text-center text-gray-500"}," No requests found ",-1)])])):(i(!0),a(U,{key:2},N(D.value,s=>(i(),a("tr",{key:s.name,class:"hover:bg-gray-50 cursor-pointer"},[e("td",{class:"px-6 py-4 whitespace-nowrap",onClick:k=>r(s.name)},[e("div",He,d(s.request_number),1),e("div",Fe,d(s.request_type),1)],8,ze),e("td",Ee,[e("div",Oe,d(s.applicant_name||s.applicant),1),e("div",We,d(s.applicant_email),1)]),e("td",Qe,[e("div",Ze,d(s.property_address),1)]),e("td",Ge,[c(G,{status:s.status},null,8,["status"])]),e("td",Je,[s.assigned_to?(i(),a("div",Ke,[e("div",Xe,[e("span",Ye,d(p(s.assigned_to)),1)]),e("span",et,d(s.assigned_to_name||s.assigned_to),1)])):(i(),a("span",tt,"Unassigned"))]),e("td",st,[e("div",ot,d(s.working_days_elapsed||0)+" days",1),s.working_days_remaining?(i(),a("div",{key:0,class:R(["text-xs",s.is_overdue?"text-red-600":"text-gray-500"])},d(s.working_days_remaining)+" remaining ",3)):h("",!0)]),e("td",nt,[e("button",{onClick:H(k=>T(s.name),["stop"]),class:"text-green-600 hover:text-green-900 mr-3"}," Assign ",8,rt),e("button",{onClick:H(k=>r(s.name),["stop"]),class:"text-blue-600 hover:text-blue-900"}," View ",8,lt)])]))),128))])])])])])):h("",!0),g.value==="tasks"?(i(),a("div",at,[c(he)])):h("",!0),g.value==="analytics"?(i(),a("div",it,[...t[16]||(t[16]=[B('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center"><svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg><h3 class="text-lg font-medium text-gray-900 mb-2">Analytics Dashboard</h3><p class="text-gray-500">Performance metrics and reporting coming soon</p></div>',1)])])):h("",!0)])]))}};export{mt as default};
//# sourceMappingURL=InternalRequestManagement-B_TvniFT.js.map
