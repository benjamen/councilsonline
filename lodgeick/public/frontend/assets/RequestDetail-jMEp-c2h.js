var h=(j,M,u)=>new Promise((k,g)=>{var y=s=>{try{m(u.next(s))}catch(v){g(v)}},b=s=>{try{m(u.throw(s))}catch(v){g(v)}},m=s=>s.done?k(s.value):Promise.resolve(s.value).then(y,b);m((u=u.apply(j,M)).next())});import{A as R,f as L,r as w,k as O,c as f,o as i,a as t,d as r,t as o,u as a,z as _,w as n,h as p,i as c,b as C,q as H,g as E,B as $}from"./index-B9aHMCgn.js";import{_ as F}from"./StatusBadge-CJtaLPe6.js";const I={class:"min-h-screen bg-gray-50"},U={class:"bg-white shadow-sm border-b border-gray-200"},X={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},J={class:"flex justify-between items-center py-4"},G={class:"flex items-center space-x-4"},K={class:"text-xl font-bold text-gray-900"},Q={class:"text-sm text-gray-500"},Y={class:"flex items-center space-x-3"},Z={key:0,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},W={key:1,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},tt={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},et={class:"lg:col-span-2 space-y-6"},st={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},at={class:"grid grid-cols-2 gap-4"},ot={class:"mt-1 text-sm text-gray-900"},lt={class:"mt-1 text-sm text-gray-900"},nt={class:"mt-1"},it={class:"mt-1 text-sm text-gray-900"},rt={class:"mt-6 pt-6 border-t border-gray-200"},dt={class:"mt-1 text-sm text-gray-900"},ut={class:"mt-4"},mt=["innerHTML"],pt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ct={class:"grid grid-cols-2 gap-4"},gt={class:"mt-1 text-sm text-gray-900"},xt={class:"mt-1 text-sm text-gray-900"},ft={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},yt={class:"grid grid-cols-2 gap-4"},bt={class:"mt-1 text-sm text-gray-900"},vt={class:"mt-1 text-sm text-gray-900"},ht={class:"mt-1 text-sm text-gray-900"},wt={class:"mt-1 text-sm text-gray-900"},_t={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},kt={class:"flex justify-between items-center mb-4"},Ct={class:"space-y-3"},Mt={class:"flex justify-between items-center py-2 border-b border-gray-100"},At={class:"text-sm font-semibold text-gray-900"},jt={class:"flex justify-between items-center py-2 border-b border-gray-100"},Dt={class:"text-sm font-semibold text-green-600"},Ft={class:"flex justify-between items-center py-2"},Nt={class:"text-sm font-bold text-orange-600"},Pt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},St={class:"flex justify-between items-center mb-4"},qt={key:0,class:"text-center py-8"},Bt={class:"space-y-6"},Tt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Vt={key:0,class:"mb-6 p-4 bg-blue-50 rounded-lg"},zt={class:"flex items-center justify-between mb-2"},Rt={class:"text-xs text-blue-700"},Lt={class:"w-full bg-blue-200 rounded-full h-2"},Ot={class:"mt-2 text-xs text-blue-700"},Ht={class:"space-y-4"},Et={class:"flex items-start space-x-3"},$t={class:"flex-1"},It={class:"text-xs text-gray-500"},Ut={key:0,class:"flex items-start space-x-3"},Xt={class:"flex-1"},Jt={class:"text-xs text-gray-500"},Gt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Kt={class:"space-y-3"},Wt={__name:"RequestDetail",setup(j){const M=R(),u=L(),k=w(null),g=w(!1),y=w(!1),b=w(!1),m=w(!1),s=O({url:"frappe.client.get",params:{doctype:"Request",name:M.params.id},auto:!0}),v=()=>{u.push({name:"Dashboard"})},A=l=>l?new Date(l).toLocaleDateString("en-NZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",N=()=>{k.value.click()},P=l=>h(this,null,function*(){const e=Array.from(l.target.files);if(e.length!==0){g.value=!0;try{for(const x of e){const d=new FormData;d.append("file",x),d.append("doctype","Request"),d.append("docname",s.data.name),d.append("is_private",0),yield fetch("/api/method/upload_file",{method:"POST",headers:{"X-Frappe-CSRF-Token":window.csrf_token},body:d})}alert(`${e.length} document(s) uploaded successfully!`),s.reload(),l.target.value=""}catch(x){console.error("Error uploading file:",x),alert("Failed to upload document. Please try again.")}finally{g.value=!1}}}),S=()=>{alert(`Send Message feature - Coming soon!

For now, please contact us at:
consents@council.govt.nz
0800 LODGEICK`)},q=()=>{window.print()},B=()=>h(this,null,function*(){if(confirm("Are you sure you want to delete this draft application? This action cannot be undone.")){b.value=!0;try{yield fetch("/api/method/frappe.client.delete",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":window.csrf_token},body:JSON.stringify({doctype:"Request",name:s.data.name})}),alert("Draft deleted successfully"),u.push({name:"Dashboard"})}catch(l){console.error("Error deleting draft:",l),alert("Failed to delete draft. Please try again.")}finally{b.value=!1}}}),T=()=>h(this,null,function*(){if(confirm("Are you sure you want to submit this application? Once submitted, it cannot be edited.")){y.value=!0;try{const e=yield(yield fetch("/api/method/lodgeick.lodgeick.doctype.request.request.submit_application",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":window.csrf_token},body:JSON.stringify({request_id:s.data.name})})).json();if(e.message&&e.message.success)alert(`Application submitted successfully! Request Number: ${e.message.request_number}`),s.reload();else throw new Error("Failed to submit application")}catch(l){console.error("Error submitting application:",l),alert("Failed to submit application. Please try again.")}finally{y.value=!1}}}),V=()=>{alert(`Payment feature - Coming soon!

You will receive an invoice via email.`)},z=()=>h(this,null,function*(){m.value=!0;try{const e=yield(yield fetch("/api/method/lodgeick.api.book_council_meeting",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":window.csrf_token},body:JSON.stringify({request_id:s.data.name,meeting_type:"Pre-Application Meeting"})})).json();if(e.message&&e.message.success)alert(`Pre-Application Meeting request has been submitted! A council officer will contact you within 2 business days to schedule the meeting. Task ID: ${e.message.task_id}`);else throw new Error(e.message||"Failed to book meeting")}catch(l){console.error("Error booking meeting:",l),alert("Failed to book pre-application meeting. Please try again.")}finally{m.value=!1}});return(l,e)=>{var x,d,D;return i(),f("div",I,[t("header",U,[t("div",X,[t("div",J,[t("div",G,[t("button",{onClick:v,class:"text-gray-600 hover:text-gray-900"},[...e[0]||(e[0]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),t("div",null,[t("h1",K,o(((x=a(s).data)==null?void 0:x.request_number)||"Loading..."),1),t("p",Q,o((d=a(s).data)==null?void 0:d.request_type),1)])]),t("div",Y,[a(s).data?(i(),_(F,{key:0,status:a(s).data.status},null,8,["status"])):r("",!0),((D=a(s).data)==null?void 0:D.status)==="Draft"?(i(),_(a(c),{key:1,onClick:T,variant:"solid",theme:"blue",loading:y.value},{default:n(()=>[...e[1]||(e[1]=[p(" Submit Application ",-1)])]),_:1},8,["loading"])):r("",!0)])])])]),t("input",{ref_key:"fileInput",ref:k,type:"file",multiple:"",class:"hidden",onChange:P},null,544),a(s).loading?(i(),f("div",Z,[...e[2]||(e[2]=[t("div",{class:"text-center"},[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),t("p",{class:"mt-4 text-gray-500"},"Loading request details...")],-1)])])):a(s).data?(i(),f("div",W,[t("div",tt,[t("div",et,[t("div",st,[e[9]||(e[9]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Application Overview",-1)),t("div",at,[t("div",null,[e[3]||(e[3]=t("label",{class:"text-sm font-medium text-gray-500"},"Request Number",-1)),t("p",ot,o(a(s).data.request_number),1)]),t("div",null,[e[4]||(e[4]=t("label",{class:"text-sm font-medium text-gray-500"},"Type",-1)),t("p",lt,o(a(s).data.request_type),1)]),t("div",null,[e[5]||(e[5]=t("label",{class:"text-sm font-medium text-gray-500"},"Status",-1)),t("div",nt,[C(F,{status:a(s).data.status},null,8,["status"])])]),t("div",null,[e[6]||(e[6]=t("label",{class:"text-sm font-medium text-gray-500"},"Submitted Date",-1)),t("p",it,o(A(a(s).data.creation)),1)])]),t("div",rt,[e[7]||(e[7]=t("label",{class:"text-sm font-medium text-gray-500"},"Brief Description",-1)),t("p",dt,o(a(s).data.brief_description||"N/A"),1)]),t("div",ut,[e[8]||(e[8]=t("label",{class:"text-sm font-medium text-gray-500"},"Detailed Description",-1)),t("div",{class:"mt-1 text-sm text-gray-900 prose prose-sm max-w-none",innerHTML:a(s).data.detailed_description||"N/A"},null,8,mt)])]),t("div",pt,[e[12]||(e[12]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Property Information",-1)),t("div",ct,[t("div",null,[e[10]||(e[10]=t("label",{class:"text-sm font-medium text-gray-500"},"Property ID",-1)),t("p",gt,o(a(s).data.property||"N/A"),1)]),t("div",null,[e[11]||(e[11]=t("label",{class:"text-sm font-medium text-gray-500"},"Address",-1)),t("p",xt,o(a(s).data.property_address||"N/A"),1)])])]),t("div",ft,[e[17]||(e[17]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Applicant Information",-1)),t("div",yt,[t("div",null,[e[13]||(e[13]=t("label",{class:"text-sm font-medium text-gray-500"},"Name",-1)),t("p",bt,o(a(s).data.applicant_name||"N/A"),1)]),t("div",null,[e[14]||(e[14]=t("label",{class:"text-sm font-medium text-gray-500"},"Email",-1)),t("p",vt,o(a(s).data.applicant_email||"N/A"),1)]),t("div",null,[e[15]||(e[15]=t("label",{class:"text-sm font-medium text-gray-500"},"Phone",-1)),t("p",ht,o(a(s).data.applicant_phone||"N/A"),1)]),t("div",null,[e[16]||(e[16]=t("label",{class:"text-sm font-medium text-gray-500"},"Address",-1)),t("p",wt,o(a(s).data.applicant_address||"N/A"),1)])])]),t("div",_t,[t("div",kt,[e[18]||(e[18]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Fees & Payments",-1)),t("span",{class:H(["text-sm font-medium",a(s).data.payment_status==="Paid"?"text-green-600":"text-orange-600"])},o(a(s).data.payment_status||"Unpaid"),3)]),t("div",Ct,[t("div",Mt,[e[19]||(e[19]=t("span",{class:"text-sm text-gray-600"},"Total Fees",-1)),t("span",At,"$"+o((a(s).data.total_fees||0).toFixed(2)),1)]),t("div",jt,[e[20]||(e[20]=t("span",{class:"text-sm text-gray-600"},"Total Paid",-1)),t("span",Dt,"$"+o((a(s).data.total_paid||0).toFixed(2)),1)]),t("div",Ft,[e[21]||(e[21]=t("span",{class:"text-sm font-medium text-gray-900"},"Outstanding",-1)),t("span",Nt,"$"+o(((a(s).data.total_fees||0)-(a(s).data.total_paid||0)).toFixed(2)),1)])]),(a(s).data.total_fees||0)>(a(s).data.total_paid||0)?(i(),_(a(c),{key:0,onClick:V,variant:"solid",theme:"blue",class:"w-full mt-4"},{default:n(()=>[...e[22]||(e[22]=[p(" Make Payment ",-1)])]),_:1})):r("",!0)]),t("div",Pt,[t("div",St,[e[25]||(e[25]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Documents",-1)),C(a(c),{onClick:N,variant:"outline",size:"sm",loading:g.value},{prefix:n(()=>[...e[23]||(e[23]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)])]),default:n(()=>[e[24]||(e[24]=p(" Upload Document ",-1))]),_:1},8,["loading"])]),!a(s).data.attachments||a(s).data.attachments.length===0?(i(),f("div",qt,[...e[26]||(e[26]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("p",{class:"mt-2 text-sm text-gray-500"},"No documents uploaded yet",-1)])])):r("",!0)])]),t("div",Bt,[t("div",Tt,[e[32]||(e[32]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Processing Timeline",-1)),a(s).data.statutory_clock_started?(i(),f("div",Vt,[t("div",zt,[e[27]||(e[27]=t("span",{class:"text-sm font-medium text-blue-900"},"Statutory Clock",-1)),t("span",Rt,o(a(s).data.working_days_elapsed||0)+" of 20 days",1)]),t("div",Lt,[t("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:$({width:`${Math.min((a(s).data.working_days_elapsed||0)/20*100,100)}%`})},null,4)]),t("p",Ot,o(a(s).data.statutory_clock_stopped?"Clock stopped (RFI issued)":`${20-(a(s).data.working_days_elapsed||0)} days remaining`),1)])):r("",!0),t("div",Ht,[t("div",Et,[e[29]||(e[29]=t("div",{class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},[t("svg",{class:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"})])],-1)),t("div",$t,[e[28]||(e[28]=t("p",{class:"text-sm font-medium text-gray-900"},"Application Created",-1)),t("p",It,o(A(a(s).data.creation)),1)])]),a(s).data.modified!==a(s).data.creation?(i(),f("div",Ut,[e[31]||(e[31]=t("div",{class:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center"},[t("svg",{class:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})])],-1)),t("div",Xt,[e[30]||(e[30]=t("p",{class:"text-sm font-medium text-gray-900"},"Last Updated",-1)),t("p",Jt,o(A(a(s).data.modified)),1)])])):r("",!0)])]),t("div",Gt,[e[41]||(e[41]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions",-1)),t("div",Kt,[C(a(c),{onClick:S,variant:"outline",class:"w-full justify-start"},{prefix:n(()=>[...e[33]||(e[33]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})],-1)])]),default:n(()=>[e[34]||(e[34]=p(" Send Message ",-1))]),_:1}),C(a(c),{onClick:q,variant:"outline",class:"w-full justify-start"},{prefix:n(()=>[...e[35]||(e[35]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1)])]),default:n(()=>[e[36]||(e[36]=p(" Print Application ",-1))]),_:1}),a(s).data.status==="Draft"?(i(),_(a(c),{key:0,onClick:B,variant:"outline",class:"w-full justify-start text-red-600 hover:text-red-700",loading:b.value},{prefix:n(()=>[...e[37]||(e[37]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])]),default:n(()=>[e[38]||(e[38]=p(" Delete Draft ",-1))]),_:1},8,["loading"])):r("",!0),a(s).data.request_category==="Resource Consent"?(i(),_(a(c),{key:1,onClick:z,variant:"outline",class:"w-full justify-start text-green-600 hover:text-green-700",loading:m.value},{prefix:n(()=>[...e[39]||(e[39]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])]),default:n(()=>[e[40]||(e[40]=p(" Book Pre-Application Meeting ",-1))]),_:1},8,["loading"])):r("",!0)])]),e[42]||(e[42]=E('<div class="bg-blue-50 rounded-lg border border-blue-200 p-6"><h3 class="text-sm font-semibold text-blue-900 mb-3">Need Help?</h3><p class="text-xs text-blue-800 mb-4">Contact our planning team for assistance with your application.</p><div class="space-y-2 text-xs text-blue-900"><div class="flex items-center space-x-2"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg><span>consents@council.govt.nz</span></div><div class="flex items-center space-x-2"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg><span>0800 LODGEICK</span></div></div></div>',1))])])])):r("",!0)])}}};export{Wt as default};
//# sourceMappingURL=RequestDetail-jMEp-c2h.js.map
