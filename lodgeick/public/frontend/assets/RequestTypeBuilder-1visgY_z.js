var X=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var N=(l,s,e)=>s in l?X(l,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[s]=e,f=(l,s)=>{for(var e in s||(s={}))I.call(s,e)&&N(l,e,s[e]);if(R)for(var e of R(s))ee.call(s,e)&&N(l,e,s[e]);return l},v=(l,s)=>Y(l,Z(s));var S=(l,s,e)=>new Promise((o,m)=>{var y=g=>{try{$(e.next(g))}catch(k){m(k)}},x=g=>{try{$(e.throw(g))}catch(k){m(k)}},$=g=>g.done?o(g.value):Promise.resolve(g.value).then(y,x);$((e=e.apply(l,s)).next())});import{a as _}from"./frappe-ui-E4oUKPDc.js";import{a as c,o as p,b as t,aj as B,F as q,W as T,t as b,e as D,a2 as F,O as j,z as te,B as C,c as se,D as oe,R as le}from"./vue-vendor-D9RCx05D.js";import"./ui-components-88qJBhde.js";const ne={class:"lg:col-span-1"},ie={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},de={class:"space-y-4"},ae=["value"],re=["value"],ue=["value"],pe={class:"flex items-center gap-4"},ce={class:"flex items-center"},me=["checked"],ge={class:"flex items-center"},ye=["checked"],fe={class:"mt-6 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ve={key:0,class:"text-center py-4 text-gray-500"},be={key:1,class:"text-center py-4 text-gray-500"},xe={key:2,class:"space-y-2"},$e=["onClick"],he={class:"font-medium text-gray-900"},we={class:"text-xs text-gray-500 mt-1"},ke={class:"mt-6 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Se={key:0,class:"mt-4"},_e=["value"],Ce={__name:"BuilderSidebar",props:{requestType:{type:Object,required:!0},availableTemplates:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},showJsonPreview:{type:Boolean,default:!1},jsonPreview:{type:String,default:""}},emits:["update-name","update-category","update-description","update-collects-payment","update-make-payment","apply-template","toggle-json-preview","copy-json"],setup(l){return(s,e)=>(p(),c("div",ne,[t("div",ie,[e[13]||(e[13]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Basic Information",-1)),t("div",de,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Request Type Name",-1)),t("input",{value:l.requestType.name,onInput:e[0]||(e[0]=o=>s.$emit("update-name",o.target.value)),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Building Consent"},null,40,ae)]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Category",-1)),t("select",{value:l.requestType.category,onChange:e[1]||(e[1]=o=>s.$emit("update-category",o.target.value)),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...e[8]||(e[8]=[B('<option value="">Select Category</option><option value="Planning">Planning</option><option value="Building">Building</option><option value="Social Assistance">Social Assistance</option><option value="Environmental">Environmental</option><option value="Other">Other</option>',6)])],40,re)]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),t("textarea",{value:l.requestType.description,onInput:e[2]||(e[2]=o=>s.$emit("update-description",o.target.value)),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe this request type..."},null,40,ue)]),t("div",pe,[t("label",ce,[t("input",{checked:l.requestType.collects_payment,onChange:e[3]||(e[3]=o=>s.$emit("update-collects-payment",o.target.checked)),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,40,me),e[11]||(e[11]=t("span",{class:"ml-2 text-sm text-gray-700"},"Collects Payment",-1))]),t("label",ge,[t("input",{checked:l.requestType.make_payment,onChange:e[4]||(e[4]=o=>s.$emit("update-make-payment",o.target.checked)),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,40,ye),e[12]||(e[12]=t("span",{class:"ml-2 text-sm text-gray-700"},"Makes Payment",-1))])])])]),t("div",fe,[e[14]||(e[14]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Template Library",-1)),l.loading?(p(),c("div",ve,"Loading templates...")):l.availableTemplates.length===0?(p(),c("div",be,"No templates available")):(p(),c("div",xe,[(p(!0),c(q,null,T(l.availableTemplates,o=>(p(),c("button",{key:o.name,onClick:m=>s.$emit("apply-template",o.name),class:"w-full text-left px-4 py-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors"},[t("div",he,b(o.title),1),t("div",we,b(o.description),1)],8,$e))),128))]))]),t("div",ke,[e[15]||(e[15]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"JSON Export",-1)),t("button",{onClick:e[5]||(e[5]=o=>s.$emit("toggle-json-preview")),class:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200"},b(l.showJsonPreview?"Hide":"Show")+" JSON Preview ",1),l.showJsonPreview?(p(),c("div",Se,[t("textarea",{value:l.jsonPreview,readonly:"",rows:"12",class:"w-full px-3 py-2 border border-gray-300 rounded-lg font-mono text-xs bg-gray-50"},null,8,_e),t("button",{onClick:e[6]||(e[6]=o=>s.$emit("copy-json")),class:"mt-2 w-full px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700"}," Copy to Clipboard ")])):D("",!0)])]))}},qe={class:"bg-white p-2 rounded border border-gray-200"},Te={class:"grid grid-cols-3 gap-2"},Fe={class:"col-span-2"},De=["value"],je=["value"],Ae={class:"grid grid-cols-3 gap-2 mt-2"},Re={class:"col-span-2"},Ne=["value"],Be={class:"flex items-center gap-2"},Ue={class:"flex items-center text-xs"},Pe=["checked"],Oe={key:0,class:"mt-2"},Je=["value"],Ee={class:"mt-2"},Me=["value"],Ve={__name:"FieldCard",props:{field:{type:Object,required:!0}},emits:["update:field","delete"],setup(l){return(s,e)=>(p(),c("div",qe,[t("div",Te,[t("div",Fe,[t("input",{value:l.field.field_label,onInput:e[0]||(e[0]=o=>s.$emit("update:field",v(f({},l.field),{field_label:o.target.value}))),type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"Field Label"},null,40,De)]),t("div",null,[t("select",{value:l.field.field_type,onChange:e[1]||(e[1]=o=>s.$emit("update:field",v(f({},l.field),{field_type:o.target.value}))),class:"w-full px-2 py-1 border border-gray-300 rounded text-xs"},[...e[7]||(e[7]=[B('<option value="Data">Text</option><option value="Text">Textarea</option><option value="Select">Select</option><option value="Date">Date</option><option value="Check">Checkbox</option><option value="Currency">Currency</option><option value="Int">Integer</option><option value="Float">Float</option>',8)])],40,je)])]),t("div",Ae,[t("div",Re,[t("input",{value:l.field.field_name,onInput:e[2]||(e[2]=o=>s.$emit("update:field",v(f({},l.field),{field_name:o.target.value}))),type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"field_name"},null,40,Ne)]),t("div",Be,[t("label",Ue,[t("input",{checked:l.field.is_required,onChange:e[3]||(e[3]=o=>s.$emit("update:field",v(f({},l.field),{is_required:o.target.checked}))),type:"checkbox",class:"mr-1 text-xs"},null,40,Pe),e[8]||(e[8]=F(" Required ",-1))]),t("button",{onClick:e[4]||(e[4]=o=>s.$emit("delete")),class:"text-xs text-red-600 hover:text-red-700 ml-auto"}," âœ• ")])]),l.field.field_type==="Select"?(p(),c("div",Oe,[t("textarea",{value:l.field.options,onInput:e[5]||(e[5]=o=>s.$emit("update:field",v(f({},l.field),{options:o.target.value}))),rows:"2",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"Options (one per line)"},null,40,Je)])):D("",!0),t("div",Ee,[t("input",{value:l.field.validation,onInput:e[6]||(e[6]=o=>s.$emit("update:field",v(f({},l.field),{validation:o.target.value}))),type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"Validation: email, phone, eval:value >= 18"},null,40,Me)])]))}},Le={class:"bg-gray-50 p-3 rounded border border-gray-200"},ze={class:"flex items-center justify-between mb-2"},He=["value"],We={class:"grid grid-cols-2 gap-2 mb-2"},Ge=["value"],Ke=["value"],Qe={class:"mt-3"},Xe={class:"flex items-center justify-between mb-2"},Ye={key:0,class:"text-xs text-gray-400 text-center py-2"},Ze={key:1,class:"space-y-2"},Ie={__name:"SectionCard",props:{section:{type:Object,required:!0}},emits:["update:section","delete","add-field","update-field","delete-field"],setup(l){return(s,e)=>(p(),c("div",Le,[t("div",ze,[t("input",{value:l.section.section_title,onInput:e[0]||(e[0]=o=>s.$emit("update:section",v(f({},l.section),{section_title:o.target.value}))),type:"text",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm mr-2",placeholder:"Section Title"},null,40,He),t("button",{onClick:e[1]||(e[1]=o=>s.$emit("delete")),class:"text-xs text-red-600 hover:text-red-700"}," Delete ")]),t("div",We,[t("div",null,[e[5]||(e[5]=t("label",{class:"block text-xs text-gray-600 mb-1"},"Section Code",-1)),t("input",{value:l.section.section_code,onInput:e[2]||(e[2]=o=>s.$emit("update:section",v(f({},l.section),{section_code:o.target.value}))),type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"e.g., personal_info"},null,40,Ge)]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-xs text-gray-600 mb-1"},"Section Type",-1)),t("select",{value:l.section.section_type,onChange:e[3]||(e[3]=o=>s.$emit("update:section",v(f({},l.section),{section_type:o.target.value}))),class:"w-full px-2 py-1 border border-gray-300 rounded text-xs"},[...e[6]||(e[6]=[t("option",{value:"Standard"},"Standard",-1),t("option",{value:"Tab"},"Tab",-1),t("option",{value:"Accordion"},"Accordion",-1)])],40,Ke)])]),t("div",Qe,[t("div",Xe,[e[8]||(e[8]=t("span",{class:"text-xs font-medium text-gray-700"},"Fields",-1)),t("button",{onClick:e[4]||(e[4]=o=>s.$emit("add-field")),class:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200"}," + Add Field ")]),!l.section.fields||l.section.fields.length===0?(p(),c("div",Ye," No fields yet ")):(p(),c("div",Ze,[(p(!0),c(q,null,T(l.section.fields,(o,m)=>(p(),j(Ve,{key:m,field:o,"onUpdate:field":y=>s.$emit("update-field",m,y),onDelete:y=>s.$emit("delete-field",m)},null,8,["field","onUpdate:field","onDelete"]))),128))]))])]))}},et={class:"border border-gray-200 rounded-lg overflow-hidden"},tt={class:"bg-gray-50 px-4 py-3 flex items-center justify-between border-b border-gray-200"},st={class:"flex items-center gap-3"},ot={class:"flex items-center gap-2"},lt=["disabled"],nt=["disabled"],it={class:"text-sm font-medium text-gray-900"},dt=["value"],at={class:"flex items-center gap-2"},rt={key:0,class:"p-4"},ut={class:"grid grid-cols-2 gap-4 mb-4"},pt=["value"],ct=["value"],mt={class:"flex gap-4 mb-4"},gt={class:"flex items-center text-sm"},yt=["checked"],ft={class:"flex items-center text-sm"},vt=["checked"],bt={class:"mt-4"},xt={class:"flex items-center justify-between mb-2"},$t={key:0,class:"text-xs text-gray-500 text-center py-4"},ht={key:1,class:"space-y-3"},wt={__name:"StepCard",props:{step:{type:Object,required:!0},stepNumber:{type:Number,required:!0},isFirst:{type:Boolean,default:!1},isLast:{type:Boolean,default:!1}},emits:["update:step","delete","move","toggle","add-section","update-section","delete-section","add-field","update-field","delete-field"],setup(l){return(s,e)=>(p(),c("div",et,[t("div",tt,[t("div",st,[t("div",ot,[t("button",{onClick:e[0]||(e[0]=o=>s.$emit("move","up")),disabled:l.isFirst,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed"},[...e[10]||(e[10]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 15l7-7 7 7"})],-1)])],8,lt),t("button",{onClick:e[1]||(e[1]=o=>s.$emit("move","down")),disabled:l.isLast,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed"},[...e[11]||(e[11]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])],8,nt)]),t("span",it,"Step "+b(l.stepNumber),1),t("input",{value:l.step.step_title,onInput:e[2]||(e[2]=o=>s.$emit("update:step",v(f({},l.step),{step_title:o.target.value}))),type:"text",class:"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Step Title"},null,40,dt)]),t("div",at,[t("button",{onClick:e[3]||(e[3]=o=>s.$emit("toggle")),class:"text-sm text-gray-600 hover:text-gray-900"},b(l.step.expanded?"Collapse":"Expand"),1),t("button",{onClick:e[4]||(e[4]=o=>s.$emit("delete")),class:"text-sm text-red-600 hover:text-red-700"}," Delete ")])]),l.step.expanded?(p(),c("div",rt,[t("div",ut,[t("div",null,[e[12]||(e[12]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Step Code",-1)),t("input",{value:l.step.step_code,onInput:e[5]||(e[5]=o=>s.$emit("update:step",v(f({},l.step),{step_code:o.target.value}))),type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-sm",placeholder:"e.g., applicant_details"},null,40,pt)]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Component",-1)),t("select",{value:l.step.step_component,onChange:e[6]||(e[6]=o=>s.$emit("update:step",v(f({},l.step),{step_component:o.target.value}))),class:"w-full px-2 py-1 border border-gray-300 rounded text-sm"},[...e[13]||(e[13]=[t("option",{value:"DynamicStepRenderer"},"Dynamic Step Renderer",-1),t("option",{value:"Custom"},"Custom Component",-1)])],40,ct)])]),t("div",mt,[t("label",gt,[t("input",{checked:l.step.is_required,onChange:e[7]||(e[7]=o=>s.$emit("update:step",v(f({},l.step),{is_required:o.target.checked}))),type:"checkbox",class:"mr-2"},null,40,yt),e[15]||(e[15]=F(" Required ",-1))]),t("label",ft,[t("input",{checked:l.step.show_on_review,onChange:e[8]||(e[8]=o=>s.$emit("update:step",v(f({},l.step),{show_on_review:o.target.checked}))),type:"checkbox",class:"mr-2"},null,40,vt),e[16]||(e[16]=F(" Show on Review ",-1))])]),t("div",bt,[t("div",xt,[e[17]||(e[17]=t("h4",{class:"text-sm font-medium text-gray-700"},"Sections",-1)),t("button",{onClick:e[9]||(e[9]=o=>s.$emit("add-section")),class:"text-xs px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200"}," + Add Section ")]),!l.step.sections||l.step.sections.length===0?(p(),c("div",$t," No sections yet ")):(p(),c("div",ht,[(p(!0),c(q,null,T(l.step.sections,(o,m)=>(p(),j(Ie,{key:m,section:o,"onUpdate:section":y=>s.$emit("update-section",m,y),onDelete:y=>s.$emit("delete-section",m),onAddField:y=>s.$emit("add-field",m),onUpdateField:(y,x)=>s.$emit("update-field",m,y,x),onDeleteField:y=>s.$emit("delete-field",m,y)},null,8,["section","onUpdate:section","onDelete","onAddField","onUpdateField","onDeleteField"]))),128))]))])])):D("",!0)]))}},kt={class:"min-h-screen bg-gray-50"},St={class:"bg-white shadow-sm border-b border-gray-200"},_t={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},Ct={class:"flex items-center justify-between"},qt={class:"flex gap-3"},Tt=["disabled"],Ft=["disabled"],Dt={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},jt={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},At={class:"lg:col-span-2"},Rt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Nt={key:0,class:"text-center py-12 text-gray-500"},Bt={key:1,class:"space-y-4"},Et={__name:"RequestTypeBuilder",setup(l){const s=te({name:"",category:"",description:"",collects_payment:!1,make_payment:!1,steps:[]}),e=C([]),o=C(!1),m=C(!1),y=C(!1),x=se(()=>JSON.stringify(s,null,2));function $(){s.steps.forEach((d,n)=>{d.step_number=n+1})}function g(){return Date.now().toString(36)+Math.random().toString(36).substr(2,5)}function k(){s.steps.push({id:g(),step_number:s.steps.length+1,step_code:`step_${s.steps.length+1}`,step_title:`Step ${s.steps.length+1}`,step_component:"DynamicStepRenderer",is_required:!0,show_on_review:!0,expanded:!0,sections:[]})}function U(d){confirm("Are you sure you want to delete this step?")&&(s.steps.splice(d,1),$())}function P(d,n){const a=n==="up"?d-1:d+1;if(a>=0&&a<s.steps.length){const r=s.steps[d];s.steps[d]=s.steps[a],s.steps[a]=r,$()}}function O(d){const n=s.steps[d];n.expanded=n.expanded===void 0?!1:!n.expanded}function J(d){s.steps[d].sections||(s.steps[d].sections=[]),s.steps[d].sections.push({id:g(),section_code:`section_${s.steps[d].sections.length+1}`,section_title:"",section_type:"Standard",sequence:s.steps[d].sections.length+1,is_enabled:!0,is_required:!0,show_on_review:!0,fields:[]})}function E(d,n){s.steps[d].sections.splice(n,1)}function M(d,n){s.steps[d].sections[n].fields||(s.steps[d].sections[n].fields=[]),s.steps[d].sections[n].fields.push({id:g(),field_name:"",field_label:"",field_type:"Data",is_required:!1,show_on_review:!0,options:"",validation:""})}function V(d,n,a){s.steps[d].sections[n].fields.splice(a,1)}function L(){return S(this,null,function*(){try{o.value=!0;const d=yield _("lodgeick.api.get_step_templates");e.value=d||[]}catch(d){console.error("Failed to load templates:",d),alert("Failed to load templates from backend")}finally{o.value=!1}})}function z(d){return S(this,null,function*(){var n,a,r;try{o.value=!0;const i=yield _("lodgeick.api.load_step_template",{template_name:d});if(!i||!i.success||!i.template){alert(`Failed to load template: ${(i==null?void 0:i.error)||"Unknown error"}`);return}const u=i.template,h={id:g(),step_number:s.steps.length+1,step_code:u.step_config.step_code,step_title:u.step_config.step_title,step_component:u.step_config.step_component,is_enabled:(n=u.step_config.is_enabled)!=null?n:!0,is_required:(a=u.step_config.is_required)!=null?a:!0,show_on_review:(r=u.step_config.show_on_review)!=null?r:!0,description:u.step_config.description||"",expanded:!0,sections:[]};if(u.sections&&Array.isArray(u.sections))for(const w of u.sections){const A={id:g(),section_code:w.section_code,section_title:w.section_title,section_type:w.section_type,fields:[]};if(w.fields&&Array.isArray(w.fields))for(const Q of w.fields)A.fields.push({id:g(),field_name:Q.field_name});h.sections.push(A)}s.steps.push(h),alert(`Template "${u.template_title}" applied successfully!`)}catch(i){console.error("Failed to apply template:",i),alert("Failed to apply template")}finally{o.value=!1}})}function H(){const d=prompt("Enter Request Type name to load:");d&&W(d)}function W(d){return S(this,null,function*(){try{o.value=!0;const n=yield _("lodgeick.api.load_request_type_config",{request_type_name:d});if(!n.success){alert(`Failed to load Request Type: ${n.error}`);return}const a=n.config;s.name=a.name,s.category=a.category,s.description=a.description,s.collects_payment=a.collects_payment,s.make_payment=a.make_payment,s.steps=(a.steps||[]).map(r=>(r.expanded=!0,r.id=r.id||g(),r.sections=(r.sections||[]).map(i=>(i.id=i.id||g(),i.fields=(i.fields||[]).map(u=>(u.id=u.id||g(),u)),i)),r)),alert(`Request Type "${d}" loaded successfully!`)}catch(n){console.error("Failed to load Request Type:",n),alert("Failed to load Request Type")}finally{o.value=!1}})}function G(){return S(this,null,function*(){const d=new Set,n=new Set;for(const a of s.steps){if(d.has(a.step_code)){alert(`Error: Duplicate Step Code found: ${a.step_code}`);return}if(d.add(a.step_code),!a.step_code||!a.step_title){alert("All steps must have a step code and title");return}for(const r of a.sections){if(!r.section_code||!r.section_title){alert("All sections must have a code and title");return}for(const i of r.fields){if(!i.field_name||!i.field_label||!i.field_type){alert("All fields must have a name, label, and type");return}if(n.has(i.field_name)){alert(`Error: Duplicate Field Name found: ${i.field_name}. Field names must be unique across the entire Request Type.`);return}n.add(i.field_name)}}}try{m.value=!0;const a=JSON.parse(JSON.stringify(s));a.steps.forEach(i=>{delete i.id,delete i.expanded,i.sections&&i.sections.forEach(u=>{delete u.id,u.fields&&u.fields.forEach(h=>{delete h.id})})});const r=yield _("lodgeick.api.save_request_type_config",{config:a});if(!r.success){alert(`Failed to save: ${r.error}`);return}alert(r.message)}catch(a){console.error("Failed to save Request Type:",a),alert("Failed to save Request Type")}finally{m.value=!1}})}function K(){navigator.clipboard.writeText(x.value).then(()=>{alert("JSON copied to clipboard!")}).catch(d=>{console.error("Failed to copy:",d),alert("Failed to copy to clipboard")})}return oe(()=>{L()}),(d,n)=>(p(),c("div",kt,[t("div",St,[t("div",_t,[t("div",Ct,[n[6]||(n[6]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"Request Type Builder"),t("p",{class:"mt-1 text-sm text-gray-500"},"Visual configuration editor for Request Types")],-1)),t("div",qt,[t("button",{onClick:H,disabled:o.value,class:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},b(o.value?"Loading...":"Load Request Type"),9,Tt),t("button",{onClick:G,disabled:m.value||o.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},b(m.value?"Saving...":"Save Request Type"),9,Ft)])])])]),t("div",Dt,[t("div",jt,[le(Ce,{"request-type":s,"available-templates":e.value,loading:o.value,"show-json-preview":y.value,"json-preview":x.value,onUpdateName:n[0]||(n[0]=a=>s.name=a),onUpdateCategory:n[1]||(n[1]=a=>s.category=a),onUpdateDescription:n[2]||(n[2]=a=>s.description=a),onUpdateCollectsPayment:n[3]||(n[3]=a=>s.collects_payment=a),onUpdateMakePayment:n[4]||(n[4]=a=>s.make_payment=a),onApplyTemplate:z,onToggleJsonPreview:n[5]||(n[5]=a=>y.value=!y.value),onCopyJson:K},null,8,["request-type","available-templates","loading","show-json-preview","json-preview"]),t("div",At,[t("div",Rt,[t("div",{class:"flex items-center justify-between mb-6"},[n[7]||(n[7]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Steps Configuration",-1)),t("button",{onClick:k,class:"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700"}," + Add Step ")]),s.steps.length===0?(p(),c("div",Nt,[...n[8]||(n[8]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),t("p",{class:"mt-2 text-sm"},"No steps configured yet",-1),t("p",{class:"text-xs text-gray-400 mt-1"},'Click "Add Step" or use a template to get started',-1)])])):(p(),c("div",Bt,[(p(!0),c(q,null,T(s.steps,(a,r)=>(p(),j(wt,{key:a.id||r,step:a,"step-number":r+1,"is-first":r===0,"is-last":r===s.steps.length-1,"onUpdate:step":i=>s.steps[r]=i,onDelete:i=>U(r),onMove:i=>P(r,i),onToggle:i=>O(r),onAddSection:i=>J(r),onUpdateSection:(i,u)=>s.steps[r].sections[i]=u,onDeleteSection:i=>E(r,i),onAddField:i=>M(r,i),onUpdateField:(i,u,h)=>s.steps[r].sections[i].fields[u]=h,onDeleteField:(i,u)=>V(r,i,u)},null,8,["step","step-number","is-first","is-last","onUpdate:step","onDelete","onMove","onToggle","onAddSection","onUpdateSection","onDeleteSection","onAddField","onUpdateField","onDeleteField"]))),128))]))])])])])]))}};export{Et as default};
//# sourceMappingURL=RequestTypeBuilder-1visgY_z.js.map
