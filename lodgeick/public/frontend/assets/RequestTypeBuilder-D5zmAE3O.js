var w=($,s,b)=>new Promise((c,g)=>{var x=_=>{try{f(b.next(_))}catch(h){g(h)}},C=_=>{try{f(b.throw(_))}catch(h){g(h)}},f=_=>_.done?c(_.value):Promise.resolve(_.value).then(x,C);f((b=b.apply($,s)).next())});import{e as G,ad as K,r as S,j as Q,q as W,c as d,o as i,a as e,t as v,k as r,a4 as m,v as q,g as N,a3 as k,F as V,l as T,d as R,h as F,ab as U}from"./index-hP4TEbGj.js";const X={class:"min-h-screen bg-gray-50"},Y={class:"bg-white shadow-sm border-b border-gray-200"},Z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},I={class:"flex items-center justify-between"},ee={class:"flex gap-3"},te=["disabled"],oe=["disabled"],se={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},le={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ne={class:"lg:col-span-1"},ae={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},de={class:"space-y-4"},ie={class:"flex items-center gap-4"},re={class:"flex items-center"},pe={class:"flex items-center"},ce={class:"mt-6 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ue={key:0,class:"text-center py-4 text-gray-500"},me={key:1,class:"text-center py-4 text-gray-500"},_e={key:2,class:"space-y-2"},ye=["onClick"],be={class:"font-medium text-gray-900"},ge={class:"text-xs text-gray-500 mt-1"},ve={class:"mt-6 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},xe={key:0,class:"mt-4"},fe=["value"],he={class:"lg:col-span-2"},we={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ke={key:0,class:"text-center py-12 text-gray-500"},Ce={key:1,class:"space-y-4"},Se={class:"bg-gray-50 px-4 py-3 flex items-center justify-between border-b border-gray-200"},qe={class:"flex items-center gap-3"},Ve={class:"flex items-center gap-2"},Te=["onClick","disabled"],Ue=["onClick","disabled"],Re={class:"text-sm font-medium text-gray-900"},Fe=["onUpdate:modelValue"],$e={class:"flex items-center gap-2"},De=["onClick"],Be=["onClick"],Ne={key:0,class:"p-4"},Ae={class:"grid grid-cols-2 gap-4 mb-4"},je=["onUpdate:modelValue"],Ee=["onUpdate:modelValue"],Me={class:"flex gap-4 mb-4"},Pe={class:"flex items-center text-sm"},Oe=["onUpdate:modelValue"],Je={class:"flex items-center text-sm"},Le=["onUpdate:modelValue"],He={class:"mt-4"},ze={class:"flex items-center justify-between mb-2"},Ge=["onClick"],Ke={key:0,class:"text-xs text-gray-500 text-center py-4"},Qe={key:1,class:"space-y-3"},We={class:"flex items-center justify-between mb-2"},Xe=["onUpdate:modelValue"],Ye=["onClick"],Ze={class:"grid grid-cols-2 gap-2 mb-2"},Ie=["onUpdate:modelValue"],et=["onUpdate:modelValue"],tt={class:"mt-3"},ot={class:"flex items-center justify-between mb-2"},st=["onClick"],lt={key:0,class:"text-xs text-gray-400 text-center py-2"},nt={key:1,class:"space-y-2"},at={class:"grid grid-cols-3 gap-2"},dt={class:"col-span-2"},it=["onUpdate:modelValue"],rt=["onUpdate:modelValue"],pt={class:"grid grid-cols-3 gap-2 mt-2"},ct={class:"col-span-2"},ut=["onUpdate:modelValue"],mt={class:"flex items-center gap-2"},_t={class:"flex items-center text-xs"},yt=["onUpdate:modelValue"],bt=["onClick"],gt={key:0,class:"mt-2"},vt=["onUpdate:modelValue"],xt={class:"mt-2"},ft=["onUpdate:modelValue"],ht={__name:"RequestTypeBuilder",setup($){const s=K({name:"",category:"",description:"",collects_payment:!1,make_payment:!1,steps:[]}),b=S([]),c=S(!1),g=S(!1),x=S(!1),C=Q(()=>JSON.stringify(s,null,2));function f(){return w(this,null,function*(){try{c.value=!0;const l=yield U("lodgeick.api.get_step_templates");b.value=l||[]}catch(l){console.error("Failed to load templates:",l),alert("Failed to load templates from backend")}finally{c.value=!1}})}W(()=>{f()});function _(){s.steps.push({step_number:s.steps.length+1,step_code:`step_${s.steps.length+1}`,step_title:`Step ${s.steps.length+1}`,step_component:"DynamicStepRenderer",is_required:!0,show_on_review:!0,expanded:!0,sections:[]})}function h(l){confirm("Delete this step?")&&(s.steps.splice(l,1),s.steps.forEach((t,o)=>{t.step_number=o+1}))}function D(l,t){const o=t==="up"?l-1:l+1;if(o>=0&&o<s.steps.length){const p=s.steps[l];s.steps[l]=s.steps[o],s.steps[o]=p,s.steps.forEach((n,y)=>{n.step_number=y+1})}}function A(l){s.steps[l].expanded=!s.steps[l].expanded}function j(l){s.steps[l].sections||(s.steps[l].sections=[]),s.steps[l].sections.push({section_code:`section_${s.steps[l].sections.length+1}`,section_title:"",section_type:"Standard",sequence:s.steps[l].sections.length+1,is_enabled:!0,is_required:!0,show_on_review:!0,fields:[]})}function E(l,t){s.steps[l].sections.splice(t,1)}function M(l,t){s.steps[l].sections[t].fields||(s.steps[l].sections[t].fields=[]),s.steps[l].sections[t].fields.push({field_name:"",field_label:"",field_type:"Data",is_required:!1,show_on_review:!0,options:"",validation:""})}function P(l,t,o){s.steps[l].sections[t].fields.splice(o,1)}function O(l){return w(this,null,function*(){try{c.value=!0;const t=yield U("lodgeick.api.load_step_template",{template_name:l});if(!t.success){alert(`Failed to load template: ${t.error}`);return}const o=t.template,p={step_number:s.steps.length+1,step_code:o.step_config.step_code,step_title:o.step_config.step_title,step_component:o.step_config.step_component,is_enabled:o.step_config.is_enabled,is_required:o.step_config.is_required,show_on_review:o.step_config.show_on_review,description:o.step_config.description||"",expanded:!0,sections:[]};for(const n of o.sections){const y={section_code:n.section_code,section_title:n.section_title,section_type:n.section_type,sequence:n.sequence,is_enabled:n.is_enabled,is_required:n.is_required,show_on_review:n.show_on_review,description:n.description||"",fields:[]};for(const a of n.fields)y.fields.push({field_name:a.field_name,field_label:a.field_label,field_type:a.field_type,is_required:a.is_required,show_on_review:a.show_on_review,review_label:a.review_label||a.field_label,options:a.options||"",default_value:a.default_value||"",validation:a.validation||"",depends_on:a.depends_on||"",description:a.description||""});p.sections.push(y)}s.steps.push(p),alert(`Template "${o.template_title}" applied successfully!`)}catch(t){console.error("Failed to apply template:",t),alert("Failed to apply template")}finally{c.value=!1}})}function J(){const l=prompt("Enter Request Type name to load:");l&&L(l)}function L(l){return w(this,null,function*(){try{c.value=!0;const t=yield U("lodgeick.api.load_request_type_config",{request_type_name:l});if(!t.success){alert(`Failed to load Request Type: ${t.error}`);return}const o=t.config;s.name=o.name,s.category=o.category,s.description=o.description,s.collects_payment=o.collects_payment,s.make_payment=o.make_payment,s.steps=o.steps,alert(`Request Type "${l}" loaded successfully!`)}catch(t){console.error("Failed to load Request Type:",t),alert("Failed to load Request Type")}finally{c.value=!1}})}function H(){return w(this,null,function*(){if(!s.name){alert("Please enter a Request Type name");return}for(const l of s.steps){if(!l.step_code||!l.step_title){alert("All steps must have a step code and title");return}for(const t of l.sections){if(!t.section_code||!t.section_title){alert("All sections must have a code and title");return}for(const o of t.fields)if(!o.field_name||!o.field_label||!o.field_type){alert("All fields must have a name, label, and type");return}}}try{g.value=!0;const l=yield U("lodgeick.api.save_request_type_config",{config:s});if(!l.success){alert(`Failed to save: ${l.error}`);return}alert(l.message)}catch(l){console.error("Failed to save Request Type:",l),alert("Failed to save Request Type")}finally{g.value=!1}})}function z(){navigator.clipboard.writeText(C.value).then(()=>{alert("JSON copied to clipboard!")}).catch(l=>{console.error("Failed to copy:",l),alert("Failed to copy to clipboard")})}return(l,t)=>(i(),d("div",X,[e("div",Y,[e("div",Z,[e("div",I,[t[6]||(t[6]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Request Type Builder"),e("p",{class:"mt-1 text-sm text-gray-500"},"Visual configuration editor for Request Types")],-1)),e("div",ee,[e("button",{onClick:J,disabled:c.value,class:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},v(c.value?"Loading...":"Load Request Type"),9,te),e("button",{onClick:H,disabled:g.value||c.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},v(g.value?"Saving...":"Save Request Type"),9,oe)])])])]),e("div",se,[e("div",le,[e("div",ne,[e("div",ae,[t[13]||(t[13]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Basic Information",-1)),e("div",de,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Request Type Name",-1)),r(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.name=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Building Consent"},null,512),[[m,s.name]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Category",-1)),r(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.category=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...t[8]||(t[8]=[N('<option value="" data-v-6882d328>Select Category</option><option value="Planning" data-v-6882d328>Planning</option><option value="Building" data-v-6882d328>Building</option><option value="Social Assistance" data-v-6882d328>Social Assistance</option><option value="Environmental" data-v-6882d328>Environmental</option><option value="Other" data-v-6882d328>Other</option>',6)])],512),[[q,s.category]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),r(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.description=o),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe this request type..."},null,512),[[m,s.description]])]),e("div",ie,[e("label",re,[r(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>s.collects_payment=o),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[k,s.collects_payment]]),t[11]||(t[11]=e("span",{class:"ml-2 text-sm text-gray-700"},"Collects Payment",-1))]),e("label",pe,[r(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>s.make_payment=o),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[k,s.make_payment]]),t[12]||(t[12]=e("span",{class:"ml-2 text-sm text-gray-700"},"Makes Payment",-1))])])])]),e("div",ce,[t[14]||(t[14]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Template Library",-1)),c.value?(i(),d("div",ue,"Loading templates...")):b.value.length===0?(i(),d("div",me,"No templates available")):(i(),d("div",_e,[(i(!0),d(V,null,T(b.value,o=>(i(),d("button",{key:o.name,onClick:p=>O(o.name),class:"w-full text-left px-4 py-3 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors"},[e("div",be,v(o.title),1),e("div",ge,v(o.description),1)],8,ye))),128))]))]),e("div",ve,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"JSON Export",-1)),e("button",{onClick:t[5]||(t[5]=o=>x.value=!x.value),class:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200"},v(x.value?"Hide":"Show")+" JSON Preview ",1),x.value?(i(),d("div",xe,[e("textarea",{value:C.value,readonly:"",rows:"12",class:"w-full px-3 py-2 border border-gray-300 rounded-lg font-mono text-xs bg-gray-50"},null,8,fe),e("button",{onClick:z,class:"mt-2 w-full px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700"}," Copy to Clipboard ")])):R("",!0)])]),e("div",he,[e("div",we,[e("div",{class:"flex items-center justify-between mb-6"},[t[16]||(t[16]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Steps Configuration",-1)),e("button",{onClick:_,class:"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700"}," + Add Step ")]),s.steps.length===0?(i(),d("div",ke,[...t[17]||(t[17]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"mt-2 text-sm"},"No steps configured yet",-1),e("p",{class:"text-xs text-gray-400 mt-1"},'Click "Add Step" or use a template to get started',-1)])])):(i(),d("div",Ce,[(i(!0),d(V,null,T(s.steps,(o,p)=>(i(),d("div",{key:p,class:"border border-gray-200 rounded-lg overflow-hidden"},[e("div",Se,[e("div",qe,[e("div",Ve,[e("button",{onClick:n=>D(p,"up"),disabled:p===0,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed"},[...t[18]||(t[18]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 15l7-7 7 7"})],-1)])],8,Te),e("button",{onClick:n=>D(p,"down"),disabled:p===s.steps.length-1,class:"p-1 hover:bg-gray-200 rounded disabled:opacity-30 disabled:cursor-not-allowed"},[...t[19]||(t[19]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])],8,Ue)]),e("span",Re,"Step "+v(p+1),1),r(e("input",{"onUpdate:modelValue":n=>o.step_title=n,type:"text",class:"px-3 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Step Title"},null,8,Fe),[[m,o.step_title]])]),e("div",$e,[e("button",{onClick:n=>A(p),class:"text-sm text-gray-600 hover:text-gray-900"},v(o.expanded?"Collapse":"Expand"),9,De),e("button",{onClick:n=>h(p),class:"text-sm text-red-600 hover:text-red-700"}," Delete ",8,Be)])]),o.expanded?(i(),d("div",Ne,[e("div",Ae,[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Step Code",-1)),r(e("input",{"onUpdate:modelValue":n=>o.step_code=n,type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-sm",placeholder:"e.g., applicant_details"},null,8,je),[[m,o.step_code]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Component",-1)),r(e("select",{"onUpdate:modelValue":n=>o.step_component=n,class:"w-full px-2 py-1 border border-gray-300 rounded text-sm"},[...t[21]||(t[21]=[e("option",{value:"DynamicStepRenderer"},"Dynamic Step Renderer",-1),e("option",{value:"Custom"},"Custom Component",-1)])],8,Ee),[[q,o.step_component]])])]),e("div",Me,[e("label",Pe,[r(e("input",{"onUpdate:modelValue":n=>o.is_required=n,type:"checkbox",class:"mr-2"},null,8,Oe),[[k,o.is_required]]),t[23]||(t[23]=F(" Required ",-1))]),e("label",Je,[r(e("input",{"onUpdate:modelValue":n=>o.show_on_review=n,type:"checkbox",class:"mr-2"},null,8,Le),[[k,o.show_on_review]]),t[24]||(t[24]=F(" Show on Review ",-1))])]),e("div",He,[e("div",ze,[t[25]||(t[25]=e("h4",{class:"text-sm font-medium text-gray-700"},"Sections",-1)),e("button",{onClick:n=>j(p),class:"text-xs px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200"}," + Add Section ",8,Ge)]),!o.sections||o.sections.length===0?(i(),d("div",Ke," No sections yet ")):(i(),d("div",Qe,[(i(!0),d(V,null,T(o.sections,(n,y)=>(i(),d("div",{key:y,class:"bg-gray-50 p-3 rounded border border-gray-200"},[e("div",We,[r(e("input",{"onUpdate:modelValue":a=>n.section_title=a,type:"text",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm mr-2",placeholder:"Section Title"},null,8,Xe),[[m,n.section_title]]),e("button",{onClick:a=>E(p,y),class:"text-xs text-red-600 hover:text-red-700"}," Delete ",8,Ye)]),e("div",Ze,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-xs text-gray-600 mb-1"},"Section Code",-1)),r(e("input",{"onUpdate:modelValue":a=>n.section_code=a,type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"e.g., personal_info"},null,8,Ie),[[m,n.section_code]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-xs text-gray-600 mb-1"},"Section Type",-1)),r(e("select",{"onUpdate:modelValue":a=>n.section_type=a,class:"w-full px-2 py-1 border border-gray-300 rounded text-xs"},[...t[27]||(t[27]=[e("option",{value:"Standard"},"Standard",-1),e("option",{value:"Tab"},"Tab",-1),e("option",{value:"Accordion"},"Accordion",-1)])],8,et),[[q,n.section_type]])])]),e("div",tt,[e("div",ot,[t[29]||(t[29]=e("span",{class:"text-xs font-medium text-gray-700"},"Fields",-1)),e("button",{onClick:a=>M(p,y),class:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded hover:bg-green-200"}," + Add Field ",8,st)]),!n.fields||n.fields.length===0?(i(),d("div",lt," No fields yet ")):(i(),d("div",nt,[(i(!0),d(V,null,T(n.fields,(a,B)=>(i(),d("div",{key:B,class:"bg-white p-2 rounded border border-gray-200"},[e("div",at,[e("div",dt,[r(e("input",{"onUpdate:modelValue":u=>a.field_label=u,type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"Field Label"},null,8,it),[[m,a.field_label]])]),e("div",null,[r(e("select",{"onUpdate:modelValue":u=>a.field_type=u,class:"w-full px-2 py-1 border border-gray-300 rounded text-xs"},[...t[30]||(t[30]=[N('<option value="Data" data-v-6882d328>Text</option><option value="Text" data-v-6882d328>Textarea</option><option value="Select" data-v-6882d328>Select</option><option value="Date" data-v-6882d328>Date</option><option value="Check" data-v-6882d328>Checkbox</option><option value="Currency" data-v-6882d328>Currency</option><option value="Int" data-v-6882d328>Integer</option><option value="Float" data-v-6882d328>Float</option>',8)])],8,rt),[[q,a.field_type]])])]),e("div",pt,[e("div",ct,[r(e("input",{"onUpdate:modelValue":u=>a.field_name=u,type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"field_name"},null,8,ut),[[m,a.field_name]])]),e("div",mt,[e("label",_t,[r(e("input",{"onUpdate:modelValue":u=>a.is_required=u,type:"checkbox",class:"mr-1 text-xs"},null,8,yt),[[k,a.is_required]]),t[31]||(t[31]=F(" Required ",-1))]),e("button",{onClick:u=>P(p,y,B),class:"text-xs text-red-600 hover:text-red-700 ml-auto"}," âœ• ",8,bt)])]),a.field_type==="Select"?(i(),d("div",gt,[r(e("textarea",{"onUpdate:modelValue":u=>a.options=u,rows:"2",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"Options (one per line)"},null,8,vt),[[m,a.options]])])):R("",!0),e("div",xt,[r(e("input",{"onUpdate:modelValue":u=>a.validation=u,type:"text",class:"w-full px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"Validation: email, phone, eval:value >= 18"},null,8,ft),[[m,a.validation]])])]))),128))]))])]))),128))]))])])):R("",!0)]))),128))]))])])])])]))}},Ct=G(ht,[["__scopeId","data-v-6882d328"]]);export{Ct as default};
//# sourceMappingURL=RequestTypeBuilder-D5zmAE3O.js.map
