var V=(F,U,g)=>new Promise((S,o)=>{var z=m=>{try{k(g.next(m))}catch(y){o(y)}},v=m=>{try{k(g.throw(m))}catch(y){o(y)}},k=m=>m.done?S(m.value):Promise.resolve(m.value).then(z,v);k((g=g.apply(F,U)).next())});import{f as J,r as f,j as R,E as W,c,o as d,a as l,F as Z,m as G,q as K,J as Q,aD as X,t as b,d as h,n as P,b as s,u as n,I as u,l as j,z as D,w as x,h as w,i as _,L as Y,g as ee,B as C}from"./index-DsP1JQ8T.js";import{C as le}from"./CouncilSelector-C9e_EDnx.js";const te={class:"min-h-screen bg-gray-50"},ae={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},oe={class:"grid grid-cols-1 lg:grid-cols-4 gap-6"},se={class:"lg:col-span-1"},ne={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4"},re=["onClick"],ie={class:"flex items-center space-x-3"},de={class:"lg:col-span-3"},ue={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center"},me={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},ce={class:"flex items-center space-x-6"},pe={class:"w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center"},ge={key:0,class:"text-3xl font-bold text-blue-600"},ve=["src"],fe={class:"text-lg font-semibold text-gray-900"},be={class:"text-sm text-gray-500"},ye={class:"text-xs text-gray-400 mt-1"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},we={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_e={class:"flex justify-end space-x-4"},ke={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},Ve={key:0,class:"mt-4 p-4 bg-gray-50 rounded-lg"},ze={class:"flex items-center space-x-3"},Ce={class:"font-medium text-gray-900"},he={class:"flex justify-end space-x-4"},Pe={key:3,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},Ue={key:0,class:"text-center py-12"},Se={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ne={class:"flex justify-end space-x-4"},je={key:4,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},De={key:0,class:"p-3 bg-red-50 border border-red-200 rounded-lg"},qe={class:"text-sm text-red-600"},Be={key:1,class:"p-3 bg-green-50 border border-green-200 rounded-lg"},Me={class:"text-sm text-green-600"},Ee={class:"flex justify-end space-x-4"},Ae={__name:"Settings",setup(F){const U=J(),g=f("profile"),S=[{key:"profile",label:"Profile",icon:"user-icon"},{key:"council",label:"Council",icon:"building-icon"},{key:"organization",label:"Organization",icon:"office-icon"},{key:"security",label:"Security",icon:"lock-icon"}],o=f({}),z=f(!0),v=f(!1),k=f(!1),m=f(""),y=f(""),r=f({first_name:"",last_name:"",mobile_no:"",phone:"",bio:"",location:"",default_council:""}),i=f({organization_name:"",contact_email:"",contact_phone:"",address:"",city:"",postal_code:"",website:"",description:""}),p=f({old_password:"",new_password:"",confirm_password:""}),q=R(()=>{var t;if(!o.value.first_name)return"??";const a=o.value.first_name[0]||"",e=((t=o.value.last_name)==null?void 0:t[0])||"";return(a+e).toUpperCase()}),B=()=>V(this,null,function*(){z.value=!0;try{const a=yield C("lodgeick.api.get_user_profile");o.value=a,r.value={first_name:a.first_name||"",last_name:a.last_name||"",mobile_no:a.mobile_no||"",phone:a.phone||"",bio:a.bio||"",location:a.location||"",default_council:a.default_council||""},a.organization_data&&(i.value={organization_name:a.organization_data.organization_name||"",contact_email:a.organization_data.contact_email||"",contact_phone:a.organization_data.contact_phone||"",address:a.organization_data.address||"",city:a.organization_data.city||"",postal_code:a.organization_data.postal_code||"",website:a.organization_data.website||"",description:a.organization_data.description||""})}catch(a){console.error("Error loading profile:",a)}finally{z.value=!1}}),M=()=>V(this,null,function*(){v.value=!0;try{const a=yield C("lodgeick.api.update_user_profile",r.value);o.value=a.user,alert("Profile updated successfully")}catch(a){console.error("Error updating profile:",a),alert("Failed to update profile")}finally{v.value=!1}}),E=()=>V(this,null,function*(){v.value=!0;try{const a=yield C("lodgeick.api.update_user_profile",{default_council:r.value.default_council});o.value=a.user,alert("Council preference updated successfully")}catch(a){console.error("Error updating council:",a),alert("Failed to update council preference")}finally{v.value=!1}}),L=()=>V(this,null,function*(){v.value=!0;try{const a=yield C("lodgeick.api.update_user_organization",i.value);o.value.organization_data=a.organization,alert("Organization updated successfully")}catch(a){console.error("Error updating organization:",a),alert("Failed to update organization")}finally{v.value=!1}}),O=()=>V(this,null,function*(){if(m.value="",y.value="",p.value.new_password!==p.value.confirm_password){m.value="New passwords do not match";return}if(p.value.new_password.length<6){m.value="Password must be at least 6 characters";return}k.value=!0;try{yield C("lodgeick.api.change_password",{old_password:p.value.old_password,new_password:p.value.new_password}),y.value="Password changed successfully",N()}catch(a){console.error("Error changing password:",a),m.value=a.message||"Failed to change password"}finally{k.value=!1}}),I=()=>{r.value={first_name:o.value.first_name||"",last_name:o.value.last_name||"",mobile_no:o.value.mobile_no||"",phone:o.value.phone||"",bio:o.value.bio||"",location:o.value.location||"",default_council:o.value.default_council||""}},T=()=>{r.value.default_council=o.value.default_council||""},A=()=>{o.value.organization_data&&(i.value={organization_name:o.value.organization_data.organization_name||"",contact_email:o.value.organization_data.contact_email||"",contact_phone:o.value.organization_data.contact_phone||"",address:o.value.organization_data.address||"",city:o.value.organization_data.city||"",postal_code:o.value.organization_data.postal_code||"",website:o.value.organization_data.website||"",description:o.value.organization_data.description||""})},N=()=>{p.value={old_password:"",new_password:"",confirm_password:""}},H=a=>a?new Date(a).toLocaleDateString("en-NZ",{year:"numeric",month:"long",day:"numeric"}):"N/A",$=()=>{U.back()};return W(()=>{B()}),(a,e)=>(d(),c("div",te,[l("header",{class:"bg-white shadow-sm border-b border-gray-200"},[l("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},[l("div",{class:"flex justify-between items-center py-4"},[l("div",{class:"flex items-center space-x-3"},[l("button",{onClick:$,class:"text-gray-500 hover:text-gray-700"},[...e[18]||(e[18]=[l("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),e[19]||(e[19]=l("div",null,[l("h1",{class:"text-xl font-bold text-gray-900"},"Settings"),l("p",{class:"text-xs text-gray-500"},"Manage your profile and preferences")],-1))])])])]),l("main",ae,[l("div",oe,[l("div",se,[l("nav",ne,[(d(),c(Z,null,G(S,t=>l("button",{key:t.key,onClick:Le=>g.value=t.key,class:K(["w-full text-left px-4 py-3 rounded-lg transition-colors mb-2",g.value===t.key?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50"])},[l("div",ie,[(d(),Q(X(t.icon),{class:"w-5 h-5"})),l("span",null,b(t.label),1)])],10,re)),64))])]),l("div",de,[z.value?(d(),c("div",ue,[...e[20]||(e[20]=[l("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),l("p",{class:"mt-4 text-gray-500"},"Loading settings...",-1)])])):g.value==="profile"?(d(),c("div",me,[e[29]||(e[29]=l("h2",{class:"text-2xl font-bold text-gray-900 mb-6"},"Profile Information",-1)),l("form",{onSubmit:P(M,["prevent"]),class:"space-y-6"},[l("div",ce,[l("div",pe,[o.value.user_image?(d(),c("img",{key:1,src:o.value.user_image,alt:"Profile",class:"w-full h-full rounded-full object-cover"},null,8,ve)):(d(),c("span",ge,b(q.value),1))]),l("div",null,[l("h3",fe,b(o.value.full_name),1),l("p",be,b(o.value.email),1),l("p",ye,"Member since "+b(H(o.value.creation)),1)])]),l("div",xe,[l("div",null,[e[21]||(e[21]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"First Name",-1)),s(n(u),{modelValue:r.value.first_name,"onUpdate:modelValue":e[0]||(e[0]=t=>r.value.first_name=t),type:"text",required:""},null,8,["modelValue"])]),l("div",null,[e[22]||(e[22]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Last Name",-1)),s(n(u),{modelValue:r.value.last_name,"onUpdate:modelValue":e[1]||(e[1]=t=>r.value.last_name=t),type:"text",required:""},null,8,["modelValue"])])]),l("div",we,[l("div",null,[e[23]||(e[23]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mobile Phone",-1)),s(n(u),{modelValue:r.value.mobile_no,"onUpdate:modelValue":e[2]||(e[2]=t=>r.value.mobile_no=t),type:"tel"},null,8,["modelValue"])]),l("div",null,[e[24]||(e[24]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone",-1)),s(n(u),{modelValue:r.value.phone,"onUpdate:modelValue":e[3]||(e[3]=t=>r.value.phone=t),type:"tel"},null,8,["modelValue"])])]),l("div",null,[e[25]||(e[25]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Location",-1)),s(n(u),{modelValue:r.value.location,"onUpdate:modelValue":e[4]||(e[4]=t=>r.value.location=t),type:"text",placeholder:"City, Country"},null,8,["modelValue"])]),l("div",null,[e[26]||(e[26]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bio",-1)),j(l("textarea",{"onUpdate:modelValue":e[5]||(e[5]=t=>r.value.bio=t),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Tell us about yourself..."},null,512),[[D,r.value.bio]])]),l("div",_e,[s(n(_),{onClick:I,variant:"outline",theme:"gray"},{default:x(()=>[...e[27]||(e[27]=[w(" Cancel ",-1)])]),_:1}),s(n(_),{type:"submit",variant:"solid",theme:"blue",loading:v.value},{default:x(()=>[...e[28]||(e[28]=[w(" Save Changes ",-1)])]),_:1},8,["loading"])])],32)])):g.value==="council"?(d(),c("div",ke,[e[33]||(e[33]=l("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Council Preferences",-1)),e[34]||(e[34]=l("p",{class:"text-gray-600 mb-6"},"Set your default council for new applications",-1)),l("form",{onSubmit:P(E,["prevent"]),class:"space-y-6"},[l("div",null,[s(le,{modelValue:r.value.default_council,"onUpdate:modelValue":e[6]||(e[6]=t=>r.value.default_council=t),label:"Default Council",description:"This council will be pre-selected when you create new requests","display-mode":"dropdown","show-clear-button":!0},null,8,["modelValue"])]),o.value.default_council_data?(d(),c("div",Ve,[e[30]||(e[30]=l("h4",{class:"font-medium text-gray-900 mb-2"},"Current Default Council",-1)),l("div",ze,[l("div",{class:"w-10 h-10 rounded flex items-center justify-center text-white font-bold",style:Y({backgroundColor:o.value.default_council_data.primary_color||"#3B82F6"})},b(o.value.default_council_data.council_code),5),l("div",null,[l("p",Ce,b(o.value.default_council_data.council_name),1)])])])):h("",!0),l("div",he,[s(n(_),{onClick:T,variant:"outline",theme:"gray"},{default:x(()=>[...e[31]||(e[31]=[w(" Cancel ",-1)])]),_:1}),s(n(_),{type:"submit",variant:"solid",theme:"blue",loading:v.value},{default:x(()=>[...e[32]||(e[32]=[w(" Save Changes ",-1)])]),_:1},8,["loading"])])],32)])):g.value==="organization"?(d(),c("div",Pe,[e[46]||(e[46]=l("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Organization Details",-1)),e[47]||(e[47]=l("p",{class:"text-gray-600 mb-6"},"Manage your organization information",-1)),o.value.organization_data?(d(),c("form",{key:1,onSubmit:P(L,["prevent"]),class:"space-y-6"},[l("div",null,[e[36]||(e[36]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Organization Name",-1)),s(n(u),{modelValue:i.value.organization_name,"onUpdate:modelValue":e[7]||(e[7]=t=>i.value.organization_name=t),type:"text",required:""},null,8,["modelValue"])]),l("div",Se,[l("div",null,[e[37]||(e[37]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Contact Email",-1)),s(n(u),{modelValue:i.value.contact_email,"onUpdate:modelValue":e[8]||(e[8]=t=>i.value.contact_email=t),type:"email",required:""},null,8,["modelValue"])]),l("div",null,[e[38]||(e[38]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Contact Phone",-1)),s(n(u),{modelValue:i.value.contact_phone,"onUpdate:modelValue":e[9]||(e[9]=t=>i.value.contact_phone=t),type:"tel",required:""},null,8,["modelValue"])])]),l("div",null,[e[39]||(e[39]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Address",-1)),s(n(u),{modelValue:i.value.address,"onUpdate:modelValue":e[10]||(e[10]=t=>i.value.address=t),type:"text"},null,8,["modelValue"])]),l("div",Fe,[l("div",null,[e[40]||(e[40]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"City",-1)),s(n(u),{modelValue:i.value.city,"onUpdate:modelValue":e[11]||(e[11]=t=>i.value.city=t),type:"text"},null,8,["modelValue"])]),l("div",null,[e[41]||(e[41]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Postal Code",-1)),s(n(u),{modelValue:i.value.postal_code,"onUpdate:modelValue":e[12]||(e[12]=t=>i.value.postal_code=t),type:"text"},null,8,["modelValue"])])]),l("div",null,[e[42]||(e[42]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Website",-1)),s(n(u),{modelValue:i.value.website,"onUpdate:modelValue":e[13]||(e[13]=t=>i.value.website=t),type:"url",placeholder:"https://example.com"},null,8,["modelValue"])]),l("div",null,[e[43]||(e[43]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),j(l("textarea",{"onUpdate:modelValue":e[14]||(e[14]=t=>i.value.description=t),rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Describe your organization..."},null,512),[[D,i.value.description]])]),l("div",Ne,[s(n(_),{onClick:A,variant:"outline",theme:"gray"},{default:x(()=>[...e[44]||(e[44]=[w(" Cancel ",-1)])]),_:1}),s(n(_),{type:"submit",variant:"solid",theme:"blue",loading:v.value},{default:x(()=>[...e[45]||(e[45]=[w(" Save Changes ",-1)])]),_:1},8,["loading"])])],32)):(d(),c("div",Ue,[...e[35]||(e[35]=[ee('<div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">No Organization Linked</h3><p class="text-gray-500">Contact an administrator to link your account to an organization</p>',3)])]))])):g.value==="security"?(d(),c("div",je,[e[53]||(e[53]=l("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Security Settings",-1)),e[54]||(e[54]=l("p",{class:"text-gray-600 mb-6"},"Update your password and security preferences",-1)),l("form",{onSubmit:P(O,["prevent"]),class:"space-y-6 max-w-md"},[l("div",null,[e[48]||(e[48]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Current Password",-1)),s(n(u),{modelValue:p.value.old_password,"onUpdate:modelValue":e[15]||(e[15]=t=>p.value.old_password=t),type:"password",required:""},null,8,["modelValue"])]),l("div",null,[e[49]||(e[49]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"New Password",-1)),s(n(u),{modelValue:p.value.new_password,"onUpdate:modelValue":e[16]||(e[16]=t=>p.value.new_password=t),type:"password",required:""},null,8,["modelValue"])]),l("div",null,[e[50]||(e[50]=l("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Confirm New Password",-1)),s(n(u),{modelValue:p.value.confirm_password,"onUpdate:modelValue":e[17]||(e[17]=t=>p.value.confirm_password=t),type:"password",required:""},null,8,["modelValue"])]),m.value?(d(),c("div",De,[l("p",qe,b(m.value),1)])):h("",!0),y.value?(d(),c("div",Be,[l("p",Me,b(y.value),1)])):h("",!0),l("div",Ee,[s(n(_),{onClick:N,variant:"outline",theme:"gray"},{default:x(()=>[...e[51]||(e[51]=[w(" Cancel ",-1)])]),_:1}),s(n(_),{type:"submit",variant:"solid",theme:"blue",loading:k.value},{default:x(()=>[...e[52]||(e[52]=[w(" Change Password ",-1)])]),_:1},8,["loading"])])],32)])):h("",!0)])])])]))}};export{Ae as default};
//# sourceMappingURL=Settings-yUqoyHWT.js.map
