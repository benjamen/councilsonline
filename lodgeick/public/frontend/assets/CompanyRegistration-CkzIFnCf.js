import{f as H,r as v,j as J,p as $,c as r,o,a as t,g as L,F as N,m as W,d as w,q as p,t as c,n as X,l as P,aI as z,h as n,b as d,u,I as g,A as G,H as A,w as _,i as j}from"./index-DewTqyKl.js";import{C as K}from"./CouncilSelector-CUHj0nPj.js";import{_ as Q,v as ee,a as te,b as le,c as se}from"./validation-C4PvU_XI.js";const ae={class:"min-h-screen bg-gradient-to-br from-blue-50 to-slate-100 flex items-center justify-center p-4"},oe={class:"w-full max-w-4xl"},re={class:"mb-8"},ne={class:"flex items-center justify-between"},ie={class:"flex items-center"},de={class:"flex items-center flex-col flex-1"},ue={key:0,class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20"},me={key:1,class:"text-sm font-semibold"},ve={class:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100"},pe={class:"space-y-6"},ce={class:"grid grid-cols-2 gap-4"},ge={class:"grid md:grid-cols-2 gap-4"},be={class:"grid md:grid-cols-2 gap-4"},xe={key:0,class:"mt-1 text-xs text-red-600"},fe={key:0,class:"mt-1 text-xs text-red-600"},ye={key:1,class:"mt-1 text-xs text-gray-500"},he={class:"grid md:grid-cols-2 gap-4"},we={key:0,class:"mt-1 text-xs text-red-600"},_e={key:0,class:"mt-1 text-xs text-red-600"},ke={class:"space-y-6"},Ve={class:"text-xl font-semibold text-gray-900 mb-4"},Ce={key:0,class:"space-y-4"},Be={class:"grid md:grid-cols-2 gap-4"},Se={key:0,class:"mt-1 text-xs text-red-600"},Pe={key:1,class:"mt-1 text-xs text-gray-500"},Me={key:1},Ne={class:"space-y-6"},ze={class:"flex items-start"},Ae={key:0,class:"mt-6 p-3 bg-red-50 border border-red-200 rounded-lg"},je={class:"flex items-start"},qe={class:"text-sm text-red-700"},Te={class:"flex items-center justify-between mt-8 pt-6 border-t border-gray-200"},Ue={key:1},De={class:"text-center mt-6"},Ee={class:"text-sm text-gray-600"},Le={class:"text-center mt-4"},Ye={__name:"CompanyRegistration",setup(Re){const R=H(),M=[{label:"Your Details"},{label:"Business Info"},{label:"Settings"}],i=v(0),h=v(!1),m=v(""),b=v(null),l=v({agent_type:"Sole Trader",first_name:"",last_name:"",email:"",phone:"",password:"",confirm_password:"",company_name:"",company_number:"",nzbn:"",trading_name:"",default_council:null,terms:!1}),k=v(""),V=v(""),C=v(""),B=v(""),S=v(""),y=v(""),F=J(()=>y.value==="strong"?"text-green-600":y.value==="medium"?"text-yellow-600":"text-red-600"),q=()=>{const s=te(l.value.phone);return s.isValid?(k.value="",l.value.phone=s.formatted):k.value=s.message,s.isValid},T=()=>{const s=ee(l.value.email);return s.isValid?V.value="":V.value=s.message,s.isValid},U=()=>{const s=le(l.value.password);return s.isValid?(C.value="",y.value=s.strength):(C.value=s.message,y.value=""),s.isValid},D=()=>l.value.password!==l.value.confirm_password?(B.value="Passwords do not match",!1):(B.value="",!0),E=()=>{const s=se(l.value.nzbn);return s.isValid?S.value="":S.value=s.message,s.isValid},I=s=>{b.value=s};function O(){if(i.value===0){const s=q(),e=T(),f=U(),a=D();if(!l.value.first_name||!l.value.last_name){m.value="Please fill in all required fields";return}if(!s||!e||!f||!a){m.value="Please correct the errors above";return}}else if(i.value===1){if(l.value.agent_type==="Company"&&!l.value.company_name){m.value="Company name is required";return}if(l.value.nzbn&&!E())return}m.value="",i.value++}function Y(){m.value="",i.value--}function Z(){if(!l.value.terms){m.value="You must agree to the Terms of Service and Privacy Policy";return}m.value="",h.value=!0;const s={email:l.value.email,first_name:l.value.first_name,last_name:l.value.last_name,phone:l.value.phone,password:l.value.password,user_role:"agent",agent_type:l.value.agent_type};l.value.agent_type==="Company"?(s.company_name=l.value.company_name,s.company_number=l.value.company_number,s.nzbn=l.value.nzbn):s.trading_name=l.value.trading_name,b.value&&(s.business_address=b.value.full_address,s.business_street=b.value.street_address,s.business_suburb=b.value.suburb,s.business_city=b.value.city,s.business_postcode=b.value.postcode),l.value.default_council&&(s.council_code=l.value.default_council),fetch("/api/method/lodgeick.api.register_agent",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":window.csrf_token},body:JSON.stringify(s)}).then(e=>e.json()).then(e=>{if(h.value=!1,e.message&&e.message.success)R.push({name:"Login",query:{registered:"true",type:"agent"}});else if(e.exc||e._server_messages){const f=e._server_messages?JSON.parse(e._server_messages):[],a=f.length>0?JSON.parse(f[0]).message:"Registration failed. Please try again.";m.value=a,console.error("Agent registration error:",e.exc||e._server_messages)}else m.value="Registration failed. Please try again."}).catch(e=>{h.value=!1,m.value="Network error. Please check your connection and try again.",console.error("Agent registration error:",e)})}return(s,e)=>{const f=$("router-link");return o(),r("div",ae,[t("div",oe,[e[42]||(e[42]=L('<div class="text-center mb-8"><div class="inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-2xl mb-4 shadow-lg"><svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg></div><h1 class="text-3xl font-bold text-gray-900 mb-2">Register as Agent</h1><p class="text-gray-600">Planning consultants who assist applicants with resource consent applications</p></div><div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8"><div class="flex items-start"><svg class="w-5 h-5 text-blue-600 mr-3 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="text-sm text-blue-800"><p class="font-medium">You are registering as an Agent</p><p class="mt-1">Agents are planning consultants who assist applicants with resource consent applications. You can be a sole trader or represent a company.</p></div></div></div>',2)),t("div",re,[t("div",ne,[(o(),r(N,null,W(M,(a,x)=>t("div",{key:x,class:"flex-1"},[t("div",ie,[t("div",de,[t("div",{class:p(["w-10 h-10 rounded-full flex items-center justify-center border-2 transition",i.value>x?"bg-blue-600 border-blue-600 text-white":i.value===x?"border-blue-600 bg-white text-blue-600":"border-gray-300 bg-white text-gray-400"])},[i.value>x?(o(),r("svg",ue,[...e[15]||(e[15]=[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):(o(),r("span",me,c(x+1),1))],2),t("span",{class:p(["text-xs mt-2 font-medium text-center",i.value>=x?"text-blue-600":"text-gray-400"])},c(a.label),3)]),x<M.length-1?(o(),r("div",{key:0,class:p(["h-0.5 flex-1 -mt-8",i.value>x?"bg-blue-600":"bg-gray-300"])},null,2)):w("",!0)])])),64))])]),t("div",ve,[t("form",{onSubmit:X(Z,["prevent"])},[P(t("div",pe,[e[27]||(e[27]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Agent Type & Your Details",-1)),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-3"},[n(" Agent Type "),t("span",{class:"text-red-500"},"*")],-1)),t("div",ce,[t("button",{type:"button",onClick:e[0]||(e[0]=a=>l.value.agent_type="Sole Trader"),class:p(["p-4 border-2 rounded-lg text-center transition",l.value.agent_type==="Sole Trader"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"])},[(o(),r("svg",{class:p(["w-8 h-8 mx-auto mb-2",l.value.agent_type==="Sole Trader"?"text-blue-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[16]||(e[16]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])],2)),t("div",{class:p(["text-sm font-medium",l.value.agent_type==="Sole Trader"?"text-blue-900":"text-gray-700"])}," Sole Trader ",2),e[17]||(e[17]=t("div",{class:"text-xs text-gray-500 mt-1"},"Individual consultant",-1))],2),t("button",{type:"button",onClick:e[1]||(e[1]=a=>l.value.agent_type="Company"),class:p(["p-4 border-2 rounded-lg text-center transition",l.value.agent_type==="Company"?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"])},[(o(),r("svg",{class:p(["w-8 h-8 mx-auto mb-2",l.value.agent_type==="Company"?"text-blue-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[18]||(e[18]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},null,-1)])],2)),t("div",{class:p(["text-sm font-medium",l.value.agent_type==="Company"?"text-blue-900":"text-gray-700"])}," Company ",2),e[19]||(e[19]=t("div",{class:"text-xs text-gray-500 mt-1"},"Consulting firm",-1))],2)])]),t("div",ge,[t("div",null,[e[21]||(e[21]=t("label",{for:"first_name",class:"block text-sm font-medium text-gray-700 mb-2"},[n(" First Name "),t("span",{class:"text-red-500"},"*")],-1)),d(u(g),{id:"first_name",modelValue:l.value.first_name,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.first_name=a),type:"text",required:"",placeholder:"John",class:"w-full"},null,8,["modelValue"])]),t("div",null,[e[22]||(e[22]=t("label",{for:"last_name",class:"block text-sm font-medium text-gray-700 mb-2"},[n(" Last Name "),t("span",{class:"text-red-500"},"*")],-1)),d(u(g),{id:"last_name",modelValue:l.value.last_name,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.last_name=a),type:"text",required:"",placeholder:"Doe",class:"w-full"},null,8,["modelValue"])])]),t("div",be,[t("div",null,[e[23]||(e[23]=t("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-2"},[n(" Email Address "),t("span",{class:"text-red-500"},"*")],-1)),d(u(g),{id:"email",modelValue:l.value.email,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.email=a),type:"email",required:"",placeholder:"you@example.com",class:"w-full",onBlur:T},null,8,["modelValue"]),V.value?(o(),r("p",xe,c(V.value),1)):w("",!0)]),t("div",null,[e[24]||(e[24]=t("label",{for:"phone",class:"block text-sm font-medium text-gray-700 mb-2"},[n(" Phone Number "),t("span",{class:"text-red-500"},"*")],-1)),d(u(g),{id:"phone",modelValue:l.value.phone,"onUpdate:modelValue":e[5]||(e[5]=a=>l.value.phone=a),type:"tel",required:"",placeholder:"021 234 5678",class:"w-full",onBlur:q},null,8,["modelValue"]),k.value?(o(),r("p",fe,c(k.value),1)):(o(),r("p",ye,"NZ mobile (02x) or landline (03-09)"))])]),t("div",he,[t("div",null,[e[25]||(e[25]=t("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-2"},[n(" Password "),t("span",{class:"text-red-500"},"*")],-1)),d(u(g),{id:"password",modelValue:l.value.password,"onUpdate:modelValue":e[6]||(e[6]=a=>l.value.password=a),type:"password",required:"",placeholder:"Min. 8 characters",class:"w-full",onInput:U},null,8,["modelValue"]),C.value?(o(),r("p",we,c(C.value),1)):y.value?(o(),r("p",{key:1,class:p(["mt-1 text-xs",F.value])}," Password strength: "+c(y.value),3)):w("",!0)]),t("div",null,[e[26]||(e[26]=t("label",{for:"confirm_password",class:"block text-sm font-medium text-gray-700 mb-2"},[n(" Confirm Password "),t("span",{class:"text-red-500"},"*")],-1)),d(u(g),{id:"confirm_password",modelValue:l.value.confirm_password,"onUpdate:modelValue":e[7]||(e[7]=a=>l.value.confirm_password=a),type:"password",required:"",placeholder:"Repeat password",class:"w-full",onBlur:D},null,8,["modelValue"]),B.value?(o(),r("p",_e,c(B.value),1)):w("",!0)])])],512),[[z,i.value===0]]),P(t("div",ke,[t("h2",Ve,c(l.value.agent_type==="Company"?"Company Details":"Business Details"),1),l.value.agent_type==="Company"?(o(),r("div",Ce,[t("div",Be,[t("div",null,[e[28]||(e[28]=t("label",{for:"company_name",class:"block text-sm font-medium text-gray-700 mb-2"},[n(" Company Name "),t("span",{class:"text-red-500"},"*")],-1)),d(u(g),{id:"company_name",modelValue:l.value.company_name,"onUpdate:modelValue":e[8]||(e[8]=a=>l.value.company_name=a),type:"text",required:l.value.agent_type==="Company",placeholder:"ABC Planning Consultants Ltd",class:"w-full"},null,8,["modelValue","required"])]),t("div",null,[e[29]||(e[29]=t("label",{for:"company_number",class:"block text-sm font-medium text-gray-700 mb-2"}," Company Number (Optional) ",-1)),d(u(g),{id:"company_number",modelValue:l.value.company_number,"onUpdate:modelValue":e[9]||(e[9]=a=>l.value.company_number=a),type:"text",placeholder:"1234567",class:"w-full"},null,8,["modelValue"])])]),t("div",null,[e[30]||(e[30]=t("label",{for:"nzbn",class:"block text-sm font-medium text-gray-700 mb-2"}," NZBN (Optional) ",-1)),d(u(g),{id:"nzbn",modelValue:l.value.nzbn,"onUpdate:modelValue":e[10]||(e[10]=a=>l.value.nzbn=a),type:"text",maxlength:"13",placeholder:"1234567890123",class:"w-full",onBlur:E},null,8,["modelValue"]),S.value?(o(),r("p",Se,c(S.value),1)):(o(),r("p",Pe,"New Zealand Business Number (13 digits)"))])])):(o(),r("div",Me,[t("div",null,[e[31]||(e[31]=t("label",{for:"trading_name",class:"block text-sm font-medium text-gray-700 mb-2"}," Trading Name (Optional) ",-1)),d(u(g),{id:"trading_name",modelValue:l.value.trading_name,"onUpdate:modelValue":e[11]||(e[11]=a=>l.value.trading_name=a),type:"text",placeholder:"e.g., Smith Planning Services",class:"w-full"},null,8,["modelValue"]),e[32]||(e[32]=t("p",{class:"mt-1 text-xs text-gray-500"},"If you trade under a business name",-1))])])),t("div",null,[d(Q,{modelValue:b.value,"onUpdate:modelValue":e[12]||(e[12]=a=>b.value=a),id:"business_address",label:"Business Address",placeholder:"Start typing your business address...",description:"Your business/office address",required:!1,onAddressSelected:I},null,8,["modelValue"])])],512),[[z,i.value===1]]),P(t("div",Ne,[e[34]||(e[34]=t("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Default Settings",-1)),t("div",null,[d(K,{modelValue:l.value.default_council,"onUpdate:modelValue":e[13]||(e[13]=a=>l.value.default_council=a),label:"Default Council (Optional)",description:"Select your primary council for applications. You can work with multiple councils.","display-mode":"dropdown",required:!1,"show-clear-button":!0},null,8,["modelValue"])]),e[35]||(e[35]=L('<div class="p-4 bg-blue-50 border border-blue-200 rounded-lg"><h3 class="text-sm font-medium text-blue-900 mb-2">Agent Permissions</h3><ul class="text-sm text-blue-800 space-y-1"><li class="flex items-start"><svg class="w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> Create and submit applications on behalf of clients </li><li class="flex items-start"><svg class="w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> Manage multiple client applications </li><li class="flex items-start"><svg class="w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> Receive notifications on application progress </li><li class="flex items-start"><svg class="w-4 h-4 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> Professional dashboard for tracking all applications </li></ul></div>',1)),t("div",ze,[P(t("input",{id:"terms","onUpdate:modelValue":e[14]||(e[14]=a=>l.value.terms=a),type:"checkbox",required:"",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mt-1"},null,512),[[G,l.value.terms]]),e[33]||(e[33]=t("label",{for:"terms",class:"ml-2 block text-sm text-gray-700"},[n(" I agree to the "),t("a",{href:"#",class:"text-blue-600 hover:text-blue-700 font-medium"},"Terms of Service"),n(" and "),t("a",{href:"#",class:"text-blue-600 hover:text-blue-700 font-medium"},"Privacy Policy")],-1))])],512),[[z,i.value===2]]),m.value?(o(),r("div",Ae,[t("div",je,[e[36]||(e[36]=t("svg",{class:"w-5 h-5 text-red-600 mr-2 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("p",qe,c(m.value),1)])])):w("",!0),t("div",Te,[i.value>0?(o(),A(u(j),{key:0,type:"button",onClick:Y,variant:"outline",class:"px-6 py-2"},{default:_(()=>[...e[37]||(e[37]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),n(" Previous ",-1)])]),_:1})):(o(),r("div",Ue)),i.value<M.length-1?(o(),A(u(j),{key:2,type:"button",onClick:O,variant:"solid",class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2"},{default:_(()=>[...e[38]||(e[38]=[n(" Next ",-1),t("svg",{class:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])]),_:1})):(o(),A(u(j),{key:3,type:"submit",loading:h.value,variant:"solid",class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2"},{default:_(()=>[h.value?(o(),r(N,{key:1},[n(" Creating... ")],64)):(o(),r(N,{key:0},[n(" Create Agent Account ")],64))]),_:1},8,["loading"]))])],32)]),t("div",De,[t("p",Ee,[e[40]||(e[40]=n(" Want to register as an applicant instead? ",-1)),d(f,{to:{name:"Register"},class:"font-medium text-blue-600 hover:text-blue-700"},{default:_(()=>[...e[39]||(e[39]=[n(" Register as applicant ",-1)])]),_:1})])]),t("div",Le,[d(f,{to:"/",class:"text-sm text-gray-500 hover:text-gray-700 inline-flex items-center"},{default:_(()=>[...e[41]||(e[41]=[t("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),n(" Back to home ",-1)])]),_:1})])])])}}};export{Ye as default};
//# sourceMappingURL=CompanyRegistration-CkzIFnCf.js.map
