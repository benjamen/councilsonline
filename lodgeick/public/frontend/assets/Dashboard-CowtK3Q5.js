import{a5 as $,c as i,B as v,a as n,o as r,b as e,u as d,t as a,aj as P,R as l,P as m,a2 as M,a6 as z,ak as E,F,W as O,e as W,_ as T}from"./vue-vendor-B0shnPjy.js";import{h as V,m as G,I as Q}from"./frappe-ui-DjR51muK.js";import{_ as f}from"./StatCard-BqCbYPig.js";import{u as Y,s as b}from"./index-C-Rb0cle.js";import{r as Z}from"./request.service-W88L9M1G.js";import"./ui-components-BkacYXVN.js";const J={class:"min-h-screen bg-gray-50"},K={class:"bg-white shadow-sm border-b border-gray-200"},X={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ee={class:"flex justify-between items-center py-4"},te={class:"flex items-center space-x-3"},se={key:0,class:"w-10 h-10 rounded-lg flex items-center justify-center overflow-hidden"},oe=["src","alt"],ae={key:1,class:"w-10 h-10 bg-brand rounded-lg flex items-center justify-center"},ne={class:"text-xl font-bold text-gray-900"},re={class:"text-xs text-gray-500"},le={class:"flex items-center space-x-4"},ie={class:"flex items-center space-x-2 text-gray-700 hover:text-gray-900"},de={class:"w-8 h-8 bg-brand-light rounded-full flex items-center justify-center"},ue={class:"text-sm font-medium text-brand"},ce={class:"text-sm font-medium"},pe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},me={class:"mb-8"},xe={class:"text-2xl font-bold text-gray-900 mb-2"},ge={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},he={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},ve={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},fe={class:"md:col-span-2"},ye={class:"bg-white rounded-lg shadow-sm border border-gray-200"},we={key:0,class:"p-12 text-center"},be={key:1,class:"p-12 text-center"},_e={class:"text-gray-500 mb-6"},ke={key:2,class:"overflow-x-auto"},Ce={class:"w-full"},Re={class:"bg-white divide-y divide-gray-200"},Ne=["onClick"],je={class:"px-4 py-3 whitespace-nowrap"},Se={class:"text-sm font-medium text-brand"},qe={class:"px-4 py-3 max-w-xs"},Me=["title"],Te={class:"px-4 py-3 whitespace-nowrap"},Ve={class:"text-sm text-gray-900"},Be={class:"px-4 py-3 whitespace-nowrap"},De={class:"text-sm text-gray-500"},Ie={class:"px-4 py-3 whitespace-nowrap text-center"},Le={class:"text-sm font-medium text-gray-900"},Ae={class:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium"},Ue=["onClick"],He=["onClick"],Ye={__name:"Dashboard",setup($e){const u=$(),{appName:B,tagline:D,logo:_}=Y(),k=i(()=>B.value||"Councils Online"),I=i(()=>D.value||"Council Request Management"),y=i(()=>{var t;return(((t=b.user_info)==null?void 0:t.full_name)||b.user).replace("@"," ").split(".").join(" ")}),L=i(()=>{const s=y.value,t=s.split(" ");return t.length>=2?(t[0][0]+t[1][0]).toUpperCase():s.substring(0,2).toUpperCase()}),c=v(""),C=v(""),R=v(""),x=v(""),g=Z.getUserRequests();i(()=>{const s=g.data||[];return[...new Set(s.map(o=>o.council).filter(Boolean))].sort()});const h=i(()=>{const s=g.data||[];return{total:s.length,underReview:s.filter(t=>t.status==="Under Review").length,approved:s.filter(t=>t.status==="Approved").length,rfiPending:s.filter(t=>t.status==="RFI Issued").length}}),w=i(()=>{let s=g.data||[];if(c.value){const t=c.value.toLowerCase();s=s.filter(o=>{var p,S,q;return((p=o.request_number)==null?void 0:p.toLowerCase().includes(t))||((S=o.property_address)==null?void 0:S.toLowerCase().includes(t))||((q=o.brief_description)==null?void 0:q.toLowerCase().includes(t))})}return C.value&&(s=s.filter(t=>t.status===C.value)),R.value&&(s=s.filter(t=>t.council===R.value)),x.value&&(s=s.filter(t=>{var o;return(o=t.request_type)==null?void 0:o.includes(x.value)})),s}),A=s=>s?new Date(s).toLocaleDateString("en-NZ",{year:"numeric",month:"short",day:"numeric"}):"N/A",N=()=>{u.push({name:"NewRequest"})},j=s=>{u.push({name:"RequestDetail",params:{id:s}})},U=s=>{u.push({name:"RequestDetail",params:{id:s}})},H=[{label:"Staff Portal",onClick:()=>{u.push({name:"InternalRequestManagement"})}},{label:"Settings",onClick:()=>{u.push({name:"Settings"})}},{label:"Sign Out",onClick:()=>b.logout.submit()}];return(s,t)=>(r(),n("div",J,[e("header",K,[e("div",X,[e("div",ee,[e("div",te,[d(_)?(r(),n("div",se,[e("img",{src:d(_),alt:k.value,class:"w-full h-full object-contain"},null,8,oe)])):(r(),n("div",ae,[...t[2]||(t[2]=[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)])])),e("div",null,[e("h1",ne,a(k.value),1),e("p",re,a(I.value),1)])]),e("div",le,[t[6]||(t[6]=P('<a href="https://taytay.gov.ph" target="_blank" rel="noopener noreferrer" class="hidden md:flex items-center space-x-2 text-gray-600 hover:text-brand transition-colors px-3 py-2 rounded-md hover:bg-brand-light"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg><span class="text-sm font-medium">Taytay Council</span><svg class="w-3 h-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></a>',1)),l(d(V),{onClick:N,variant:"solid",theme:"blue"},{prefix:m(()=>[...t[3]||(t[3]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:m(()=>[t[4]||(t[4]=M(" New Request ",-1))]),_:1}),l(d(G),{options:H},{default:m(({open:o})=>[e("button",ie,[e("div",de,[e("span",ue,a(L.value),1)]),e("span",ce,a(y.value),1),t[5]||(t[5]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),_:1})])])])]),e("main",pe,[e("div",me,[e("h2",xe,"Welcome back, "+a(y.value)+"!",1),t[7]||(t[7]=e("p",{class:"text-gray-600"},"Manage your council requests and track their progress",-1))]),e("div",ge,[l(f,{title:"Total Requests",value:h.value.total,icon:"file-text",color:"blue"},null,8,["value"]),l(f,{title:"Under Review",value:h.value.underReview,icon:"clock",color:"yellow"},null,8,["value"]),l(f,{title:"Approved",value:h.value.approved,icon:"check-circle",color:"green"},null,8,["value"]),l(f,{title:"Info Requested",value:h.value.rfiPending,icon:"alert-circle",color:"orange"},null,8,["value"])]),e("div",he,[e("div",ve,[e("div",fe,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),l(d(Q),{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),placeholder:"Search by request number or address...",type:"text"},{prefix:m(()=>[...t[8]||(t[8]=[e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)])]),_:1},8,["modelValue"])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type",-1)),z(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>x.value=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand focus:border-brand"},[...t[10]||(t[10]=[e("option",{value:""},"All Types",-1),e("option",{value:"Resource Consent"},"Resource Consent",-1),e("option",{value:"Building Consent"},"Building Consent",-1)])],512),[[E,x.value]])])])]),e("div",ye,[t[17]||(t[17]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Your Requests")],-1)),d(g).loading?(r(),n("div",we,[...t[12]||(t[12]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"},null,-1),e("p",{class:"mt-4 text-gray-500"},"Loading applications...",-1)])])):!w.value||w.value.length===0?(r(),n("div",be,[t[14]||(t[14]=e("div",{class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"},[e("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),t[15]||(t[15]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No applications found",-1)),e("p",_e,a(c.value?"Try adjusting your search or filters":"Get started by creating your first application"),1),l(d(V),{onClick:N,variant:"solid",theme:"blue"},{default:m(()=>[...t[13]||(t[13]=[M(" Create New Application ",-1)])]),_:1})])):(r(),n("div",ke,[e("table",Ce,[t[16]||(t[16]=e("thead",{class:"bg-gray-50 border-b border-gray-200"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Request #"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"State"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap"},"Days Elapsed"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Re,[(r(!0),n(F,null,O(w.value,o=>(r(),n("tr",{key:o.name,class:"hover:bg-gray-50 transition cursor-pointer",onClick:p=>j(o.name)},[e("td",je,[e("div",Se,a(o.request_number),1)]),e("td",qe,[e("div",{class:"text-sm text-gray-900 truncate",title:o.request_type},a(o.request_type),9,Me)]),e("td",Te,[e("div",Ve,a(o.workflow_state||"N/A"),1)]),e("td",Be,[e("div",De,a(A(o.creation)),1)]),e("td",Ie,[e("div",Le,a(o.working_days_elapsed||0)+" days",1)]),e("td",Ae,[e("button",{onClick:T(p=>j(o.name),["stop"]),class:"text-brand hover:text-brand-hover mr-3"}," View ",8,Ue),o.status==="Draft"?(r(),n("button",{key:0,onClick:T(p=>U(o.name),["stop"]),class:"text-gray-600 hover:text-gray-900"}," Edit ",8,He)):W("",!0)])],8,Ne))),128))])])]))])])]))}};export{Ye as default};
//# sourceMappingURL=Dashboard-CowtK3Q5.js.map
