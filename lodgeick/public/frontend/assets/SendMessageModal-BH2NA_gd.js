var w=(g,v,n)=>new Promise((i,c)=>{var r=t=>{try{a(n.next(t))}catch(o){c(o)}},d=t=>{try{a(n.throw(t))}catch(o){c(o)}},a=t=>t.done?i(t.value):Promise.resolve(t.value).then(r,d);a((n=n.apply(g,v)).next())});import{c as h,B as u,O as V,o as p,P as T,b as s,a as b,e as k,R as M,u as _,a6 as S,ae as B,ak as j,t as q}from"./vue-vendor-B0shnPjy.js";import{I as O,D as E}from"./frappe-ui-DjR51muK.js";import"./ui-components-BkacYXVN.js";const N={class:"p-6"},P={class:"space-y-4"},D=["disabled"],F=["disabled"],I={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-4"},U={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},L={class:"text-sm text-red-800"},R={class:"flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200"},z=["disabled"],J=["disabled"],X={key:0},Y={key:1},Q={__name:"SendMessageModal",props:{show:{type:Boolean,required:!0},requestId:{type:String,required:!0}},emits:["update:show","sent"],setup(g,{emit:v}){const n=g,i=v,c=h({get:()=>n.show,set:m=>i("update:show",m)}),r=u(""),d=u(""),a=u("Email"),t=u(!1),o=u(null),f=u(!1),y=h(()=>r.value.trim()&&d.value.trim()),x=()=>{t.value||(r.value="",d.value="",a.value="Email",o.value=null,f.value=!1,i("update:show",!1))},C=()=>w(this,null,function*(){var m;if(y.value){t.value=!0,o.value=null;try{const l=yield(yield fetch("/api/method/lodgeick.api.send_request_message",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":window.csrf_token},body:JSON.stringify({request_id:n.requestId,subject:r.value,message:d.value,communication_type:a.value})})).json();(m=l.message)!=null&&m.success?(f.value=!0,o.value=null,i("sent"),setTimeout(()=>{x()},2e3)):o.value=l.exc||l._server_messages||"Failed to send message"}catch(e){console.error("Send message error:",e),o.value="Network error. Please try again."}finally{t.value=!1}}});return(m,e)=>(p(),V(_(E),{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=l=>c.value=l),options:{size:"lg"}},{body:T(()=>[s("div",N,[e[10]||(e[10]=s("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Send Message to Council",-1)),s("div",P,[s("div",null,[e[4]||(e[4]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Subject *",-1)),M(_(O),{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l),placeholder:"Brief description of your message",disabled:t.value},null,8,["modelValue","disabled"])]),s("div",null,[e[5]||(e[5]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Message *",-1)),S(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>d.value=l),rows:"8",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Type your message to the council...",disabled:t.value},null,8,D),[[B,d.value]])]),s("div",null,[e[7]||(e[7]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Communication Type",-1)),S(s("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.value=l),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",disabled:t.value},[...e[6]||(e[6]=[s("option",{value:"Email"},"Email",-1),s("option",{value:"Phone"},"Phone Call Follow-up",-1),s("option",{value:"Letter"},"Letter",-1),s("option",{value:"Other"},"Other",-1)])],8,F),[[j,a.value]])]),e[9]||(e[9]=s("div",{class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},[s("p",{class:"text-sm text-blue-800"}," Your message will be sent to the council processing team. They typically respond within 2-3 business days. ")],-1)),f.value?(p(),b("div",I,[...e[8]||(e[8]=[s("div",{class:"flex items-center"},[s("svg",{class:"w-5 h-5 text-green-600 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})]),s("p",{class:"text-sm text-green-800 font-medium"},"Message sent successfully! The council will respond within 2-3 business days.")],-1)])])):k("",!0),o.value?(p(),b("div",U,[s("p",L,q(o.value),1)])):k("",!0),s("div",R,[s("button",{onClick:x,disabled:t.value,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 hover:bg-gray-50 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50"}," Cancel ",8,z),s("button",{onClick:C,disabled:!y.value||t.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[t.value?(p(),b("span",X,"Sending...")):(p(),b("span",Y,"Send Message"))],8,J)])])])]),_:1},8,["modelValue"]))}};export{Q as default};
//# sourceMappingURL=SendMessageModal-BH2NA_gd.js.map
