var _=(e,o,s)=>new Promise((p,h)=>{var c=m=>{try{v(s.next(m))}catch(a){h(a)}},g=m=>{try{v(s.throw(m))}catch(a){h(a)}},v=m=>m.done?p(m.value):Promise.resolve(m.value).then(c,g);v((s=s.apply(e,o)).next())});import{r as b,x as T,c as d,o as i,d as u,a as n,h as Z,t as f,l as C,z,F as E,m as L,n as D,B as I}from"./index-BSBNcMJx.js";const W={class:"relative"},j=["for"],F={key:0,class:"text-red-500"},H={class:"relative"},O=["id","placeholder","required"],Q={key:0,class:"absolute right-3 top-1/2 -translate-y-1/2"},R={key:1,class:"mt-1 text-xs text-gray-500"},U={key:2,class:"mt-1 text-xs text-red-600"},G={key:3,class:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-96 overflow-y-auto"},J={key:0,class:"p-4 text-center text-gray-500"},K={key:1},X=["onMousedown"],Y={class:"font-medium text-gray-900"},ee={key:0,class:"text-sm text-gray-600 mt-1"},te={key:1,class:"text-xs text-gray-500 mt-1"},se={key:2,class:"p-4 text-center text-gray-500"},re={key:4,class:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg"},ae={class:"flex items-start justify-between"},le={class:"flex-1"},oe={class:"text-sm text-green-700 mt-1"},de={key:0,class:"text-xs text-green-600 mt-1"},ie={key:0},ne={key:1},me={__name:"AddressLookup",props:{modelValue:{type:Object,default:null},id:{type:String,default:"address-lookup"},label:{type:String,default:"Property Address"},placeholder:{type:String,default:"Start typing address... e.g., 123 Main Street"},description:{type:String,default:"Type to search for addresses in New Zealand"},required:{type:Boolean,default:!1},apiMethod:{type:String,default:"lodgeick.api.search_property_addresses"}},emits:["update:modelValue","address-selected"],setup(e,{expose:o,emit:s}){const p=e,h=s,c=b(""),g=b([]),v=b(!1),m=b(!1),a=b(p.modelValue),y=b("");let k=null;T(()=>p.modelValue,l=>{a.value=l,l&&(c.value=l.full_address||"")});const S=()=>_(this,null,function*(){k&&clearTimeout(k);const l=c.value.trim();if(y.value="",a.value&&l!==a.value.full_address&&(a.value=null,h("update:modelValue",null)),l.length<3){g.value=[];return}k=setTimeout(()=>_(this,null,function*(){v.value=!0;try{const r=yield M(l);g.value=r||[]}catch(r){console.error("[AddressLookup] Error searching addresses:",r),g.value=[],y.value="Error searching addresses. Please try again."}finally{v.value=!1}}),300)}),M=l=>_(this,null,function*(){try{return(yield I(p.apiMethod,{query:l})).map(t=>{var x,V,$,P,N;return{full_address:t.address||t.full_address,street_address:t.street_address||A(t.address),suburb:t.suburb||t.locality,city:t.city||t.town,postcode:t.postcode||t.postal_code,address_id:t.address_id||t.id,property_id:(x=t.property)==null?void 0:x.parcel_id,legal_description:(V=t.property)==null?void 0:V.legal_description,title_no:($=t.property)==null?void 0:$.title_no,valuation_reference:(P=t.property)==null?void 0:P.valuation_reference,zone:(N=t.property)==null?void 0:N.zone}})}catch(r){return console.error("[AddressLookup] API error:",r),[]}}),A=l=>{var r;return l?((r=l.split(",")[0])==null?void 0:r.trim())||l:""},B=l=>{a.value=l,c.value=l.full_address,g.value=[],m.value=!1,y.value="",h("update:modelValue",l),h("address-selected",l)},w=()=>{a.value=null,c.value="",g.value=[],y.value="",h("update:modelValue",null),h("address-selected",null)},q=()=>{setTimeout(()=>{m.value=!1},200)};return o({clearAddress:w,selectedAddress:a}),(l,r)=>(i(),d("div",W,[e.label?(i(),d("label",{key:0,for:e.id,class:"block text-sm font-medium text-gray-700 mb-2"},[Z(f(e.label)+" ",1),e.required?(i(),d("span",F,"*")):u("",!0)],8,j)):u("",!0),n("div",H,[C(n("input",{id:e.id,"onUpdate:modelValue":r[0]||(r[0]=t=>c.value=t),onInput:S,onFocus:r[1]||(r[1]=t=>m.value=!0),onBlur:q,type:"text",placeholder:e.placeholder,required:e.required,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",autocomplete:"off"},null,40,O),[[z,c.value]]),v.value?(i(),d("div",Q,[...r[2]||(r[2]=[n("svg",{class:"animate-spin h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):u("",!0)]),e.description?(i(),d("p",R,f(e.description),1)):u("",!0),y.value?(i(),d("p",U,f(y.value),1)):u("",!0),m.value&&(g.value.length>0||v.value)?(i(),d("div",G,[v.value?(i(),d("div",J,[...r[3]||(r[3]=[n("div",{class:"inline-block animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mb-2"},null,-1),n("p",{class:"text-sm"},"Searching addresses...",-1)])])):(i(),d("div",K,[(i(!0),d(E,null,L(g.value,(t,x)=>(i(),d("button",{key:x,onMousedown:D(V=>B(t),["prevent"]),type:"button",class:"w-full text-left px-4 py-3 hover:bg-blue-50 border-b border-gray-100 last:border-b-0 transition-colors"},[n("div",Y,f(t.full_address),1),t.suburb?(i(),d("div",ee,f(t.suburb)+", "+f(t.city),1)):u("",!0),t.address_id?(i(),d("div",te," ID: "+f(t.address_id),1)):u("",!0)],40,X))),128))])),!v.value&&g.value.length===0&&c.value.length>=3?(i(),d("div",se,[...r[4]||(r[4]=[n("p",{class:"text-sm"},"No addresses found. Try a different search.",-1),n("p",{class:"text-xs mt-2 text-gray-400"},"Make sure to include street number and name",-1)])])):u("",!0)])):u("",!0),a.value?(i(),d("div",re,[n("div",ae,[n("div",le,[r[5]||(r[5]=n("p",{class:"text-sm font-medium text-green-900"},"Selected Address",-1)),n("p",oe,f(a.value.full_address),1),a.value.suburb||a.value.city?(i(),d("div",de,[a.value.suburb?(i(),d("span",ie,f(a.value.suburb)+", ",1)):u("",!0),n("span",null,f(a.value.city),1),a.value.postcode?(i(),d("span",ne,f(a.value.postcode),1)):u("",!0)])):u("",!0)]),n("button",{onClick:w,type:"button",class:"text-green-600 hover:text-green-700 ml-2",title:"Clear selection"},[...r[6]||(r[6]=[n("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])])):u("",!0)]))}};function fe(e){if(!e||e.trim()==="")return{isValid:!1,message:"Phone number is required",formatted:""};const o=e.replace(/[\s\-()]/g,"");o.startsWith("+64")||o.startsWith("0064");let s=o;if(o.startsWith("+64")?s="0"+o.substring(3):o.startsWith("0064")&&(s="0"+o.substring(4)),!/^[0-9]+$/.test(s))return{isValid:!1,message:"Phone number should contain only numbers, spaces, hyphens, or parentheses",formatted:""};if(/^0(2[1278]|29)[0-9]{6,8}$/.test(s))return{isValid:!0,message:"",formatted:s.replace(/^(0\d{2})(\d{3})(\d{4})$/,"$1 $2 $3")};if(/^0[3-9][0-9]{7,8}$/.test(s)){if(s.length===9)return{isValid:!0,message:"",formatted:s.replace(/^(0\d)(\d{3})(\d{4})$/,"$1 $2 $3")};if(s.length===10)return{isValid:!0,message:"",formatted:s.replace(/^(0\d)(\d{3})(\d{5})$/,"$1 $2 $3")}}return s.length<9?{isValid:!1,message:"Phone number is too short. NZ phone numbers are 9-10 digits.",formatted:""}:s.length>11?{isValid:!1,message:"Phone number is too long. NZ phone numbers are 9-10 digits.",formatted:""}:{isValid:!1,message:"Invalid NZ phone number. Mobile numbers start with 02, landlines with 03-09.",formatted:""}}function ge(e){return!e||e.trim()===""?{isValid:!1,message:"Email address is required"}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?{isValid:!0,message:""}:{isValid:!1,message:"Please enter a valid email address"}}function ve(e){if(!e||e.trim()==="")return{isValid:!0,message:""};const o=e.replace(/[\s\-]/g,"");return/^\d{13}$/.test(o)?{isValid:!0,message:""}:{isValid:!1,message:"NZBN must be exactly 13 digits"}}function he(e){if(!e||e.trim()==="")return{isValid:!1,message:"Password is required",strength:"none"};if(e.length<8)return{isValid:!1,message:"Password must be at least 8 characters long",strength:"weak"};let o="weak",s=0;return e.length>=12&&s++,/[A-Z]/.test(e)&&s++,/[a-z]/.test(e)&&s++,/[0-9]/.test(e)&&s++,/[^A-Za-z0-9]/.test(e)&&s++,s>=4?o="strong":s>=2&&(o="medium"),{isValid:!0,message:"",strength:o}}export{me as _,fe as a,he as b,ve as c,ge as v};
//# sourceMappingURL=validation-B7P27oGy.js.map
