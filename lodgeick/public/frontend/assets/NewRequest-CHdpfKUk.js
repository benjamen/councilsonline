const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SaveDraftModal-BxMlgjJu.js","assets/index-BQMMZSFc.js","assets/index-QsMHYQ2P.css","assets/ValidationErrorModal-CVMXx7kf.js","assets/BookMeetingModal-NhpOoIgs.js","assets/SubmissionSuccessModal-DQ05xnm9.js","assets/SubmissionSuccessModal-ydH3POPv.css","assets/DynamicStepRenderer-CFE745Um.js","assets/request.service-DE2WoSa1.js","assets/RequestHeader-CTntYCNo.js","assets/DynamicStepRenderer-B3apwizs.css"])))=>i.map(i=>d[i]);
var Ce=Object.defineProperty,Te=Object.defineProperties;var De=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,$e=Object.prototype.propertyIsEnumerable;var ae=(e,s,i)=>s in e?Ce(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i,le=(e,s)=>{for(var i in s||(s={}))Re.call(s,i)&&ae(e,i,s[i]);if(ie)for(var i of ie(s))$e.call(s,i)&&ae(e,i,s[i]);return e},ue=(e,s)=>Te(e,De(s));var C=(e,s,i)=>new Promise((c,h)=>{var b=o=>{try{v(i.next(o))}catch(S){h(S)}},m=o=>{try{v(i.throw(o))}catch(S){h(S)}},v=o=>o.done?c(o.value):Promise.resolve(o.value).then(b,m);v((i=i.apply(e,s)).next())});import{r as A,j as w,q as fe,x as de,c as l,o as a,a as t,y as Ne,t as y,z as B,d as g,w as P,h as I,u as _,i as z,A as ce,F as U,l as J,B as j,f as pe,g as Y,s as Fe,e as Ae,C as Me,E as me,G as Pe,H as Ie,b as L,J as O,K as H}from"./index-BQMMZSFc.js";import{r as W}from"./request.service-DE2WoSa1.js";import{_ as Le}from"./RequestHeader-CTntYCNo.js";function je(e){return e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e):!0}function Ee(e){return e?/^[\+]?[(]?[0-9]{1,4}[)]?[-\s\.]?[(]?[0-9]{1,4}[)]?[-\s\.]?[0-9]{1,9}$/.test(e.replace(/\s/g,"")):!0}function Be(e){if(!e)return!0;try{return new URL(e),!0}catch(s){return!1}}function ze(e){return e===""||e===null||e===void 0?!0:!isNaN(Number.parseFloat(e))&&isFinite(e)}function Oe(e,s,i){let c=e.trim();c.startsWith("eval:")&&(c=c.substring(5).trim());try{return new Function("formData","value",`
			'use strict';
			try {
				return Boolean(${c});
			} catch (e) {
				console.warn('[Field Validation] Evaluation error:', e.message);
				return true; // Fail open on evaluation error
			}
		`)(i,s)}catch(h){return console.error("[Field Validation] Failed to evaluate expression:",e,h),!0}}function He(e,s,i={}){if(!s)return{valid:!0,message:""};switch(s.toLowerCase()){case"email":if(!je(e))return{valid:!1,message:"Please enter a valid email address"};break;case"phone":if(!Ee(e))return{valid:!1,message:"Please enter a valid phone number"};break;case"url":if(!Be(e))return{valid:!1,message:"Please enter a valid URL"};break;case"number":if(!ze(e))return{valid:!1,message:"Please enter a valid number"};break;default:if(s.startsWith("eval:")&&!Oe(s,e,i))return{valid:!1,message:"Validation failed"}}return{valid:!0,message:""}}function Q(e,s){if(!e||e.trim()==="")return!0;let i=e.trim();i.startsWith("eval:")&&(i=i.substring(5).trim());try{return new Function("formData","doc",`
      'use strict';
      try {
        return Boolean(${i});
      } catch (e) {
        console.warn('[Conditional Logic] Evaluation error:', e.message);
        return false;
      }
    `)(s,s)}catch(c){return console.error("[Conditional Logic] Failed to evaluate expression:",e,c),!0}}function Io(e,s){return!e||!e.is_enabled?!1:e.depends_on?Q(e.depends_on,s):!0}function Lo(e,s){return e?e.depends_on?Q(e.depends_on,s):!0:!1}function Ue(){const e=A({}),s=A(!1);function i(v,o,S,r={}){const d=He(o,S.validation,r);return d.valid?S.is_required&&(o===""||o===null||o===void 0)?(e.value[v]=`${S.field_label} is required`,!1):(delete e.value[v],!0):(e.value[v]=d.message,!1)}function c(v,o){return C(this,null,function*(){s.value=!0,e.value={};let S=!0;for(const r of v.sections||[])if(!(r.depends_on&&!h(r.depends_on,o)))for(const d of r.fields||[]){if(d.depends_on&&!h(d.depends_on,o))continue;let x=o[d.field_name];if(["barangay","municipality","province","city","region","zip_code","postal_code"].includes(d.field_name)&&!x){const p=o.address_line||o.street||o.residential_address||o.property_address;p&&typeof p=="object"&&(x=p[d.field_name])}i(d.field_name,x,d,o)||(S=!1)}return s.value=!1,S})}function h(v,o){try{return Q(v,o)}catch(S){return console.error("Error evaluating depends_on:",S),!0}}function b(){e.value={}}function m(v){delete e.value[v]}return{errors:e,isValidating:s,validateConfigField:i,validateStep:c,clearErrors:b,clearFieldError:m}}const k=A(null),K=A(!1),X=A(null);function Ye(){const e=()=>C(this,null,function*(){K.value=!0,X.value=null;try{const r={"Content-Type":"application/json"};window.csrf_token&&(r["X-Frappe-CSRF-Token"]=window.csrf_token);const x=yield(yield fetch("/api/method/lodgeick.api.get_user_profile",{method:"GET",headers:r,credentials:"include"})).json();if(x.message)return k.value=x.message,k.value;throw new Error("Failed to load profile")}catch(r){return X.value=r.message,console.error("Error loading user profile:",r),null}finally{K.value=!1}}),s=w(()=>{var r;return(r=k.value)!=null&&r.properties?k.value.properties.find(d=>d.is_default)||k.value.properties[0]:null}),i=w(()=>{var r;return(r=k.value)!=null&&r.councils?k.value.councils.find(d=>d.is_default)||k.value.councils[0]:null}),c=()=>{if(!k.value)return{};const r=k.value,d={};if(i.value&&(d.council=i.value.council_id,d.council_name=i.value.council_name),d.requester_name=r.full_name,d.requester_email=r.user,d.requester_phone=r.phone,d.requester_type=r.user_role,r.user_role==="Individual"&&r.postal_street&&(d.applicant_address=`${r.postal_street}, ${r.postal_suburb||""}, ${r.postal_city||""} ${r.postal_postcode||""}`.trim()),r.user_role==="Agent"&&(d.agent_required=!0,d.agent_id=r.user,d.agent_company=r.company_name,d.agent_email=r.business_email||r.user,d.agent_phone=r.business_phone||r.phone,r.business_street&&(d.agent_address=`${r.business_street}, ${r.business_suburb||""}, ${r.business_city||""} ${r.business_postcode||""}`.trim()),r.default_communication_route&&(d.correspondence_recipient=r.default_communication_route==="Agent Only"?"Agent":"Both"),r.default_invoice_recipient&&(d.invoice_responsible_party=r.default_invoice_recipient)),s.value){const x=s.value;d.property=`${x.street}, ${x.suburb||""}, ${x.city||""} ${x.postcode||""}`.trim(),d.property_address=d.property,d.property_legal_description=x.legal_description,d.ownership_status=x.ownership_status}return(r.comm_email||r.comm_phone||r.comm_post)&&(d.communication_preferences={email:r.comm_email||!1,phone:r.comm_phone||!1,post:r.comm_post||!1}),r.invoice_preference&&(d.invoice_delivery_method=r.invoice_preference),d},h=(r,d={})=>{const{overrideExisting:x=!1,fieldsToSkip:N=[]}=d,T=c();return Object.keys(T).forEach(p=>{N.includes(p)||!x&&r[p]||(r[p]=T[p])}),r},b=w(()=>{var r;return((r=k.value)==null?void 0:r.properties)||[]}),m=w(()=>{var r;return((r=k.value)==null?void 0:r.councils)||[]}),v=w(()=>{var r;return((r=k.value)==null?void 0:r.clients)||[]}),o=w(()=>{var x,N,T;if(!k.value)return!1;const r=k.value,d=r.full_name&&r.phone&&r.user_role;return r.user_role==="Individual"?d&&(((x=r.properties)==null?void 0:x.length)>0||!1)&&(((N=r.councils)==null?void 0:N.length)>0||!1):r.user_role==="Agent"?d&&r.company_name&&(((T=r.councils)==null?void 0:T.length)>0||!1):d}),S=w(()=>{if(!k.value)return 0;const r=k.value;let d=0,x=0;return["full_name","phone","user_role"].forEach(T=>{x++,r[T]&&d++}),x++,(r.comm_email||r.comm_phone||r.comm_post)&&d++,x++,r.properties&&r.properties.length>0&&d++,x++,r.councils&&r.councils.length>0&&d++,r.user_role==="Agent"?(x++,r.company_name&&d++):(x++,r.postal_street&&d++),Math.round(d/x*100)});return{userProfile:k,loading:K,error:X,loadUserProfile:e,getApplicationAutoFill:c,applyAutoFill:h,defaultProperty:s,defaultCouncil:i,getAllProperties:b,getAllCouncils:m,getAllClients:v,isProfileComplete:o,profileCompletionPercentage:S}}const Ge=fe("siteCouncil",{state:()=>({council:null,requestTypes:[],loading:!1,error:null,lastFetched:null}),getters:{councilData:e=>e.council,isLoaded:e=>!!e.council,availableRequestTypes:e=>e.requestTypes,branding:e=>{var s,i,c,h;return{primaryColor:((s=e.council)==null?void 0:s.primary_color)||"#0066CC",secondaryColor:((i=e.council)==null?void 0:i.secondary_color)||"#1E40AF",logo:(c=e.council)==null?void 0:c.logo,councilName:((h=e.council)==null?void 0:h.council_name)||"Council"}},meetingConfig:e=>{var s,i,c,h;return{defaultDuration:((s=e.council)==null?void 0:s.default_meeting_duration)||60,availableDurations:((c=(i=e.council)==null?void 0:i.available_meeting_durations)==null?void 0:c.split(",").map(b=>parseInt(b.trim())))||[30,60,90],bufferTime:((h=e.council)==null?void 0:h.meeting_buffer_time)||15}}},actions:{loadCouncil(e=!1){return C(this,null,function*(){const i=Date.now();if(!e&&this.council&&this.lastFetched&&i-this.lastFetched<3e5){console.log("[siteCouncil] Using cached council data");return}this.loading=!0,this.error=null;try{console.log("[siteCouncil] Fetching council data..."),this.council=yield de("lodgeick.api.get_council"),this.requestTypes=yield de("lodgeick.api.get_request_types"),this.lastFetched=i,console.log(`[siteCouncil] Loaded: ${this.council.council_name}`),console.log(`[siteCouncil] Request Types: ${this.requestTypes.length}`)}catch(c){throw console.error("[siteCouncil] Failed to load council data:",c),this.error=c.message||"Failed to load council data",c}finally{this.loading=!1}})},reload(){return C(this,null,function*(){return this.loadCouncil(!0)})},clearCache(){this.council=null,this.requestTypes=[],this.lastFetched=null,console.log("[siteCouncil] Cache cleared")}}}),We=fe("request",{persist:{key:"requestStore",storage:localStorage,paths:["currentRequestId","formData","currentStep","requestTypeCode"]},state:()=>({currentRequestId:null,requestTypeCode:null,requestTypeConfig:null,formData:{},currentStep:0,stepValidationStatus:{},isSaving:!1,isSubmitting:!1,lastSaved:null,error:null}),getters:{isFirstStep:e=>e.currentStep===0,totalSteps:e=>{var s;return(s=e.requestTypeConfig)!=null&&s.steps?e.requestTypeConfig.steps.length+3:3},isLastStep:e=>e.currentStep===e.totalSteps-1,currentStepConfig:e=>{var s,i;return(i=(s=e.requestTypeConfig)==null?void 0:s.steps)==null?void 0:i[e.currentStep]},canNavigateNext:e=>e.stepValidationStatus[e.currentStep]===!0,completionPercentage:e=>e.totalSteps===0?0:Math.round((e.currentStep+1)/e.totalSteps*100),hasUnsavedChanges:e=>e.lastSaved?new Date-e.lastSaved>3e4:Object.keys(e.formData).length>0},actions:{nextStep(){var c;const e=this.currentStep+1,s=this.totalSteps-1;if(e>s){console.error("[Store] Navigation beyond bounds prevented",{currentStep:this.currentStep,newStep:e,maxStep:s});return}if(e>=2&&e<s&&((c=this.requestTypeConfig)!=null&&c.steps)){const h=e-2;if(!this.requestTypeConfig.steps[h]){console.error("[Store] Missing step config, redirecting to review",{currentStep:this.currentStep,newStep:e,configIndex:h,totalConfigSteps:this.requestTypeConfig.steps.length}),this.currentStep=s;return}}this.currentStep=e},previousStep(){this.isFirstStep||this.currentStep--},goToStep(e){e>=0&&e<this.totalSteps&&(this.currentStep=e)},initialize(e,s=null){return C(this,null,function*(){try{this.requestTypeCode=e,this.error=null,console.log("[RequestStore] initialize called:",{requestTypeCode:e,draftId:s});const i=W.getRequestTypeConfig(e);yield new Promise(c=>{const h=setInterval(()=>{i.loading||(clearInterval(h),c())},100)}),this.requestTypeConfig=i.data,s&&(yield this.loadDraft(s))}catch(i){console.error("Failed to initialize request:",i),this.error=i.message||"Failed to load request type"}})},loadDraft(e){return C(this,null,function*(){try{const s=W.getRequest(e);yield new Promise(b=>{const m=setInterval(()=>{s.loading||(clearInterval(m),b())},100)});const i=s.data;if(this.currentRequestId=e,i.draft_full_data)try{this.formData=JSON.parse(i.draft_full_data)}catch(b){console.error("Failed to parse draft_full_data:",b),this.formData=i.form_data||{}}else this.formData=i.form_data||{};const c=i.draft_current_step||0,h=this.totalSteps-1;this.currentStep=Math.min(Math.max(0,c),h),c!==this.currentStep&&console.warn(`[RequestStore] Draft had invalid step ${c}, clamped to ${this.currentStep} (max: ${h})`)}catch(s){console.error("Failed to load draft:",s),this.error=s.message||"Failed to load draft"}})},saveProgress(){return C(this,null,function*(){if(this.isSaving){console.log("[RequestStore] Save already in progress, skipping");return}this.currentRequestId&&!this.formData.request_id&&(console.warn("[RequestStore] Syncing request_id to formData"),this.formData.request_id=this.currentRequestId),console.log("[RequestStore] saveProgress called",{hasRequestId:!!this.currentRequestId,formDataHasId:!!this.formData.request_id,currentStep:this.currentStep,isSaving:this.isSaving}),this.isSaving=!0,this.error=null;try{const e={};for(const[i,c]of Object.entries(this.formData)){if(c instanceof File){console.warn(`[RequestStore] Skipping File object for key: ${i}`);continue}if(Array.isArray(c)&&c.length>0&&c.some(b=>b&&typeof b=="object"&&b.file_url)){const b=c[0].file_url;if(b&&typeof b=="string"){console.log(`[RequestStore] Converting file array to URL string for ${i}:`,b),e[i]=b;continue}else{console.warn(`[RequestStore] File array for ${i} does not have valid file_url, skipping`);continue}}c!=null&&(e[i]=c)}if(Object.keys(e).length===0&&!this.currentRequestId)throw new Error("No form data to save. Please fill in at least one field.");console.log("[RequestStore] Sending sanitized data with",Object.keys(e).length,"fields"),console.log("[RequestStore] Sanitized data keys:",Object.keys(e)),console.log("[RequestStore] Sanitized data:",JSON.stringify(e,null,2));const s=yield W.createDraft(e,this.currentStep);return this.currentRequestId||(this.currentRequestId=s.request_id,this.formData.request_id=s.request_id,localStorage.setItem("current_draft_id",s.request_id)),this.lastSaved=new Date,s}catch(e){throw console.error("Save failed:",e),this.error=e.message||"Failed to save progress",e}finally{this.isSaving=!1}})},saveDraft(){return C(this,null,function*(){return this.saveProgress()})},submitRequest(){return C(this,null,function*(){this.isSubmitting=!0,this.error=null;try{this.currentRequestId||(yield this.saveProgress());const e=yield W.submitRequest(this.currentRequestId);return this.reset(),e}catch(e){throw console.error("Submit failed:",e),this.error=e.message||"Failed to submit request",e}finally{this.isSubmitting=!1}})},updateField(e,s){this.formData[e]=s},updateFields(e){Object.assign(this.formData,e)},setStepValidation(e,s){this.stepValidationStatus[e]=s},clearError(){this.error=null},reset(){console.log("[RequestStore] reset() called - clearing all state"),this.currentRequestId=null,this.requestTypeCode=null,this.requestTypeConfig=null,Object.keys(this.formData).forEach(e=>{delete this.formData[e]}),this.formData={},this.currentStep=0,this.stepValidationStatus={},this.isSaving=!1,this.isSubmitting=!1,this.lastSaved=null,this.error=null,localStorage.removeItem("current_draft_id")}}}),Je={class:"mb-8"},Ze={class:"relative mb-6"},Ke={class:"overflow-hidden h-2 text-xs flex rounded bg-gray-200"},Xe={class:"flex justify-between mt-2"},Qe={class:"text-sm font-medium text-gray-700"},et={class:"text-sm font-medium text-gray-700"},tt={__name:"RequestProgress",props:{currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0},stepTitles:{type:Array,default:()=>[]}},setup(e){const s=e,i=w(()=>s.totalSteps===0?0:Math.round((s.currentStep+1)/s.totalSteps*100));return(c,h)=>(a(),l("div",Je,[t("div",Ze,[t("div",Ke,[t("div",{style:Ne({width:i.value+"%"}),class:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-600 transition-all duration-500"},null,4)]),t("div",Xe,[t("span",Qe,y(e.stepTitles[e.currentStep]||`Step ${e.currentStep+1}`),1),t("span",et,y(i.value)+"% Complete ",1)])])]))}},st={class:"mt-8 pt-6 border-t border-gray-200"},ot={class:"flex items-center justify-between"},nt={class:"flex items-center space-x-3"},rt={__name:"StepNavigation",props:{currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0},isLastStep:{type:Boolean,default:!1},canGoNext:{type:Boolean,default:!0},canSaveDraft:{type:Boolean,default:!0},isSaving:{type:Boolean,default:!1},isSubmitting:{type:Boolean,default:!1}},emits:["next","previous","save-draft","submit"],setup(e,{emit:s}){const i=s,c=()=>{i("next")},h=()=>{i("previous")},b=()=>{i("save-draft")},m=()=>{i("submit")};return(v,o)=>(a(),l("div",st,[t("div",ot,[t("div",null,[e.currentStep>0?(a(),B(_(z),{key:0,onClick:h,variant:"outline",disabled:e.isSaving||e.isSubmitting},{prefix:P(()=>[...o[0]||(o[0]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),default:P(()=>[o[1]||(o[1]=I(" Previous ",-1))]),_:1},8,["disabled"])):g("",!0)]),t("div",nt,[e.canSaveDraft?(a(),B(_(z),{key:0,onClick:b,variant:"outline",loading:e.isSaving,disabled:e.isSubmitting},ce({default:P(()=>[I(" "+y(e.isSaving?"Saving...":"Save Draft"),1)]),_:2},[e.isSaving?void 0:{name:"prefix",fn:P(()=>[o[2]||(o[2]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})],-1))]),key:"0"}]),1032,["loading","disabled"])):g("",!0),e.isLastStep?(a(),B(_(z),{key:2,onClick:m,variant:"solid",theme:"green",loading:e.isSubmitting,disabled:!e.canGoNext||e.isSaving},ce({default:P(()=>[I(" "+y(e.isSubmitting?"Submitting...":"Submit Application"),1)]),_:2},[e.isSubmitting?void 0:{name:"prefix",fn:P(()=>[o[5]||(o[5]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1))]),key:"0"}]),1032,["loading","disabled"])):(a(),B(_(z),{key:1,onClick:c,variant:"solid",theme:"blue",disabled:!e.canGoNext||e.isSaving||e.isSubmitting},{suffix:P(()=>[...o[3]||(o[3]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])]),default:P(()=>[o[4]||(o[4]=I(" Next ",-1))]),_:1},8,["disabled"]))])]),o[6]||(o[6]=t("div",{class:"mt-4 text-center"},[t("p",{class:"text-sm text-gray-500"}," Your progress is automatically saved. You can return to complete this application later. ")],-1))]))}},it={key:0,class:"text-center py-12"},at={key:1,class:"grid md:grid-cols-2 gap-4"},lt=["onClick"],ut={class:"flex items-start justify-between"},dt={class:"flex-1"},ct={class:"text-lg font-semibold text-gray-900 mb-2"},mt=["innerHTML"],ft={class:"mt-4 flex items-center space-x-4 text-xs text-gray-500"},pt={key:0},gt={key:1},yt={key:2,class:"px-2 py-1 bg-gray-100 rounded"},vt={key:0,class:"ml-4"},ht={__name:"Step2RequestType",props:{modelValue:{type:Object,required:!0},requestTypes:{type:Object,required:!0}},emits:["update:modelValue","type-selected"],setup(e,{emit:s}){const i=e,c=s,h=b=>{console.log("[Step2RequestType] selectType called with:",b.name),console.log("[Step2RequestType] props.modelValue:",i.modelValue),console.log("[Step2RequestType] props.modelValue.council:",i.modelValue.council);const m=ue(le({},i.modelValue),{request_type:b.name});console.log("[Step2RequestType] Emitting updatedValue:",m),c("update:modelValue",m),c("type-selected",b.name)};return(b,m)=>(a(),l("div",null,[m[2]||(m[2]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Select Application Type",-1)),m[3]||(m[3]=t("p",{class:"text-gray-600 mb-8"},"Choose the type of consent you wish to apply for",-1)),e.requestTypes.loading?(a(),l("div",it,[...m[0]||(m[0]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)])])):(a(),l("div",at,[(a(!0),l(U,null,J(e.requestTypes.data,v=>(a(),l("div",{key:v.name,onClick:o=>h(v),class:j(["border-2 rounded-lg p-6 cursor-pointer transition-all hover:shadow-md",e.modelValue.request_type===v.name?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-300"])},[t("div",ut,[t("div",dt,[t("h3",ct,y(v.type_name),1),t("p",{class:"text-sm text-gray-600",innerHTML:v.description||"No description available"},null,8,mt),t("div",ft,[v.base_fee?(a(),l("span",pt,"Fee: $"+y(v.base_fee),1)):g("",!0),v.processing_sla_days?(a(),l("span",gt,y(v.processing_sla_days)+" days",1)):g("",!0),v.category?(a(),l("span",yt,y(v.category),1)):g("",!0)])]),e.modelValue.request_type===v.name?(a(),l("div",vt,[...m[1]||(m[1]=[t("div",{class:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center"},[t("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)])])):g("",!0)])],10,lt))),128))]))]))}},bt={class:"text-gray-600 mb-6"},xt={key:0,class:"space-y-6"},_t={class:"bg-white border border-gray-200 rounded-lg p-6"},wt={class:"flex items-start justify-between mb-4"},St={class:"text-xl font-semibold text-gray-900"},qt={key:0,class:"text-sm text-gray-500 mt-1"},kt={class:"grid md:grid-cols-3 gap-4 mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"},Vt={class:"text-2xl font-bold text-blue-900 mt-1"},Ct={class:"text-2xl font-bold text-blue-900 mt-1"},Tt={class:"text-2xl font-bold text-blue-900 mt-1"},Dt={key:0,class:"bg-white border border-gray-200 rounded-lg p-6"},Rt=["innerHTML"],$t={key:1,class:"bg-white border border-gray-200 rounded-lg p-6"},Nt=["innerHTML"],Ft={key:1,class:"text-center py-12"},At={__name:"Step3ProcessInfo",props:{requestTypeDetails:{type:Object,default:null},councilName:{type:String,default:""},modelValue:{type:Object,default:()=>({})}},emits:["continue","update:modelValue"],setup(e,{emit:s}){const i=pe(),c=s,h=()=>{if(!Fe.isLoggedIn){const b=window.location.pathname+window.location.search;i.push({name:"Login",query:{redirect:b}});return}c("continue")};return(b,m)=>(a(),l("div",null,[m[11]||(m[11]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Council Process Information",-1)),t("p",bt,"Understanding "+y(e.councilName)+"'s process for this application",1),e.requestTypeDetails?(a(),l("div",xt,[t("div",_t,[t("div",wt,[t("div",null,[t("h3",St,y(e.requestTypeDetails.request_type_name),1),e.requestTypeDetails.category?(a(),l("p",qt,y(e.requestTypeDetails.category),1)):g("",!0)])]),t("div",kt,[t("div",null,[m[0]||(m[0]=t("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Application Fee",-1)),t("div",Vt," $"+y(e.requestTypeDetails.base_fee||"0"),1),m[1]||(m[1]=t("div",{class:"text-xs text-blue-600 mt-1"},"Plus any additional costs",-1))]),t("div",null,[m[3]||(m[3]=t("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Processing Time",-1)),t("div",Ct,[I(y(e.requestTypeDetails.sla_days||"N/A")+" ",1),m[2]||(m[2]=t("span",{class:"text-base"},"days",-1))]),m[4]||(m[4]=t("div",{class:"text-xs text-blue-600 mt-1"},"Standard timeframe",-1))]),t("div",null,[m[5]||(m[5]=t("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Payment Required",-1)),t("div",Tt,y(e.requestTypeDetails.requires_payment?"Yes":"No"),1),m[6]||(m[6]=t("div",{class:"text-xs text-blue-600 mt-1"},"Before processing",-1))])])]),e.requestTypeDetails.process_description?(a(),l("div",Dt,[m[7]||(m[7]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"How This Works",-1)),t("div",{class:"prose prose-sm max-w-none text-gray-700",innerHTML:e.requestTypeDetails.process_description},null,8,Rt)])):e.requestTypeDetails.description?(a(),l("div",$t,[m[8]||(m[8]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"About This Application",-1)),t("div",{class:"prose prose-sm max-w-none text-gray-700",innerHTML:e.requestTypeDetails.description},null,8,Nt)])):g("",!0),m[9]||(m[9]=Y('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><div class="flex items-start"><svg class="w-5 h-5 text-yellow-600 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg><div><h5 class="font-semibold text-yellow-900 text-sm">Before You Continue</h5><p class="text-yellow-800 text-sm mt-1"> Please review this information carefully. Make sure you understand the process, fees, and timeframes before proceeding with your application. </p></div></div></div>',1)),t("div",{class:"flex justify-center pt-4"},[t("button",{type:"button",onClick:h,class:"px-8 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors"}," I Understand - Continue to Application ")])])):(a(),l("div",Ft,[...m[10]||(m[10]=[t("p",{class:"text-gray-500"},"No request type selected. Please go back and select a request type.",-1)])]))]))}},Mt={class:"px-4 sm:px-0"},Pt={class:"space-y-4 sm:space-y-6"},It={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 sm:p-6"},Lt={class:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-0"},jt={class:"text-base sm:text-lg font-semibold text-blue-900"},Et={class:"text-xs sm:text-sm text-blue-700 mt-1"},Bt={class:"sm:text-right"},zt={class:"text-xl sm:text-2xl font-bold text-blue-900"},Ot={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Ht={class:"p-4 sm:p-6 space-y-3"},Ut={class:"grid md:grid-cols-2 gap-4"},Yt={class:"font-medium"},Gt={class:"font-medium"},Wt={class:"font-medium"},Jt={key:0},Zt={class:"font-medium"},Kt={key:0,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Xt={class:"p-4 sm:p-6"},Qt={key:0,class:"space-y-2"},es={class:"font-medium"},ts={key:0},ss={class:"font-medium"},os={key:1,class:"text-gray-500"},ns={key:1,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},rs={class:"p-4 sm:p-6 space-y-3"},is={class:"font-medium"},as={class:"font-medium"},ls={class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},us={class:"font-semibold text-gray-900 text-sm sm:text-base"},ds={class:"p-4 sm:p-6 space-y-4"},cs={key:0,class:"text-sm font-medium text-gray-700 mb-2"},ms={class:"grid md:grid-cols-2 gap-4"},fs={class:"text-sm text-gray-500"},ps={class:"font-medium"},gs={key:0,class:"text-gray-500 text-sm"},ys={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},vs={class:"p-4 sm:p-6"},hs={class:"space-y-3"},bs={class:"mt-2 flex flex-wrap gap-2"},xs={key:0,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium"},_s={key:1,class:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},ws={key:2,class:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium"},Ss={key:3,class:"px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full text-sm font-medium"},qs={key:4,class:"px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-sm font-medium"},ks={key:5,class:"text-gray-500"},Vs={class:"mt-1 inline-flex items-center"},Cs={key:0},Ts={class:"font-medium break-words"},Ds={key:0,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Rs={class:"p-4 sm:p-6"},$s={class:"flex flex-wrap gap-2"},Ns={key:0,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Fs={key:1,class:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},As={key:2,class:"px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Ms={key:3,class:"px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Ps={key:1,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Is={class:"p-4 sm:p-6"},Ls={class:"space-y-3"},js={class:"font-medium"},Es={key:0},Bs={class:"text-sm mt-1 line-clamp-3"},zs={key:1},Os={class:"text-sm mt-1 line-clamp-3"},Hs={class:"flex items-center gap-2"},Us={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Ys={class:"p-4 sm:p-6"},Gs={class:"space-y-4"},Ws={key:0},Js=["innerHTML"],Zs={key:1},Ks=["innerHTML"],Xs={key:2},Qs={class:"text-sm mt-1 line-clamp-3"},eo={key:3},to={class:"text-sm mt-1 space-y-1 list-disc list-inside"},so={key:0},oo={key:1},no={key:2},ro={key:4},io=["innerHTML"],ao={key:5,class:"text-gray-500 text-sm"},lo={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},uo={class:"p-4 sm:p-6"},co={class:"space-y-2"},mo={class:"flex items-start gap-2"},fo={class:"flex items-start gap-2"},po={class:"flex items-start gap-2"},go={key:0,class:"mt-4 pt-4 border-t border-gray-200"},yo={class:"font-medium"},vo={key:0,class:"text-sm text-gray-500"},ho={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},bo={__name:"ReviewStep",props:{modelValue:{type:Object,required:!0},councilName:{type:String,default:"Council"},requestTypeName:{type:String,default:"Application"},applicationFee:{type:String,default:"TBD"},isResourceConsent:{type:Boolean,default:!1},stepConfigs:{type:Array,default:()=>[]},usesConfigurableSteps:{type:Boolean,default:!1},requestTypeDetails:{type:Object,default:null}},setup(e){const s=e,i=w(()=>!s.usesConfigurableSteps||!s.stepConfigs?[]:s.stepConfigs.filter(p=>p.show_on_review)),c=w(()=>s.isResourceConsent?!0:!!(s.modelValue.property||s.modelValue.property_address)),h=p=>{if(!p.sections)return!1;for(const n of p.sections)if(n.show_on_review){for(const D of n.fields)if(D.show_on_review&&s.modelValue[D.field_name])return!0}return!1},b=(p,n)=>{if(n==null||n==="")return"Not provided";if(p.field_type==="Check")return n?"Yes":"No";if(p.field_type==="Date"&&n)try{return new Date(n).toLocaleDateString("en-NZ",{year:"numeric",month:"long",day:"numeric"})}catch(D){return n}return p.field_type==="Currency"&&n?`₱${Number(n).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})}`:p.field_type==="Select"?n:p.field_type==="Attach"||p.field_type==="Attach Image"?n?"✓ File attached":"Not provided":n},m=w(()=>!!(s.modelValue.consent_type_land_use||s.modelValue.consent_type_subdivision||s.modelValue.consent_type_discharge||s.modelValue.consent_type_water||s.modelValue.consent_type_coastal)),v=w(()=>{const p=s.modelValue.activity_status_type;return p==="Permitted"?"bg-green-100 text-green-800":p==="Controlled"?"bg-blue-100 text-blue-800":p==="Restricted Discretionary"?"bg-yellow-100 text-yellow-800":p==="Discretionary"?"bg-orange-100 text-orange-800":p==="Non-Complying"?"bg-red-100 text-red-800":p==="Prohibited"?"bg-gray-800 text-white":"bg-gray-100 text-gray-800"}),o=w(()=>!!(s.modelValue.hazard_flooding||s.modelValue.hazard_earthquake||s.modelValue.hazard_landslip||s.modelValue.hazard_coastal)),S=w(()=>!!(s.modelValue.consultation_undertaken||s.modelValue.consultation_summary||s.modelValue.affected_parties_details||s.modelValue.written_approvals_obtained)),r=w(()=>!!(s.modelValue.activity_description||s.modelValue.aee_full_assessment||s.modelValue.positive_effects_description||s.modelValue.effects_visual_amenity||s.modelValue.effects_traffic_parking||s.modelValue.effects_noise||s.modelValue.mitigation_measures||s.modelValue.aee_activity_description||s.modelValue.aee_existing_environment||s.modelValue.assessment_of_effects||s.modelValue.aee_document)),d=p=>{if(!p)return"";const n=document.createElement("div");return n.innerHTML=p,n.textContent||n.innerText||""},x=(p,n)=>{if(!p)return"";const D=d(p);return D.length<=n?D:D.substring(0,n)+"..."},N=p=>{if(!p)return"";try{return new Date(p).toLocaleDateString("en-NZ",{year:"numeric",month:"long",day:"numeric"})}catch(n){return p}},T=w(()=>{const p=!!(s.modelValue.council&&s.modelValue.request_type&&s.modelValue.requester_name&&s.modelValue.requester_email&&s.modelValue.property_address&&s.modelValue.delivery_preference);if(s.isResourceConsent){const n=!!(m.value&&s.modelValue.activity_status_type&&s.modelValue.activity_description&&s.modelValue.aee_full_assessment&&s.modelValue.declaration_accuracy&&s.modelValue.declaration_authority&&s.modelValue.declaration_acknowledgment);return p&&n}return p});return(p,n)=>{var D;return a(),l("div",Mt,[n[39]||(n[39]=t("h2",{class:"text-xl sm:text-2xl font-bold text-gray-900 mb-2"},"Review & Submit",-1)),n[40]||(n[40]=t("p",{class:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8"},"Review your application details before submitting",-1)),t("div",Pt,[t("div",It,[t("div",Lt,[t("div",null,[t("h3",jt,y(e.requestTypeName),1),t("p",Et,y(e.councilName),1)]),t("div",Bt,[n[0]||(n[0]=t("div",{class:"text-xs sm:text-sm text-blue-600 font-medium"},"Application Fee",-1)),t("div",zt,y(e.applicationFee),1)])])]),t("div",Ot,[n[5]||(n[5]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Applicant Details")],-1)),t("div",Ht,[t("div",Ut,[t("div",null,[n[1]||(n[1]=t("span",{class:"text-sm text-gray-500"},"Name:",-1)),t("p",Yt,y(e.modelValue.requester_name||"Not provided"),1)]),t("div",null,[n[2]||(n[2]=t("span",{class:"text-sm text-gray-500"},"Email:",-1)),t("p",Gt,y(e.modelValue.requester_email||"Not provided"),1)]),t("div",null,[n[3]||(n[3]=t("span",{class:"text-sm text-gray-500"},"Phone:",-1)),t("p",Wt,y(e.modelValue.requester_phone||"Not provided"),1)]),e.modelValue.applicant_company?(a(),l("div",Jt,[n[4]||(n[4]=t("span",{class:"text-sm text-gray-500"},"Company:",-1)),t("p",Zt,y(e.modelValue.applicant_company),1)])):g("",!0)])])]),c.value?(a(),l("div",Kt,[n[8]||(n[8]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Property Details")],-1)),t("div",Xt,[e.modelValue.property_address?(a(),l("div",Qt,[t("div",null,[n[6]||(n[6]=t("span",{class:"text-sm text-gray-500"},"Address:",-1)),t("p",es,y(e.modelValue.property_address),1)]),e.modelValue.legal_description?(a(),l("div",ts,[n[7]||(n[7]=t("span",{class:"text-sm text-gray-500"},"Legal Description:",-1)),t("p",ss,y(e.modelValue.legal_description),1)])):g("",!0)])):(a(),l("p",os,"No property selected"))])])):g("",!0),(D=e.requestTypeDetails)!=null&&D.collect_payment?(a(),l("div",ns,[n[11]||(n[11]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Delivery & Payment")],-1)),t("div",rs,[t("div",null,[n[9]||(n[9]=t("span",{class:"text-sm text-gray-500"},"Delivery Preference:",-1)),t("p",is,y(e.modelValue.delivery_preference||"Not selected"),1)]),t("div",null,[n[10]||(n[10]=t("span",{class:"text-sm text-gray-500"},"Invoice To:",-1)),t("p",as,y(e.modelValue.invoice_to||"Not specified"),1)])])])):g("",!0),e.usesConfigurableSteps&&i.value.length>0?(a(!0),l(U,{key:2},J(i.value,E=>(a(),l("div",{key:E.step_code,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},[t("div",ls,[t("h3",us,y(E.step_title),1)]),t("div",ds,[(a(!0),l(U,null,J(E.sections.filter(R=>R.show_on_review),R=>(a(),l("div",{key:R.section_code},[R.section_title?(a(),l("h4",cs,y(R.section_title),1)):g("",!0),t("div",ms,[(a(!0),l(U,null,J(R.fields.filter(M=>M.show_on_review),M=>(a(),l("div",{key:M.field_name},[t("span",fs,y(M.review_label||M.field_label)+":",1),t("p",ps,y(b(M,e.modelValue[M.field_name])),1)]))),128))])]))),128)),h(E)?g("",!0):(a(),l("p",gs," No information to display for review "))])]))),128)):g("",!0),e.isResourceConsent?(a(),l(U,{key:3},[t("div",ys,[n[15]||(n[15]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Consent Types & Activity Status")],-1)),t("div",vs,[t("div",hs,[t("div",null,[n[12]||(n[12]=t("span",{class:"text-sm text-gray-500"},"Consent Types:",-1)),t("div",bs,[e.modelValue.consent_type_land_use?(a(),l("span",xs," Land Use Consent ")):g("",!0),e.modelValue.consent_type_subdivision?(a(),l("span",_s," Subdivision Consent ")):g("",!0),e.modelValue.consent_type_discharge?(a(),l("span",ws," Discharge Permit ")):g("",!0),e.modelValue.consent_type_water?(a(),l("span",Ss," Water Permit ")):g("",!0),e.modelValue.consent_type_coastal?(a(),l("span",qs," Coastal Permit ")):g("",!0),m.value?g("",!0):(a(),l("span",ks," None selected "))])]),t("div",null,[n[13]||(n[13]=t("span",{class:"text-sm text-gray-500"},"Activity Status:",-1)),t("div",Vs,[t("span",{class:j(["px-3 py-1 rounded-full text-sm font-medium",v.value])},y(e.modelValue.activity_status_type||"Not specified"),3)])]),e.modelValue.activity_title?(a(),l("div",Cs,[n[14]||(n[14]=t("span",{class:"text-sm text-gray-500"},"Activity Title:",-1)),t("p",Ts,y(e.modelValue.activity_title),1)])):g("",!0)])])]),o.value?(a(),l("div",Ds,[n[20]||(n[20]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Natural Hazards")],-1)),t("div",Rs,[t("div",$s,[e.modelValue.hazard_flooding?(a(),l("span",Ns,[...n[16]||(n[16]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707"})],-1),I(" Flood Hazard ",-1)])])):g("",!0),e.modelValue.hazard_earthquake?(a(),l("span",Fs,[...n[17]||(n[17]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),I(" Earthquake/Fault Line ",-1)])])):g("",!0),e.modelValue.hazard_landslip?(a(),l("span",As,[...n[18]||(n[18]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1),I(" Landslip/Slope Instability ",-1)])])):g("",!0),e.modelValue.hazard_coastal?(a(),l("span",Ms,[...n[19]||(n[19]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7l-2 1m2-1l-2-1m2 1v2.5M14 4l-2-1-2 1M4 7l2-1M4 7l2 1M4 7v2.5"})],-1),I(" Coastal Hazard ",-1)])])):g("",!0)])])])):g("",!0),S.value?(a(),l("div",Ps,[n[25]||(n[25]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Consultation & Affected Parties")],-1)),t("div",Is,[t("div",Ls,[t("div",null,[n[21]||(n[21]=t("span",{class:"text-sm text-gray-500"},"Consultation Undertaken:",-1)),t("p",js,y(e.modelValue.consultation_undertaken||"Not specified"),1)]),e.modelValue.consultation_summary?(a(),l("div",Es,[n[22]||(n[22]=t("span",{class:"text-sm text-gray-500"},"Consultation Summary:",-1)),t("p",Bs,y(e.modelValue.consultation_summary),1)])):g("",!0),e.modelValue.affected_parties_details?(a(),l("div",zs,[n[23]||(n[23]=t("span",{class:"text-sm text-gray-500"},"Affected Parties:",-1)),t("p",Os,y(d(e.modelValue.affected_parties_details)),1)])):g("",!0),t("div",Hs,[(a(),l("svg",{class:j(["w-5 h-5",e.modelValue.written_approvals_obtained?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...n[24]||(n[24]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:j(e.modelValue.written_approvals_obtained?"text-gray-900":"text-gray-500")}," Written Approvals "+y(e.modelValue.written_approvals_obtained?"Obtained":"Not Obtained"),3)])])])])):g("",!0),t("div",Us,[n[31]||(n[31]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Assessment of Environmental Effects")],-1)),t("div",Ys,[t("div",Gs,[e.modelValue.activity_description?(a(),l("div",Ws,[n[26]||(n[26]=t("span",{class:"text-sm text-gray-500"},"Activity Description:",-1)),t("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:e.modelValue.activity_description},null,8,Js)])):g("",!0),e.modelValue.aee_full_assessment?(a(),l("div",Zs,[n[27]||(n[27]=t("span",{class:"text-sm text-gray-500"},"Full Assessment:",-1)),t("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:e.modelValue.aee_full_assessment},null,8,Ks)])):g("",!0),e.modelValue.positive_effects_description?(a(),l("div",Xs,[n[28]||(n[28]=t("span",{class:"text-sm text-gray-500"},"Positive Effects:",-1)),t("p",Qs,y(e.modelValue.positive_effects_description),1)])):g("",!0),e.modelValue.effects_visual_amenity||e.modelValue.effects_traffic_parking||e.modelValue.effects_noise?(a(),l("div",eo,[n[29]||(n[29]=t("span",{class:"text-sm text-gray-500"},"Adverse Effects Summary:",-1)),t("ul",to,[e.modelValue.effects_visual_amenity?(a(),l("li",so,"Visual/Amenity: "+y(x(e.modelValue.effects_visual_amenity,50)),1)):g("",!0),e.modelValue.effects_traffic_parking?(a(),l("li",oo,"Traffic/Parking: "+y(x(e.modelValue.effects_traffic_parking,50)),1)):g("",!0),e.modelValue.effects_noise?(a(),l("li",no,"Noise: "+y(x(e.modelValue.effects_noise,50)),1)):g("",!0)])])):g("",!0),e.modelValue.mitigation_measures?(a(),l("div",ro,[n[30]||(n[30]=t("span",{class:"text-sm text-gray-500"},"Mitigation Measures:",-1)),t("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:e.modelValue.mitigation_measures},null,8,io)])):g("",!0),r.value?g("",!0):(a(),l("p",ao," AEE not yet completed "))])])]),t("div",lo,[n[36]||(n[36]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Statutory Declarations")],-1)),t("div",uo,[t("div",co,[t("div",mo,[(a(),l("svg",{class:j(["w-5 h-5 flex-shrink-0 mt-0.5",e.modelValue.declaration_accuracy||e.modelValue.declaration_rma_compliance?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...n[32]||(n[32]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:j(["text-sm",e.modelValue.declaration_accuracy||e.modelValue.declaration_rma_compliance?"text-gray-900":"text-gray-500"])}," Declaration of Accuracy & RMA Compliance ",2)]),t("div",fo,[(a(),l("svg",{class:j(["w-5 h-5 flex-shrink-0 mt-0.5",e.modelValue.declaration_authority||e.modelValue.declaration_authorized?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...n[33]||(n[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:j(["text-sm",e.modelValue.declaration_authority||e.modelValue.declaration_authorized?"text-gray-900":"text-gray-500"])}," Declaration of Authority to Apply ",2)]),t("div",po,[(a(),l("svg",{class:j(["w-5 h-5 flex-shrink-0 mt-0.5",e.modelValue.declaration_acknowledgment||e.modelValue.declaration_public_information?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...n[34]||(n[34]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:j(["text-sm",e.modelValue.declaration_acknowledgment||e.modelValue.declaration_public_information?"text-gray-900":"text-gray-500"])}," Public Information & Privacy Acknowledgment ",2)]),e.modelValue.requester_signature?(a(),l("div",go,[n[35]||(n[35]=t("span",{class:"text-sm text-gray-500"},"Signed by:",-1)),t("p",yo,y(e.modelValue.requester_signature),1),e.modelValue.signature_date?(a(),l("p",vo," Date: "+y(N(e.modelValue.signature_date)),1)):g("",!0)])):g("",!0)])])])],64)):g("",!0),n[38]||(n[38]=Y('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 sm:p-6" data-v-889f31e6><div class="flex items-start gap-2 sm:gap-3" data-v-889f31e6><svg class="w-5 h-5 sm:w-6 sm:h-6 text-yellow-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-889f31e6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-889f31e6></path></svg><div data-v-889f31e6><h4 class="font-semibold text-yellow-900 text-sm sm:text-base" data-v-889f31e6>Before You Submit</h4><ul class="mt-2 text-xs sm:text-sm text-yellow-800 space-y-1 list-disc list-inside" data-v-889f31e6><li data-v-889f31e6>Review all information carefully for accuracy and completeness</li><li data-v-889f31e6>Ensure all required fields are completed</li><li data-v-889f31e6>For Resource Consent applications, verify all statutory declarations are confirmed</li><li data-v-889f31e6>Once submitted, you cannot edit the application (you may need to withdraw and resubmit)</li></ul></div></div></div>',1)),T.value?g("",!0):(a(),l("div",ho,[...n[37]||(n[37]=[Y('<div class="flex items-start gap-2 sm:gap-3" data-v-889f31e6><svg class="w-5 h-5 text-red-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-889f31e6><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-889f31e6></path></svg><div data-v-889f31e6><h5 class="font-semibold text-red-900 text-xs sm:text-sm" data-v-889f31e6>Application Incomplete</h5><p class="text-red-800 text-xs sm:text-sm mt-1" data-v-889f31e6> Please complete all required sections before submitting. Use the Previous button to go back and fill in missing information. </p></div></div>',1)])]))])])}}},xo=Ae(bo,[["__scopeId","data-v-889f31e6"]]),_o={class:"min-h-screen bg-gray-50"},wo={class:"bg-white border-b border-gray-200"},So={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},qo={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ko={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},Vo={key:0},Co={key:1},To={key:2},Do={key:4,class:"text-center py-12"},Ro={class:"flex gap-3 justify-center"},$o={key:0,class:"mt-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6 shadow-sm"},No={__name:"NewRequest",setup(e){const s=O(()=>H(()=>import("./SaveDraftModal-BxMlgjJu.js"),__vite__mapDeps([0,1,2]))),i=O(()=>H(()=>import("./ValidationErrorModal-CVMXx7kf.js"),__vite__mapDeps([3,1,2]))),c=O(()=>H(()=>import("./BookMeetingModal-NhpOoIgs.js"),__vite__mapDeps([4,1,2]))),h=O(()=>H(()=>import("./SubmissionSuccessModal-DQ05xnm9.js"),__vite__mapDeps([5,1,2,6]))),b=O(()=>H(()=>import("./DynamicStepRenderer-CFE745Um.js"),__vite__mapDeps([7,1,2,8,9,10]))),m=Me(),v=pe(),o=We(),S=Ge(),{errors:r,validateStep:d}=Ue(),x=A(!1),N=A(!1),T=A(!1),p=A(!1),n=A(null),D=A({loading:!1,data:[]}),E=A(null),R=w(()=>{var u;return(u=o.requestTypeConfig)!=null&&u.steps?o.requestTypeConfig.steps.length+3:3}),M=w(()=>{var f;const u=["Type","Process Info"];return(f=o.requestTypeConfig)!=null&&f.steps&&u.push(...o.requestTypeConfig.steps.map(V=>V.step_title)),u.push("Review"),u}),G=w(()=>{var u;return((u=o.requestTypeConfig)==null?void 0:u.steps)&&o.requestTypeConfig.steps.length>0}),ge=w(()=>!0),Z=w(()=>o.currentStep>=2),ee=w(()=>{var f;if(!((f=o.requestTypeConfig)!=null&&f.steps))return null;const u=o.currentStep-2;return u>=0&&u<o.requestTypeConfig.steps.length?o.requestTypeConfig.steps[u]:null}),ye=w(()=>{var u;return o.currentStep>1&&o.currentStep<R.value-1&&((u=o.requestTypeConfig)==null?void 0:u.council_meeting_available)===1});function ve(){T.value=!0}function he(u){console.log("Meeting booked:",u)}function te(){const u=o.currentStep;return u>=0&&u<M.value.length?M.value[u]:""}function se(){var V;const u=o.currentStep,f=2;if(u<f||u>=R.value-1)return null;if((V=o.requestTypeConfig)!=null&&V.steps){const $=u-f;if($>=0&&$<o.requestTypeConfig.steps.length)return o.requestTypeConfig.steps[$]}return null}function be(){var u;return((u=S.councilData)==null?void 0:u.council_name)||"Council"}function xe(){return C(this,null,function*(){D.value.loading=!0,yield S.loadCouncil(),D.value={loading:!1,data:S.availableRequestTypes||[]}})}function _e(u){return C(this,null,function*(){if(o.updateField("request_type",u),yield o.initialize(u),E.value=o.requestTypeConfig,!o.requestTypeConfig){console.error("[NewRequest] Failed to load request type config");return}})}function oe(){return C(this,null,function*(){var u;if(o.currentStep===0&&!o.formData.request_type){alert("Please select a request type before continuing.");return}if(o.currentStep>=1&&G.value&&ee.value&&!(yield d(ee.value,o.formData))){console.error("[NewRequest] Validation failed:",r.value),N.value=!0;return}if(o.currentStep===1&&!o.currentRequestId){if(console.log("[NewRequest] Auto-saving draft after Process Info step..."),console.log("[NewRequest] requestTypeConfig:",o.requestTypeConfig),console.log("[NewRequest] usesConfigurableSteps:",G.value),console.log("[NewRequest] config steps:",(u=o.requestTypeConfig)==null?void 0:u.steps),yield o.saveDraft(),console.log("[NewRequest] Draft saved with ID:",o.currentRequestId),G.value)console.log("[NewRequest] Dynamic steps configured, continuing to next step...");else if(o.currentRequestId){console.log("[NewRequest] No dynamic steps configured, redirecting to detail page..."),v.push(`/request/${o.currentRequestId}`);return}}o.currentRequestId&&(yield o.saveProgress()),o.currentStep<R.value-1&&o.nextStep()})}function ne(){o.previousStep()}function re(){return C(this,null,function*(){try{yield o.saveDraft(),o.currentRequestId?v.push(`/request/${o.currentRequestId}`):x.value=!0}catch(u){console.error("Failed to save draft:",u)}})}function we(){return C(this,null,function*(){try{yield o.saveDraft(),o.reset(),v.push({name:"Dashboard"})}catch(u){console.error("Failed to save draft:",u)}})}function Se(){return C(this,null,function*(){try{const u=yield o.submitRequest();n.value=u,p.value=!0}catch(u){console.error("Failed to submit request:",u)}})}function qe(){o.reset(),v.push("/dashboard")}function ke(u){p.value=!1,v.push(`/request/${u}`)}function Ve(){p.value=!1;const u=o.formData.council;u?v.push(`/council/${u}/dashboard`):v.push("/dashboard")}return me(()=>o.currentStep,()=>{},{immediate:!0}),me(()=>o.formData.birth_date,u=>{var f;if(u&&((f=o.formData.request_type)!=null&&f.includes("SPISC"))){const V=new Date,$=new Date(u);let F=V.getFullYear()-$.getFullYear();const q=V.getMonth()-$.getMonth();(q<0||q===0&&V.getDate()<$.getDate())&&F--,o.updateField("age",F),F<60?r.value.birth_date="Applicant must be 60 years or older for SPISC":delete r.value.birth_date}}),Pe(()=>C(this,null,function*(){const u=m.query.type,f=m.query.draft;if(console.log("[NewRequest] Initialization - type:",u,"draft:",f),!f&&!m.query.draft&&o.reset(),!f){const{getApplicationAutoFill:V,applyAutoFill:$}=Ye();try{yield V(),$(o.formData,{overrideExisting:!1})}catch(F){console.warn("[NewRequest] Failed to load user profile for auto-fill:",F)}}if(f&&u){yield o.initialize(u,f),E.value=o.requestTypeConfig;return}yield xe(),u&&!f&&(console.log("[NewRequest] Request type provided in URL:",u),yield o.initialize(u),E.value=o.requestTypeConfig,o.updateField("request_type",u),o.currentStep=1,console.log("[NewRequest] Advanced to step 1 (Process Info)"))})),Ie((u,f,V)=>{if(o.isSubmitting||!o.currentRequestId){o.reset(),V();return}o.formData&&Object.keys(o.formData).some(F=>o.formData[F]!==void 0&&o.formData[F]!==null&&o.formData[F]!=="")&&!confirm("You have unsaved changes. Do you want to leave without saving?")?V(!1):(u.path.includes("/request/")||o.reset(),V())}),(u,f)=>{var V,$,F;return a(),l("div",_o,[L(Le,{title:"New Application",onBack:qe},{actions:P(()=>[Z.value?(a(),B(_(z),{key:0,onClick:re,variant:"outline",theme:"gray",loading:_(o).isSaving},{default:P(()=>[...f[10]||(f[10]=[I(" Save Draft ",-1)])]),_:1},8,["loading"])):g("",!0),Z.value?(a(),B(_(z),{key:1,onClick:we,variant:"outline",theme:"gray",loading:_(o).isSaving},{default:P(()=>[...f[11]||(f[11]=[I(" Save and Close ",-1)])]),_:1},8,["loading"])):g("",!0)]),_:1}),t("div",wo,[t("div",So,[L(tt,{"current-step":_(o).currentStep,"total-steps":R.value,"step-titles":M.value},null,8,["current-step","total-steps","step-titles"])])]),t("main",qo,[t("div",ko,[te()==="Type"?(a(),l("div",Vo,[L(ht,{modelValue:_(o).formData,"onUpdate:modelValue":f[0]||(f[0]=q=>_(o).formData=q),"request-types":D.value,onTypeSelected:_e},null,8,["modelValue","request-types"])])):te()==="Process Info"?(a(),l("div",Co,[L(At,{"request-type-details":E.value,"council-name":be(),modelValue:_(o).formData,"onUpdate:modelValue":f[1]||(f[1]=q=>_(o).formData=q),onContinue:oe},null,8,["request-type-details","council-name","modelValue"])])):_(o).currentStep>=R.value-1?(a(),l("div",To,[L(xo,{modelValue:_(o).formData,"onUpdate:modelValue":f[2]||(f[2]=q=>_(o).formData=q),"request-type-config":_(o).requestTypeConfig},null,8,["modelValue","request-type-config"])])):G.value&&se()?(a(),B(_(b),{key:3,stepConfig:se(),modelValue:_(o).formData,"onUpdate:modelValue":f[3]||(f[3]=q=>_(o).formData=q)},null,8,["stepConfig","modelValue"])):(a(),l("div",Do,[f[12]||(f[12]=Y('<div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4"><svg class="h-8 w-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">Unable to Load This Step</h3><p class="text-sm text-gray-600 mb-6"> We&#39;re having trouble loading this step. Please try refreshing or go back to continue your application. </p>',3)),t("div",Ro,[t("button",{onClick:f[4]||(f[4]=q=>u.location.reload()),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"}," Refresh Page "),t("button",{onClick:ne,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition"}," Go Back "),t("button",{onClick:f[5]||(f[5]=q=>_(v).push("/dashboard")),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition"}," Return to Dashboard ")])]))]),ye.value?(a(),l("div",$o,[t("div",{class:"flex items-start justify-between"},[t("div",{class:"flex-1"},[f[13]||(f[13]=Y('<div class="flex items-center gap-2 mb-2"><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><h3 class="text-lg font-semibold text-gray-900">Council Meeting Available</h3></div><p class="text-sm text-gray-700 mb-3"> Schedule a meeting with council planners to discuss your application before submitting. This optional step can help clarify requirements and improve your application. </p>',2)),t("button",{onClick:ve,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium"}," Request Council Meeting ")])])])):g("",!0),L(rt,{"current-step":_(o).currentStep,"total-steps":R.value,"is-last-step":_(o).isLastStep,"can-go-next":ge.value,"can-save-draft":Z.value,"is-saving":_(o).isSaving,"is-submitting":_(o).isSubmitting,onNext:oe,onPrevious:ne,onSaveDraft:re,onSubmit:Se},null,8,["current-step","total-steps","is-last-step","can-go-next","can-save-draft","is-saving","is-submitting"])]),L(_(s),{show:x.value,"onUpdate:show":f[6]||(f[6]=q=>x.value=q),"draft-id":_(o).currentRequestId},null,8,["show","draft-id"]),L(_(i),{show:N.value,"onUpdate:show":f[7]||(f[7]=q=>N.value=q),errors:_(r)},null,8,["show","errors"]),L(_(c),{show:T.value,"onUpdate:show":f[8]||(f[8]=q=>T.value=q),"request-id":_(o).currentRequestId,"request-type-code":_(o).formData.request_type,"council-code":_(o).formData.council,onBooked:he},null,8,["show","request-id","request-type-code","council-code"]),L(_(h),{open:p.value,"request-number":(V=n.value)==null?void 0:V.request_number,"request-id":($=n.value)==null?void 0:$.request_id,"sla-info":(F=n.value)==null?void 0:F.sla_info,onClose:f[9]||(f[9]=q=>p.value=!1),onViewRequest:ke,onGoToDashboard:Ve},null,8,["open","request-number","request-id","sla-info"])])}}},jo=Object.freeze(Object.defineProperty({__proto__:null,default:No},Symbol.toStringTag,{value:"Module"}));export{jo as N,Ue as a,Io as b,Lo as i,Ye as u};
//# sourceMappingURL=NewRequest-CHdpfKUk.js.map
