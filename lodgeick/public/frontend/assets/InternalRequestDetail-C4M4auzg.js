import{a as V,m as H,h as u}from"./frappe-ui-DjR51muK.js";import{a5 as L,aq as z,B as k,c as f,a as r,o as n,R as c,e as y,P as i,O as C,u as s,a2 as m,b as t,t as o,n as b,F as A,W as S,aj as U,Q as E}from"./vue-vendor-B0shnPjy.js";import{_ as Q}from"./StatusBadge-BSS5uEy_.js";import{_ as W}from"./RequestHeader-CFcOgVuT.js";import{u as G}from"./useStatutoryClock--LlLn5es.js";import"./ui-components-BkacYXVN.js";const Z={class:"min-h-screen bg-gray-50"},K={key:0,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 text-center"},X={key:1,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Y={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},tt={class:"lg:col-span-2 space-y-6"},et={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},st={class:"grid grid-cols-2 gap-4"},ot={class:"mt-1 text-sm font-medium text-gray-900"},at={class:"text-xs text-gray-500"},lt={class:"mt-1 text-sm font-medium text-gray-900"},nt={class:"mt-1 text-sm font-medium text-gray-900"},it={class:"mt-4 pt-4 border-t border-gray-200"},rt={class:"text-sm text-gray-900"},dt={class:"bg-white rounded-lg shadow-sm border border-gray-200"},ct={class:"p-6 border-b border-gray-200 flex justify-between items-center"},ut={class:"p-6"},mt={class:"space-y-4"},gt=["checked"],pt={class:"flex-1"},xt={class:"text-sm font-medium text-gray-900"},yt={class:"mt-1 flex items-center space-x-4 text-xs text-gray-500"},ft={key:0},bt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},_t={class:"space-y-3"},vt={class:"flex justify-between items-center"},ht={class:"text-sm font-medium text-gray-900"},wt={class:"flex justify-between items-center"},kt={class:"text-sm font-medium text-gray-900"},Ct={class:"flex justify-between items-center"},At={class:"text-sm text-gray-600"},St={class:"text-sm font-medium text-gray-900"},Rt={class:"pt-3 border-t border-gray-200 flex justify-between items-center"},Dt={class:"text-base font-bold text-green-600"},jt={class:"space-y-6"},qt={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Tt={key:0,class:"mb-6"},$t={class:"flex items-center justify-between mb-2"},Bt={class:"text-xs text-gray-600"},Ft={class:"w-full bg-gray-200 rounded-full h-2"},Nt={class:"mt-2 text-xs text-gray-500"},It={class:"space-y-3"},Mt={class:"flex-1 min-w-0"},Pt={class:"text-sm font-medium text-gray-900"},Jt={class:"text-xs text-gray-500"},Ot={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Vt={class:"space-y-2"},Gt={__name:"InternalRequestDetail",setup(Ht){const R=L(),D=z(),a=V({url:"frappe.client.get",params:{doctype:"Request",name:D.params.id},auto:!0}),{clockData:g,progressPercent:j,isOverdue:_}=G(a),v=k([{id:1,title:"Review application documents",assignee:"John Smith",hours:2,cost:300,completed:!0},{id:2,title:"Site inspection",assignee:"Jane Doe",hours:4,cost:600,completed:!1},{id:3,title:"Prepare decision report",assignee:"John Smith",hours:3,cost:450,completed:!1}]),q=k([{title:"Application Submitted",date:"10 Oct 2025",color:"bg-blue-500"},{title:"Assigned to John Smith",date:"11 Oct 2025",color:"bg-green-500"},{title:"Under Review",date:"12 Oct 2025",color:"bg-yellow-500"}]),h=f(()=>v.value.reduce((d,e)=>d+e.hours,0)),w=f(()=>h.value*150),T=f(()=>{var p,x;const d=Number.parseFloat(((p=a.data)==null?void 0:p.application_fee)||0),e=Number.parseFloat(((x=a.data)==null?void 0:x.additional_charges)||0);return d+e+w.value}),$=()=>{R.push({name:"InternalRequestManagement"})},B=d=>d?new Date(d).toLocaleDateString("en-NZ",{day:"numeric",month:"short",year:"numeric"}):"N/A",F=()=>{console.log("Add task")},N=()=>{console.log("Add charge")},I=()=>{console.log("Issue RFI")},M=()=>{console.log("Approve request")},P=()=>{console.log("Decline request")},J=[{label:"Send Message",onClick:()=>console.log("Message")},{label:"Generate Report",onClick:()=>console.log("Report")},{label:"View History",onClick:()=>console.log("History")}];return(d,e)=>{var p,x;return n(),r("div",Z,[c(W,{title:(p=s(a).data)==null?void 0:p.request_number,subtitle:(x=s(a).data)==null?void 0:x.request_type,loading:s(a).loading,onBack:$},{actions:i(()=>[s(a).data?(n(),C(Q,{key:0,status:s(a).data.workflow_state},null,8,["status"])):y("",!0),s(a).data?(n(),C(s(H),{key:1,options:J},{default:i(({open:l})=>[c(s(u),{variant:"outline",theme:"gray"},{suffix:i(()=>[...e[0]||(e[0]=[t("svg",{class:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1)])]),default:i(()=>[e[1]||(e[1]=m(" Actions ",-1))]),_:1})]),_:1})):y("",!0)]),_:1},8,["title","subtitle","loading"]),s(a).loading?(n(),r("div",K,[...e[2]||(e[2]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"},null,-1)])])):s(a).data?(n(),r("div",X,[t("div",Y,[t("div",tt,[t("div",et,[e[8]||(e[8]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Request Details",-1)),t("dl",st,[t("div",null,[e[3]||(e[3]=t("dt",{class:"text-sm text-gray-600"},"Applicant",-1)),t("dd",ot,o(s(a).data.requester_name),1),t("dd",at,o(s(a).data.requester_email),1)]),t("div",null,[e[4]||(e[4]=t("dt",{class:"text-sm text-gray-600"},"Property",-1)),t("dd",lt,o(s(a).data.property_address),1)]),t("div",null,[e[5]||(e[5]=t("dt",{class:"text-sm text-gray-600"},"Submitted",-1)),t("dd",nt,o(B(s(a).data.submitted_date)),1)]),t("div",null,[e[6]||(e[6]=t("dt",{class:"text-sm text-gray-600"},"Days Elapsed",-1)),t("dd",{class:b(["mt-1 text-sm font-medium",s(_)?"text-red-600":"text-gray-900"])},o(s(g).working_days_elapsed)+" days ",3)])]),t("div",it,[e[7]||(e[7]=t("dt",{class:"text-sm text-gray-600 mb-2"},"Description",-1)),t("dd",rt,o(s(a).data.brief_description),1)])]),t("div",dt,[t("div",ct,[e[11]||(e[11]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Tasks & Work",-1)),c(s(u),{onClick:F,variant:"solid",theme:"green",size:"sm"},{prefix:i(()=>[...e[9]||(e[9]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:i(()=>[e[10]||(e[10]=m(" Add Task ",-1))]),_:1})]),t("div",ut,[t("div",mt,[(n(!0),r(A,null,S(v.value,l=>(n(),r("div",{key:l.id,class:"flex items-start space-x-3 p-4 bg-gray-50 rounded-lg"},[t("input",{type:"checkbox",checked:l.completed,class:"mt-1 h-5 w-5 text-green-600 rounded"},null,8,gt),t("div",pt,[t("h4",xt,o(l.title),1),t("div",yt,[t("span",null,o(l.assignee),1),t("span",null,o(l.hours)+"h",1),l.cost?(n(),r("span",ft,"$"+o(l.cost),1)):y("",!0)])])]))),128))])])]),t("div",bt,[e[16]||(e[16]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Costing Summary",-1)),t("div",_t,[t("div",vt,[e[12]||(e[12]=t("span",{class:"text-sm text-gray-600"},"Application Fee",-1)),t("span",ht,"$"+o(s(a).data.application_fee||0),1)]),t("div",wt,[e[13]||(e[13]=t("span",{class:"text-sm text-gray-600"},"Additional Charges",-1)),t("span",kt,"$"+o(s(a).data.additional_charges||0),1)]),t("div",Ct,[t("span",At,"Staff Time ("+o(h.value)+"h @ $150/h)",1),t("span",St,"$"+o(w.value),1)]),t("div",Rt,[e[14]||(e[14]=t("span",{class:"text-base font-semibold text-gray-900"},"Total Cost",-1)),t("span",Dt,"$"+o(T.value),1)])]),c(s(u),{onClick:N,variant:"outline",theme:"green",class:"w-full mt-4"},{default:i(()=>[...e[15]||(e[15]=[m(" Add Additional Charge ",-1)])]),_:1})])]),t("div",jt,[e[24]||(e[24]=U('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6"><h3 class="text-sm font-semibold text-gray-900 mb-4">Assignment</h3><div class="space-y-3"><div><label class="block text-xs font-medium text-gray-700 mb-2">Assigned To</label><select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"><option value="">Unassigned</option><option value="planner1">John Smith (Planner)</option><option value="planner2">Jane Doe (Planner)</option></select></div><div><label class="block text-xs font-medium text-gray-700 mb-2">Priority</label><select class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm"><option value="low">Low</option><option value="medium">Medium</option><option value="high">High</option><option value="urgent">Urgent</option></select></div></div></div>',1)),t("div",qt,[e[19]||(e[19]=t("h3",{class:"text-sm font-semibold text-gray-900 mb-4"},"Timeline",-1)),s(g).statutory_clock_started?(n(),r("div",Tt,[t("div",$t,[e[17]||(e[17]=t("span",{class:"text-xs font-medium text-gray-700"},"SLA / Statutory Clock",-1)),t("span",Bt,o(s(g).working_days_elapsed)+" / "+o(s(a).data.statutory_timeframe||20)+" days ",1)]),t("div",Ft,[t("div",{class:b(["h-2 rounded-full transition-all",s(_)?"bg-red-600":"bg-green-600"]),style:E({width:`${s(j)}%`})},null,6)]),t("p",Nt,o(s(g).working_days_remaining)+" days remaining "+o(s(g).statutory_clock_stopped?"(Clock stopped)":""),1)])):y("",!0),t("div",It,[(n(!0),r(A,null,S(q.value,(l,O)=>(n(),r("div",{key:O,class:"flex items-start space-x-3"},[t("div",{class:b(["flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center",l.color])},[...e[18]||(e[18]=[t("div",{class:"w-2 h-2 rounded-full bg-white"},null,-1)])],2),t("div",Mt,[t("p",Pt,o(l.title),1),t("p",Jt,o(l.date),1)])]))),128))])]),t("div",Ot,[e[23]||(e[23]=t("h3",{class:"text-sm font-semibold text-gray-900 mb-4"},"Quick Actions",-1)),t("div",Vt,[c(s(u),{onClick:I,variant:"outline",theme:"orange",class:"w-full justify-center"},{default:i(()=>[...e[20]||(e[20]=[m(" Issue RFI ",-1)])]),_:1}),c(s(u),{onClick:M,variant:"outline",theme:"green",class:"w-full justify-center"},{default:i(()=>[...e[21]||(e[21]=[m(" Approve ",-1)])]),_:1}),c(s(u),{onClick:P,variant:"outline",theme:"red",class:"w-full justify-center"},{default:i(()=>[...e[22]||(e[22]=[m(" Decline ",-1)])]),_:1})])])])])])):y("",!0)])}}};export{Gt as default};
//# sourceMappingURL=InternalRequestDetail-C4M4auzg.js.map
