var p=(n,f,d)=>new Promise((c,s)=>{var o=r=>{try{u(d.next(r))}catch(v){s(v)}},i=r=>{try{u(d.throw(r))}catch(v){s(v)}},u=r=>r.done?c(r.value):Promise.resolve(r.value).then(o,i);u((d=d.apply(n,f)).next())});import{B as y,c as A,O as D,o as x,P as b,R as k,u as w,a2 as q,t as m,b as e,a as C,e as P,n as h,a6 as N,av as V}from"./vue-vendor-D9RCx05D.js";import{c as $,i as I,D as E}from"./frappe-ui-E4oUKPDc.js";import"./ui-components-88qJBhde.js";const M={class:"space-y-6"},R={class:"bg-gray-50 rounded-lg p-4 border border-gray-200"},F={class:"flex justify-between items-center mb-2"},G={class:"text-2xl font-bold text-gray-900"},T={class:"text-sm text-gray-600 flex justify-between"},j={class:"flex items-start gap-3"},z={class:"flex items-start gap-3"},O={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-3"},U={class:"flex gap-2"},_={class:"text-sm text-red-800"},L={__name:"PaymentModal",props:{show:Boolean,requestId:String,totalAmount:Number,feesExclGst:Number,gst:Number,stripeEnabled:{type:Boolean,default:!1}},emits:["update:show","invoice-requested","payment-initiated"],setup(n,{emit:f}){const d=n,c=f,s=y("invoice"),o=y(!1),i=y(null),u=A({get(){return d.show},set(a){c("update:show",a)}}),r=$({url:"lodgeick.api.request_invoice",makeParams(a){return{request_id:a.requestId}},onSuccess(a){a.success?(c("invoice-requested",a),c("update:show",!1)):i.value=a.error||"Failed to request invoice",o.value=!1},onError(a){i.value=a.message||"An error occurred while requesting invoice",o.value=!1}}),v=()=>p(this,null,function*(){i.value=null,o.value=!0;try{s.value==="invoice"?yield B():s.value==="card"&&(yield S())}catch(a){i.value=a.message||"An unexpected error occurred",o.value=!1}}),B=()=>p(this,null,function*(){r.submit({requestId:d.requestId})}),S=()=>p(this,null,function*(){c("payment-initiated"),o.value=!1,alert("Stripe integration coming soon!")}),g=a=>a?new Intl.NumberFormat("en-NZ",{minimumFractionDigits:2,maximumFractionDigits:2}).format(a):"0.00";return(a,t)=>(x(),D(w(E),{modelValue:u.value,"onUpdate:modelValue":t[5]||(t[5]=l=>u.value=l),options:{title:"Payment Options",size:"md"}},{"body-content":b(()=>[e("div",M,[e("div",R,[e("div",F,[t[6]||(t[6]=e("span",{class:"text-gray-700 font-medium"},"Total Amount (incl. GST)",-1)),e("span",G," $"+m(g(n.totalAmount)),1)]),e("div",T,[e("span",null,"Fees: $"+m(g(n.feesExclGst))+" + GST $"+m(g(n.gst)),1)])]),e("div",{class:h(["border-2 rounded-lg p-4 cursor-pointer transition-all",{"border-blue-500 bg-blue-50":s.value==="invoice","border-gray-200 hover:border-blue-300":s.value!=="invoice"}]),onClick:t[1]||(t[1]=l=>s.value="invoice")},[e("div",j,[N(e("input",{type:"radio","onUpdate:modelValue":t[0]||(t[0]=l=>s.value=l),value:"invoice",class:"mt-1"},null,512),[[V,s.value]]),t[7]||(t[7]=e("div",{class:"flex-1"},[e("h3",{class:"font-medium text-gray-900 mb-1"},"Request Invoice"),e("p",{class:"text-sm text-gray-600"}," An invoice will be sent to your email. Pay via bank transfer or at council office. ")],-1))])],2),n.stripeEnabled?(x(),C("div",{key:0,class:h(["border-2 rounded-lg p-4 cursor-pointer transition-all",{"border-blue-500 bg-blue-50":s.value==="card","border-gray-200 hover:border-blue-300":s.value!=="card"}]),onClick:t[3]||(t[3]=l=>s.value="card")},[e("div",z,[N(e("input",{type:"radio","onUpdate:modelValue":t[2]||(t[2]=l=>s.value=l),value:"card",class:"mt-1"},null,512),[[V,s.value]]),t[8]||(t[8]=e("div",{class:"flex-1"},[e("h3",{class:"font-medium text-gray-900 mb-1"},"Pay Now (Credit/Debit Card)"),e("p",{class:"text-sm text-gray-600 mb-2"}," Pay securely online with Stripe. Instant confirmation. "),e("div",{class:"text-xs text-gray-500"},"Visa, Mastercard, Amex accepted")],-1))])],2)):P("",!0),i.value?(x(),C("div",O,[e("div",U,[t[9]||(t[9]=e("svg",{class:"h-5 w-5 text-red-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("p",_,m(i.value),1)])])):P("",!0)])]),actions:b(()=>[k(w(I),{variant:"subtle",onClick:t[4]||(t[4]=l=>u.value=!1),disabled:o.value},{default:b(()=>[...t[10]||(t[10]=[q(" Cancel ",-1)])]),_:1},8,["disabled"]),k(w(I),{variant:"solid",onClick:v,loading:o.value,disabled:!s.value},{default:b(()=>[q(m(s.value==="card"?"Proceed to Payment":"Request Invoice"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"]))}};export{L as default};
//# sourceMappingURL=PaymentModal-Cg2vZyqZ.js.map
