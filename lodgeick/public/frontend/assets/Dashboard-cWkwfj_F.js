import{a5 as L,c,B as h,a as n,o as l,b as t,aj as M,R as r,P as p,a2 as V,u as m,t as a,a6 as A,ak as U,F as H,W as $,e as O,_ as j}from"./vue-vendor-D9RCx05D.js";import{i as q,m as P,I as z}from"./frappe-ui-E4oUKPDc.js";import{_ as f}from"./StatCard-BwumLenT.js";import{s as w}from"./index-D2HPsIZS.js";import{r as E}from"./request.service-91aYHjAe.js";import"./ui-components-88qJBhde.js";const F={class:"min-h-screen bg-gray-50"},W={class:"bg-white shadow-sm border-b border-gray-200"},G={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Q={class:"flex justify-between items-center py-4"},Z={class:"flex items-center space-x-4"},J={class:"flex items-center space-x-2 text-gray-700 hover:text-gray-900"},K={class:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center"},X={class:"text-sm font-medium text-blue-600"},Y={class:"text-sm font-medium"},ee={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},te={class:"mb-8"},se={class:"text-2xl font-bold text-gray-900 mb-2"},oe={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},ae={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},re={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ne={class:"md:col-span-2"},le={class:"bg-white rounded-lg shadow-sm border border-gray-200"},ie={key:0,class:"p-12 text-center"},de={key:1,class:"p-12 text-center"},ue={class:"text-gray-500 mb-6"},ce={key:2,class:"overflow-x-auto"},pe={class:"w-full"},me={class:"bg-white divide-y divide-gray-200"},xe=["onClick"],ge={class:"px-4 py-3 whitespace-nowrap"},ve={class:"text-sm font-medium text-blue-600"},he={class:"px-4 py-3 max-w-xs"},fe=["title"],ye={class:"px-4 py-3 whitespace-nowrap"},be={class:"text-sm text-gray-900"},we={class:"px-4 py-3 whitespace-nowrap"},_e={class:"text-sm text-gray-500"},ke={class:"px-4 py-3 whitespace-nowrap text-center"},Ce={class:"text-sm font-medium text-gray-900"},Re={class:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium"},Ne=["onClick"],Se=["onClick"],Ae={__name:"Dashboard",setup(Me){const i=L(),y=c(()=>{var e;return(((e=w.user_info)==null?void 0:e.full_name)||w.user).replace("@"," ").split(".").join(" ")}),B=c(()=>{const s=y.value,e=s.split(" ");return e.length>=2?(e[0][0]+e[1][0]).toUpperCase():s.substring(0,2).toUpperCase()}),d=h(""),_=h(""),k=h(""),x=h(""),g=E.getUserRequests();c(()=>{const s=g.data||[];return[...new Set(s.map(o=>o.council).filter(Boolean))].sort()});const v=c(()=>{const s=g.data||[];return{total:s.length,underReview:s.filter(e=>e.status==="Under Review").length,approved:s.filter(e=>e.status==="Approved").length,rfiPending:s.filter(e=>e.status==="RFI Issued").length}}),b=c(()=>{let s=g.data||[];if(d.value){const e=d.value.toLowerCase();s=s.filter(o=>{var u,N,S;return((u=o.request_number)==null?void 0:u.toLowerCase().includes(e))||((N=o.property_address)==null?void 0:N.toLowerCase().includes(e))||((S=o.brief_description)==null?void 0:S.toLowerCase().includes(e))})}return _.value&&(s=s.filter(e=>e.status===_.value)),k.value&&(s=s.filter(e=>e.council===k.value)),x.value&&(s=s.filter(e=>{var o;return(o=e.request_type)==null?void 0:o.includes(x.value)})),s}),T=s=>s?new Date(s).toLocaleDateString("en-NZ",{year:"numeric",month:"short",day:"numeric"}):"N/A",C=()=>{i.push({name:"NewRequest"})},R=s=>{i.push({name:"RequestDetail",params:{id:s}})},D=s=>{i.push({name:"RequestDetail",params:{id:s}})},I=[{label:"Staff Portal",onClick:()=>{i.push({name:"InternalRequestManagement"})}},{label:"Settings",onClick:()=>{i.push({name:"Settings"})}},{label:"Sign Out",onClick:()=>w.logout.submit()}];return(s,e)=>(l(),n("div",F,[t("header",W,[t("div",G,[t("div",Q,[e[6]||(e[6]=M('<div class="flex items-center space-x-3"><div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><div><h1 class="text-xl font-bold text-gray-900">Councils Online</h1><p class="text-xs text-gray-500">Council Request Management</p></div></div>',1)),t("div",Z,[e[5]||(e[5]=M('<a href="https://taytay.gov.ph" target="_blank" rel="noopener noreferrer" class="hidden md:flex items-center space-x-2 text-gray-600 hover:text-blue-600 transition-colors px-3 py-2 rounded-md hover:bg-blue-50"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg><span class="text-sm font-medium">Taytay Council</span><svg class="w-3 h-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path></svg></a>',1)),r(m(q),{onClick:C,variant:"solid",theme:"blue"},{prefix:p(()=>[...e[2]||(e[2]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:p(()=>[e[3]||(e[3]=V(" New Request ",-1))]),_:1}),r(m(P),{options:I},{default:p(({open:o})=>[t("button",J,[t("div",K,[t("span",X,a(B.value),1)]),t("span",Y,a(y.value),1),e[4]||(e[4]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),_:1})])])])]),t("main",ee,[t("div",te,[t("h2",se,"Welcome back, "+a(y.value)+"!",1),e[7]||(e[7]=t("p",{class:"text-gray-600"},"Manage your council requests and track their progress",-1))]),t("div",oe,[r(f,{title:"Total Requests",value:v.value.total,icon:"file-text",color:"blue"},null,8,["value"]),r(f,{title:"Under Review",value:v.value.underReview,icon:"clock",color:"yellow"},null,8,["value"]),r(f,{title:"Approved",value:v.value.approved,icon:"check-circle",color:"green"},null,8,["value"]),r(f,{title:"Info Requested",value:v.value.rfiPending,icon:"alert-circle",color:"orange"},null,8,["value"])]),t("div",ae,[t("div",re,[t("div",ne,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),r(m(z),{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value=o),placeholder:"Search by request number or address...",type:"text"},{prefix:p(()=>[...e[8]||(e[8]=[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)])]),_:1},8,["modelValue"])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type",-1)),A(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>x.value=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...e[10]||(e[10]=[t("option",{value:""},"All Types",-1),t("option",{value:"Resource Consent"},"Resource Consent",-1),t("option",{value:"Building Consent"},"Building Consent",-1)])],512),[[U,x.value]])])])]),t("div",le,[e[17]||(e[17]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Councils Online")],-1)),m(g).loading?(l(),n("div",ie,[...e[12]||(e[12]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),t("p",{class:"mt-4 text-gray-500"},"Loading applications...",-1)])])):!b.value||b.value.length===0?(l(),n("div",de,[e[14]||(e[14]=t("div",{class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"},[t("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1)),e[15]||(e[15]=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No applications found",-1)),t("p",ue,a(d.value?"Try adjusting your search or filters":"Get started by creating your first application"),1),r(m(q),{onClick:C,variant:"solid",theme:"blue"},{default:p(()=>[...e[13]||(e[13]=[V(" Create New Application ",-1)])]),_:1})])):(l(),n("div",ce,[t("table",pe,[e[16]||(e[16]=t("thead",{class:"bg-gray-50 border-b border-gray-200"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Request #"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"State"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap"},"Days Elapsed"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",me,[(l(!0),n(H,null,$(b.value,o=>(l(),n("tr",{key:o.name,class:"hover:bg-gray-50 transition cursor-pointer",onClick:u=>R(o.name)},[t("td",ge,[t("div",ve,a(o.request_number),1)]),t("td",he,[t("div",{class:"text-sm text-gray-900 truncate",title:o.request_type},a(o.request_type),9,fe)]),t("td",ye,[t("div",be,a(o.workflow_state||"N/A"),1)]),t("td",we,[t("div",_e,a(T(o.creation)),1)]),t("td",ke,[t("div",Ce,a(o.working_days_elapsed||0)+" days",1)]),t("td",Re,[t("button",{onClick:j(u=>R(o.name),["stop"]),class:"text-blue-600 hover:text-blue-900 mr-3"}," View ",8,Ne),o.status==="Draft"?(l(),n("button",{key:0,onClick:j(u=>D(o.name),["stop"]),class:"text-gray-600 hover:text-gray-900"}," Edit ",8,Se)):O("",!0)])],8,xe))),128))])])]))])])]))}};export{Ae as default};
//# sourceMappingURL=Dashboard-cWkwfj_F.js.map
