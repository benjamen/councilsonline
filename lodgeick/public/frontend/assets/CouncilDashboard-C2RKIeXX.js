var z=(L,m,x)=>new Promise((D,c)=>{var d=u=>{try{y(x.next(u))}catch(f){c(f)}},h=u=>{try{y(x.throw(u))}catch(f){c(f)}},y=u=>u.done?D(u.value):Promise.resolve(u.value).then(d,h);y((x=x.apply(L,m)).next())});import{f as K,B as X,C as Y,j as v,r as g,s as V,G as ee,L as te,c as l,o as a,a as e,x as n,t as i,d as B,b as C,u as R,h as T,w as j,i as F,F as H,l as P,I as se,k as E,v as G,g as oe,m as O}from"./index-CW-VPd7V.js";import{D as le}from"./Dropdown-D2ZA9ejg.js";import{_ as ae}from"./StatusBadge-BWCKEC5C.js";const re={class:"min-h-screen bg-gray-50"},ne={class:"bg-white shadow-sm border-b border-gray-200"},ie={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},de={class:"flex justify-between items-center py-4"},ue={class:"flex items-center space-x-3"},ce={key:0,class:"h-10"},pe=["src","alt"],me={class:"text-xl font-bold text-gray-900"},ve={class:"flex items-center space-x-4"},xe={class:"flex items-center space-x-2 text-gray-700 hover:text-gray-900"},ye={class:"text-sm font-medium"},ge={class:"text-sm font-medium"},he={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},fe={class:"mb-8"},_e={class:"text-2xl font-bold text-gray-900 mb-2"},we={class:"text-gray-600"},ke={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},be={class:"flex items-center justify-between"},Ce={class:"text-sm font-medium text-gray-600"},Re={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},je={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"},Se={key:2,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},Ae={key:3,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},Me={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},De={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ne={class:"md:col-span-1"},Ve={class:"bg-white rounded-lg shadow-sm border border-gray-200"},Be={class:"px-6 py-4 border-b border-gray-200"},Te={class:"text-lg font-semibold text-gray-900"},Le={key:0,class:"p-12 text-center"},Ie={key:1,class:"p-12 text-center"},Ue={class:"text-gray-500 mb-6"},$e={key:2,class:"overflow-x-auto"},qe={class:"w-full"},ze={class:"bg-white divide-y divide-gray-200"},Fe=["onClick"],He={class:"px-6 py-4 whitespace-nowrap"},Pe={class:"px-6 py-4 whitespace-nowrap"},Ee={class:"text-sm text-gray-900"},Ge={class:"px-6 py-4"},Oe={class:"text-sm text-gray-900"},We={class:"px-6 py-4 whitespace-nowrap"},Qe={class:"px-6 py-4 whitespace-nowrap"},Ze={class:"text-sm text-gray-500"},Je={class:"px-6 py-4 whitespace-nowrap"},Ke={class:"text-sm text-gray-900"},Xe={key:0,class:"text-xs text-gray-500"},Ye={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},et=["onClick"],tt=["onClick"],nt={__name:"CouncilDashboard",setup(L){const m=K(),x=X(),D=Y(),c=v(()=>{var s;return(s=x.params.councilCode)==null?void 0:s.toUpperCase()}),d=g(null),h=g([]),y=g(!0),u=v(()=>{var t;return(((t=V.user_info)==null?void 0:t.full_name)||V.user).replace("@"," ").split(".").join(" ")}),f=v(()=>{const s=u.value,t=s.split(" ");return t.length>=2?(t[0][0]+t[1][0]).toUpperCase():s.substring(0,2).toUpperCase()}),_=g(""),S=g(""),A=g(""),r=v(()=>{var s;return((s=d.value)==null?void 0:s.primary_color)||"#2563eb"}),M=v(()=>{const s=h.value||[];return{total:s.length,underReview:s.filter(t=>t.status==="Under Review").length,approved:s.filter(t=>t.status==="Approved").length,rfiPending:s.filter(t=>t.status==="RFI Issued").length}}),W=v(()=>[{title:"Total Requests",value:M.value.total,icon:"file-text"},{title:"Under Review",value:M.value.underReview,icon:"clock"},{title:"Approved",value:M.value.approved,icon:"check-circle"},{title:"Info Requested",value:M.value.rfiPending,icon:"alert-circle"}]),N=v(()=>{let s=h.value||[];if(_.value){const t=_.value.toLowerCase();s=s.filter(p=>{var w,k,b;return((w=p.request_number)==null?void 0:w.toLowerCase().includes(t))||((k=p.property_address)==null?void 0:k.toLowerCase().includes(t))||((b=p.brief_description)==null?void 0:b.toLowerCase().includes(t))})}return S.value&&(s=s.filter(t=>t.status===S.value)),A.value&&(s=s.filter(t=>{var p;return(p=t.request_type)==null?void 0:p.includes(A.value)})),s});ee(()=>z(this,null,function*(){try{d.value=yield D.getCouncilSettings(c.value);const s=yield te("lodgeick.api.get_council_requests",{council_code:c.value});h.value=s||[]}catch(s){console.error("Failed to load council data:",s)}finally{y.value=!1}}));const Q=s=>s?new Date(s).toLocaleDateString("en-NZ",{year:"numeric",month:"short",day:"numeric"}):"N/A",I=()=>{m.push({name:"NewRequest",query:{council:c.value,locked:"true"}})},U=s=>{m.push({name:"RequestDetail",params:{id:s}})},Z=s=>{m.push({name:"RequestDetail",params:{id:s}})},J=[{label:"My Account",onClick:()=>{m.push({name:"CouncilAccount",params:{councilCode:c.value}})}},{label:"Sign Out",onClick:()=>V.logout.submit()}];return(s,t)=>{var p,w,k,b,$;return a(),l("div",re,[e("header",ne,[e("div",ie,[e("div",de,[e("div",ue,[(p=d.value)!=null&&p.logo?(a(),l("div",ce,[e("img",{src:d.value.logo,alt:d.value.council_name,class:"h-full object-contain"},null,8,pe)])):(a(),l("div",{key:1,class:"w-10 h-10 rounded-lg flex items-center justify-center",style:n({backgroundColor:r.value})},[...t[4]||(t[4]=[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)])],4)),e("div",null,[e("h1",me,i(((w=d.value)==null?void 0:w.council_name)||c.value),1),t[5]||(t[5]=e("p",{class:"text-xs text-gray-500"},"Application Portal",-1))])]),e("div",ve,[(k=d.value)!=null&&k.show_council_switcher?(a(),l("button",{key:0,onClick:t[0]||(t[0]=o=>R(m).push({name:"Dashboard"})),class:"text-sm text-gray-600 hover:text-gray-900 flex items-center gap-1"},[...t[6]||(t[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1),T(" Switch Council ",-1)])])):B("",!0),C(R(F),{onClick:I,variant:"solid",style:n({backgroundColor:r.value,borderColor:r.value})},{prefix:j(()=>[...t[7]||(t[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),default:j(()=>[t[8]||(t[8]=T(" New Application ",-1))]),_:1},8,["style"]),C(R(le),{options:J},{default:j(({open:o})=>[e("button",xe,[e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center",style:n({backgroundColor:`${r.value}20`,color:r.value})},[e("span",ye,i(f.value),1)],4),e("span",ge,i(u.value),1),t[9]||(t[9]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),_:1})])])])]),e("main",he,[e("div",fe,[e("h2",_e,"Welcome back, "+i(u.value)+"!",1),e("p",we,"Manage your "+i(((b=d.value)==null?void 0:b.council_name)||c.value)+" applications and track their progress",1)]),e("div",ke,[(a(!0),l(H,null,P(W.value,o=>(a(),l("div",{key:o.title,class:"bg-white rounded-lg shadow-sm border p-6",style:n({borderTopColor:r.value,borderTopWidth:"4px"})},[e("div",be,[e("div",null,[e("p",Ce,i(o.title),1),e("p",{class:"text-3xl font-bold mt-2",style:n({color:r.value})},i(o.value),5)]),e("div",{class:"w-12 h-12 rounded-lg flex items-center justify-center",style:n({backgroundColor:`${r.value}20`})},[(a(),l("svg",{class:"w-6 h-6",style:n({color:r.value}),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o.icon==="file-text"?(a(),l("path",Re)):o.icon==="clock"?(a(),l("path",je)):o.icon==="check-circle"?(a(),l("path",Se)):(a(),l("path",Ae))],4))],4)])],4))),128))]),e("div",Me,[e("div",De,[e("div",Ne,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Search",-1)),C(R(se),{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=o=>_.value=o),placeholder:"Search by request number or property...",type:"text"},{prefix:j(()=>[...t[10]||(t[10]=[e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)])]),_:1},8,["modelValue"])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Status",-1)),E(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>S.value=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:border-transparent",style:n({"--tw-ring-color":r.value})},[...t[12]||(t[12]=[oe('<option value="">All Statuses</option><option value="Draft">Draft</option><option value="Submitted">Submitted</option><option value="Under Review">Under Review</option><option value="RFI Issued">RFI Issued</option><option value="Approved">Approved</option><option value="Declined">Declined</option>',7)])],4),[[G,S.value]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type",-1)),E(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>A.value=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:border-transparent",style:n({"--tw-ring-color":r.value})},[...t[14]||(t[14]=[e("option",{value:""},"All Types",-1),e("option",{value:"Resource Consent"},"Resource Consent",-1),e("option",{value:"Building Consent"},"Building Consent",-1)])],4),[[G,A.value]])])])]),e("div",Ve,[e("div",Be,[e("h3",Te,"My "+i((($=d.value)==null?void 0:$.council_name)||c.value)+" Applications",1)]),y.value?(a(),l("div",Le,[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2",style:n({borderColor:r.value})},null,4),t[16]||(t[16]=e("p",{class:"mt-4 text-gray-500"},"Loading applications...",-1))])):!N.value||N.value.length===0?(a(),l("div",Ie,[e("div",{class:"w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",style:n({backgroundColor:`${r.value}20`})},[(a(),l("svg",{class:"w-8 h-8",style:n({color:r.value}),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[17]||(t[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])],4))],4),t[19]||(t[19]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No applications found",-1)),e("p",Ue,i(_.value?"Try adjusting your search or filters":"Get started by creating your first application"),1),C(R(F),{onClick:I,variant:"solid",style:n({backgroundColor:r.value,borderColor:r.value})},{default:j(()=>[...t[18]||(t[18]=[T(" Create New Application ",-1)])]),_:1},8,["style"])])):(a(),l("div",$e,[e("table",qe,[t[20]||(t[20]=e("thead",{class:"bg-gray-50 border-b border-gray-200"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Request #"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Property"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Submitted"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Days Elapsed"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ze,[(a(!0),l(H,null,P(N.value,o=>(a(),l("tr",{key:o.name,class:"hover:bg-gray-50 transition cursor-pointer",onClick:q=>U(o.name)},[e("td",He,[e("div",{class:"text-sm font-medium",style:n({color:r.value})},i(o.request_number),5)]),e("td",Pe,[e("div",Ee,i(o.request_type),1)]),e("td",Ge,[e("div",Oe,i(o.property_address||"N/A"),1)]),e("td",We,[C(ae,{status:o.status},null,8,["status"])]),e("td",Qe,[e("div",Ze,i(Q(o.creation)),1)]),e("td",Je,[e("div",Ke,i(o.working_days_elapsed||0)+" days",1),o.statutory_clock_started?(a(),l("div",Xe," of 20 day limit ")):B("",!0)]),e("td",Ye,[e("button",{onClick:O(q=>U(o.name),["stop"]),class:"hover:opacity-80 mr-4",style:n({color:r.value})}," View ",12,et),o.status==="Draft"?(a(),l("button",{key:0,onClick:O(q=>Z(o.name),["stop"]),class:"text-gray-600 hover:text-gray-900"}," Edit ",8,tt)):B("",!0)])],8,Fe))),128))])])]))])])])}}};export{nt as default};
//# sourceMappingURL=CouncilDashboard-C2RKIeXX.js.map
