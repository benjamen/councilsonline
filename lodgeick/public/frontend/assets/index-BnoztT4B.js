const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Landing-CT-kIaJI.js","assets/frappe-ui-DjR51muK.js","assets/vue-vendor-B0shnPjy.js","assets/ui-components-BkacYXVN.js","assets/frappe-ui-BcYQ_VTL.css","assets/Landing-tn0RQdqM.css","assets/Dashboard-DbZ4GURd.js","assets/StatCard-BqCbYPig.js","assets/request.service-W88L9M1G.js","assets/Home-c-RD3fSJ.js","assets/NewRequest-KJHcmcri.js","assets/RequestHeader-CFcOgVuT.js","assets/NewRequest-Oa-AT-uZ.css","assets/RequestDetail-BoXD5oMa.js","assets/StatusBadge-BSS5uEy_.js","assets/useStatutoryClock--LlLn5es.js","assets/InternalRequestManagement-CSC6rxt3.js","assets/InternalRequestDetail-C4M4auzg.js","assets/Settings-DBHbi1n3.js","assets/RequestTypeBuilder-C0dF0GxX.js","assets/AssessmentTemplateBuilder-BpPTT6ZB.js","assets/CompanyManagement-CYalcEDC.js","assets/Login-CAcV0fd7.js","assets/Register-ZxXQ3Ngq.js","assets/validation-C80dm2Yt.js","assets/CompanyRegistration-Dpm2Bd7s.js"])))=>i.map(i=>d[i]);
var h=(e,t,o)=>new Promise((r,n)=>{var i=s=>{try{l(o.next(s))}catch(u){n(u)}},a=s=>{try{l(o.throw(s))}catch(u){n(u)}},l=s=>s.done?r(s.value):Promise.resolve(s.value).then(i,a);l((o=o.apply(e,t)).next())});import{am as ie,c,w as ce,D as le,ac as ae,a as se,o as ue,R as pe,z as me,an as de,ao as fe,ah as _e,ap as ge}from"./vue-vendor-B0shnPjy.js";import{c as B,a as G,_ as p,l as he,s as ye,r as ve,p as Ce,b as Te,d as Pe,D as Ee,e as Ae,f as Se,I as ke,g as De,h as Ie,i as be}from"./frappe-ui-DjR51muK.js";import"./ui-components-BkacYXVN.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();const we=ie("siteCouncil",{state:()=>({council:null,requestTypes:[],loading:!1,error:null,lastFetched:null}),getters:{councilData:e=>e.council,isLoaded:e=>!!e.council,availableRequestTypes:e=>e.requestTypes,branding:e=>{var t,o,r,n,i,a,l,s,u,f,d,_,m,C,E,A,S,k,D,I,b,w,R,L,N,O,$,F,q;return{primaryColor:((t=e.council)==null?void 0:t.primary_color)||"#2563EB",secondaryColor:((o=e.council)==null?void 0:o.secondary_color)||"#1E40AF",accentColor:((r=e.council)==null?void 0:r.accent_color)||"#059669",appName:((n=e.council)==null?void 0:n.app_name)||null,councilName:((i=e.council)==null?void 0:i.council_name)||"Council",tagline:((a=e.council)==null?void 0:a.tagline)||null,logo:((l=e.council)==null?void 0:l.logo)||null,favicon:((s=e.council)==null?void 0:s.favicon)||null,heroTitle:((u=e.council)==null?void 0:u.hero_title)||null,heroSubtitle:((f=e.council)==null?void 0:f.hero_subtitle)||null,heroDescription:((d=e.council)==null?void 0:d.hero_description)||null,heroImage:((_=e.council)==null?void 0:_.hero_image)||null,ctaPrimaryText:((m=e.council)==null?void 0:m.cta_primary_text)||"Get Started",ctaSecondaryText:((C=e.council)==null?void 0:C.cta_secondary_text)||"Learn More",feature1Title:((E=e.council)==null?void 0:E.feature_1_title)||null,feature1Description:((A=e.council)==null?void 0:A.feature_1_description)||null,feature2Title:((S=e.council)==null?void 0:S.feature_2_title)||null,feature2Description:((k=e.council)==null?void 0:k.feature_2_description)||null,feature3Title:((D=e.council)==null?void 0:D.feature_3_title)||null,feature3Description:((I=e.council)==null?void 0:I.feature_3_description)||null,feature4Title:((b=e.council)==null?void 0:b.feature_4_title)||null,feature4Description:((w=e.council)==null?void 0:w.feature_4_description)||null,footerTagline:((R=e.council)==null?void 0:R.footer_tagline)||null,supportEmail:((L=e.council)==null?void 0:L.support_email)||null,supportPhone:((N=e.council)==null?void 0:N.support_phone)||null,footerAddress:((O=e.council)==null?void 0:O.footer_address)||null,website:(($=e.council)==null?void 0:$.website)||null,contactEmail:((F=e.council)==null?void 0:F.contact_email)||null,contactPhone:((q=e.council)==null?void 0:q.contact_phone)||null}},meetingConfig:e=>{var t,o,r,n;return{defaultDuration:((t=e.council)==null?void 0:t.default_meeting_duration)||60,availableDurations:((r=(o=e.council)==null?void 0:o.available_meeting_durations)==null?void 0:r.split(",").map(i=>Number.parseInt(i.trim())))||[30,60,90],bufferTime:((n=e.council)==null?void 0:n.meeting_buffer_time)||15}}},actions:{loadCouncil(e=!1){return h(this,null,function*(){const o=Date.now();if(!e&&this.council&&this.lastFetched&&o-this.lastFetched<3e5){console.log("[siteCouncil] Using cached council data");return}this.loading=!0,this.error=null;try{console.log("[siteCouncil] Fetching council data..."),this.council=yield B("lodgeick.api.get_council"),this.requestTypes=yield B("lodgeick.api.get_request_types"),this.lastFetched=o,console.log(`[siteCouncil] Loaded: ${this.council.council_name}`),console.log(`[siteCouncil] Request Types: ${this.requestTypes.length}`)}catch(r){throw console.error("[siteCouncil] Failed to load council data:",r),this.error=r.message||"Failed to load council data",r}finally{this.loading=!1}})},reload(){return h(this,null,function*(){return this.loadCouncil(!0)})},clearCache(){this.council=null,this.requestTypes=[],this.lastFetched=null,console.log("[siteCouncil] Cache cleared")}}});function Z(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function V(e,t){const o=Z(e);if(!o)return e;const r=1-t/100,n=Math.round(o.r*r),i=Math.round(o.g*r),a=Math.round(o.b*r);return`#${n.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}`}function z(e,t){const o=Z(e);if(!o)return e;const r=t/100,n=Math.round(o.r+(255-o.r)*r),i=Math.round(o.g+(255-o.g)*r),a=Math.round(o.b+(255-o.b)*r);return`#${n.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}${a.toString(16).padStart(2,"0")}`}function x(e){const t=document.documentElement;e.primaryColor&&(t.style.setProperty("--color-primary",e.primaryColor),t.style.setProperty("--color-primary-hover",V(e.primaryColor,15)),t.style.setProperty("--color-primary-light",z(e.primaryColor,85)),t.style.setProperty("--color-primary-dark",V(e.primaryColor,25))),e.secondaryColor&&(t.style.setProperty("--color-secondary",e.secondaryColor),t.style.setProperty("--color-secondary-hover",V(e.secondaryColor,15)),t.style.setProperty("--color-secondary-light",z(e.secondaryColor,85))),e.accentColor&&(t.style.setProperty("--color-accent",e.accentColor),t.style.setProperty("--color-accent-hover",V(e.accentColor,15)),t.style.setProperty("--color-accent-light",z(e.accentColor,85)))}function J(e){if(!e)return;let t=document.querySelector("link[rel~='icon']");t||(t=document.createElement("link"),t.rel="icon",document.head.appendChild(t)),t.href=e}function H(e){if(e){const t=document.title;(t==="Lodgeick"||t==="Loading...")&&(document.title=e)}}function Re(){const e=we(),t=c(()=>e.branding),o=c(()=>t.value.appName||t.value.councilName||"CouncilsOnline"),r=c(()=>t.value.councilName||"Council"),n=c(()=>t.value.tagline||""),i=c(()=>t.value.logo||null),a=c(()=>t.value.favicon||null),l=c(()=>t.value.primaryColor),s=c(()=>t.value.secondaryColor),u=c(()=>t.value.accentColor),f=c(()=>t.value.heroTitle||null),d=c(()=>t.value.heroSubtitle||null),_=c(()=>t.value.heroDescription||null),m=c(()=>t.value.heroImage||null),C=c(()=>t.value.ctaPrimaryText||"Get Started"),E=c(()=>t.value.ctaSecondaryText||"Learn More"),A=c(()=>t.value.feature1Title||null),S=c(()=>t.value.feature1Description||null),k=c(()=>t.value.feature2Title||null),D=c(()=>t.value.feature2Description||null),I=c(()=>t.value.feature3Title||null),b=c(()=>t.value.feature3Description||null),w=c(()=>t.value.feature4Title||null),R=c(()=>t.value.feature4Description||null),L=c(()=>t.value.footerTagline||null),N=c(()=>t.value.supportEmail||t.value.contactEmail||null),O=c(()=>t.value.supportPhone||t.value.contactPhone||null),$=c(()=>t.value.footerAddress||null),F=c(()=>t.value.website||null),q=c(()=>t.value.contactEmail||null),re=c(()=>t.value.contactPhone||null);ce(t,g=>{g&&(x(g),J(g.favicon),H(g.appName||g.councilName))},{immediate:!0,deep:!0});function ne(){return h(this,null,function*(){try{yield e.loadCouncil(),e.branding&&(x(e.branding),J(e.branding.favicon),H(e.branding.appName||e.branding.councilName))}catch(g){console.warn("Failed to load council branding:",g)}})}return{branding:t,appName:o,councilName:r,tagline:n,logo:i,favicon:a,primaryColor:l,secondaryColor:s,accentColor:u,heroTitle:f,heroSubtitle:d,heroDescription:_,heroImage:m,ctaPrimaryText:C,ctaSecondaryText:E,feature1Title:A,feature1Description:S,feature2Title:k,feature2Description:D,feature3Title:I,feature3Description:b,feature4Title:w,feature4Description:R,footerTagline:L,supportEmail:N,supportPhone:O,footerAddress:$,website:F,contactEmail:q,contactPhone:re,initTheme:ne,applyCssVariables:x,councilStore:e,isLoading:c(()=>e.isLoading),council:c(()=>e.council)}}const Le={__name:"App",setup(e){const{initTheme:t}=Re();return le(()=>{t()}),(o,r)=>{const n=ae("router-view");return ue(),se("div",null,[pe(n)])}}},K=G({url:"frappe.auth.get_logged_user",cache:"User",onError(e){e&&e.exc_type==="AuthenticationError"&&P.push({name:"LoginPage"})}});function U(){let t=new URLSearchParams(document.cookie.split("; ").join("&")).get("user_id");return t==="Guest"&&(t=null),t}const T=me({login:G({url:"login",makeParams({email:e,password:t}){return{usr:e,pwd:t}},onSuccess(){return h(this,null,function*(){K.reload(),T.user=U(),T.login.reset();try{yield B("lodgeick.api.track_login_event",{source:"web"})}catch(e){console.error("Failed to track login event:",e)}P.replace({name:"Dashboard"})})}}),logout:G({url:"logout",onSuccess(){K.reset(),T.user=U(),P.replace({name:"Login"})}}),user:U(),isLoggedIn:c(()=>!!T.user)}),Ne=[{path:"/",name:"Landing",component:()=>p(()=>import("./Landing-CT-kIaJI.js"),__vite__mapDeps([0,1,2,3,4,5])),meta:{public:!0}},{path:"/dashboard",name:"Dashboard",component:()=>p(()=>import("./Dashboard-DbZ4GURd.js"),__vite__mapDeps([6,2,1,3,4,7,8]))},{path:"/home",name:"Home",component:()=>p(()=>import("./Home-c-RD3fSJ.js"),__vite__mapDeps([9,1,2,3,4]))},{path:"/request/new",name:"NewRequest",component:()=>p(()=>import("./NewRequest-KJHcmcri.js").then(e=>e.N),__vite__mapDeps([10,1,2,3,4,8,11,12])),meta:{public:!0}},{path:"/request/:id",name:"RequestDetail",component:()=>p(()=>import("./RequestDetail-BoXD5oMa.js"),__vite__mapDeps([13,1,2,3,4,14,11,15]))},{path:"/internal",name:"InternalRequestManagement",component:()=>p(()=>import("./InternalRequestManagement-CSC6rxt3.js"),__vite__mapDeps([16,2,1,3,4,7,14]))},{path:"/internal/request/:id",name:"InternalRequestDetail",component:()=>p(()=>import("./InternalRequestDetail-C4M4auzg.js"),__vite__mapDeps([17,1,2,3,4,14,11,15]))},{path:"/settings",name:"Settings",component:()=>p(()=>import("./Settings-DBHbi1n3.js"),__vite__mapDeps([18,2,1,3,4]))},{path:"/admin/request-type-builder",name:"RequestTypeBuilder",component:()=>p(()=>import("./RequestTypeBuilder-C0dF0GxX.js"),__vite__mapDeps([19,1,2,3,4])),meta:{requiresAdmin:!0}},{path:"/admin/assessment-template-builder",name:"AssessmentTemplateBuilder",component:()=>p(()=>import("./AssessmentTemplateBuilder-BpPTT6ZB.js"),__vite__mapDeps([20,2,1,3,4])),meta:{requiresAdmin:!0}},{path:"/admin/assessment-template-builder/:id",name:"AssessmentTemplateBuilderEdit",component:()=>p(()=>import("./AssessmentTemplateBuilder-BpPTT6ZB.js"),__vite__mapDeps([20,2,1,3,4])),meta:{requiresAdmin:!0}},{path:"/company",name:"CompanyManagement",component:()=>p(()=>import("./CompanyManagement-CYalcEDC.js"),__vite__mapDeps([21,2,1,3,4]))},{name:"Login",path:"/account/login",component:()=>p(()=>import("./Login-CAcV0fd7.js"),__vite__mapDeps([22,2,1,3,4])),meta:{public:!0}},{name:"Register",path:"/account/register",component:()=>p(()=>import("./Register-ZxXQ3Ngq.js"),__vite__mapDeps([23,2,1,3,4,24])),meta:{public:!0}},{name:"CompanyRegistration",path:"/account/register-company",component:()=>p(()=>import("./CompanyRegistration-Dpm2Bd7s.js"),__vite__mapDeps([25,2,1,3,4,24])),meta:{public:!0}}],P=de({history:fe("/frontend"),routes:Ne});P.beforeEach((e,t,o)=>h(void 0,null,function*(){if(e.meta.public){o();return}let r=T.isLoggedIn;try{yield K.promise}catch(n){r=!1}e.name==="Login"&&r?o({name:"Dashboard"}):e.name!=="Login"&&!r?o({name:"Login"}):o()}));const Oe=9e3;let y=null,M=!1;function $e(){if(M)return console.warn("[Socket.io] Skipping initialization - socketio server not available"),null;try{const e=window.location.hostname,t=window.site_name,o=window.location.port?`:${Oe}`:"",n=`${o?"http":"https"}://${e}${o}/${t}`;return y=he(n,{withCredentials:!0,reconnectionAttempts:3,reconnectionDelay:2e3,timeout:5e3}),y.on("connect_error",i=>{console.warn("[Socket.io] Connection failed - real-time features disabled:",i.message),M=!0,y&&(y.close(),y=null)}),y.on("connect",()=>{console.log("[Socket.io] Connected successfully"),M=!1}),y}catch(e){return console.warn("[Socket.io] Initialization error:",e),M=!0,null}}function Fe(e,t){if(e==null)return;let o=e;for(let r=0;r<t.length;r++){if(o===void 0||o[t[r]]===void 0)return;if(o===null||o[t[r]]===null)return null;o=o[t[r]]}return o}function W(e,t,o){if(o.length===0)return t;const r=o[0];return o.length>1&&(t=W(typeof e!="object"||e===null||!Object.prototype.hasOwnProperty.call(e,r)?Number.isInteger(Number(o[1]))?[]:{}:e[r],t,Array.prototype.slice.call(o,1))),Number.isInteger(Number(r))&&Array.isArray(e)?e.slice()[r]:Object.assign({},e,{[r]:t})}function j(e,t){if(e==null||t.length===0)return e;if(t.length===1){if(e==null)return e;if(Number.isInteger(t[0])&&Array.isArray(e))return Array.prototype.slice.call(e,0).splice(t[0],1);const o={};for(const r in e)o[r]=e[r];return delete o[t[0]],o}if(e[t[0]]==null){if(Number.isInteger(t[0])&&Array.isArray(e))return Array.prototype.concat.call([],e);const o={};for(const r in e)o[r]=e[r];return o}return W(e,j(e[t[0]],Array.prototype.slice.call(t,1)),[t[0]])}function ee(e,t){return t.map(o=>o.split(".")).map(o=>[o,Fe(e,o)]).filter(o=>o[1]!==void 0).reduce((o,r)=>W(o,r[1],r[0]),{})}function te(e,t){return t.map(o=>o.split(".")).reduce((o,r)=>j(o,r),e)}function Q(e,{storage:t,serializer:o,key:r,debug:n,pick:i,omit:a,beforeHydrate:l,afterHydrate:s},u,f=!0){try{f&&(l==null||l(u));const d=t.getItem(r);if(d){const _=o.deserialize(d),m=i?ee(_,i):_,C=a?te(m,a):m;e.$patch(C)}f&&(s==null||s(u))}catch(d){n&&console.error("[pinia-plugin-persistedstate]",d)}}function X(e,{storage:t,serializer:o,key:r,debug:n,pick:i,omit:a}){try{const l=i?ee(e,i):e,s=a?te(l,a):l,u=o.serialize(s);t.setItem(r,u)}catch(l){n&&console.error("[pinia-plugin-persistedstate]",l)}}function qe(e,t){return typeof e=="function"?e(t):typeof e=="string"?e:t}function Ve(e,t,o){const{pinia:r,store:n,options:{persist:i=o}}=e;if(!i)return;// v8 ignore if -- @preserve
if(!(n.$id in r.state.value)){const l=r._s.get(n.$id.replace("__hot:",""));l&&Promise.resolve().then(()=>l.$persist());return}const a=(Array.isArray(i)?i:i===!0?[{}]:[i]).map(t);n.$hydrate=({runHooks:l=!0}={})=>{a.forEach(s=>{Q(n,s,e,l)})},n.$persist=()=>{a.forEach(l=>{X(n.$state,l)})},a.forEach(l=>{Q(n,l,e),n.$subscribe((s,u)=>X(u,l),{detached:!0})})}function Me(e={}){return function(t){var o;Ve(t,r=>{var i,a,l,s,u,f,d,_;const n=qe(r.key,t.store.$id);return{key:(e.key?e.key:m=>m)(n),debug:(a=(i=r.debug)!=null?i:e.debug)!=null?a:!1,serializer:(s=(l=r.serializer)!=null?l:e.serializer)!=null?s:{serialize:m=>JSON.stringify(m),deserialize:m=>JSON.parse(m)},storage:(f=(u=r.storage)!=null?u:e.storage)!=null?f:window.localStorage,beforeHydrate:(d=r.beforeHydrate)!=null?d:e.beforeHydrate,afterHydrate:(_=r.afterHydrate)!=null?_:e.afterHydrate,pick:r.pick,omit:r.omit}},(o=e.auto)!=null?o:!1)}}var ze=Me();const Y={Button:Ie,TextInput:De,Input:ke,FormControl:Se,ErrorMessage:Ae,Dialog:Ee,Alert:Pe,Badge:Te},v=_e(Le),oe=ge();oe.use(ze);ye("resourceFetcher",be);v.use(oe);v.use(P);v.use(ve);v.use(Ce);function xe(){return h(this,null,function*(){if(window.csrf_token)console.log("[main.js] ✅ CSRF token loaded from boot data");else{console.log("[main.js] No boot CSRF token, trying cookies...");const t=document.cookie.split("; ").find(o=>o.startsWith("csrf_token="));if(t)window.csrf_token=t.split("=")[1],console.log("[main.js] ✅ CSRF token found in cookies");else try{if(console.log("[main.js] Fetching CSRF token from API..."),(yield fetch("/api/method/frappe.auth.get_logged_user",{credentials:"include"})).ok){const r=document.cookie.split("; ").find(n=>n.startsWith("csrf_token="));r?(window.csrf_token=r.split("=")[1],console.log("[main.js] ✅ CSRF token set after API fetch")):console.warn("[main.js] ⚠️ No CSRF token available")}}catch(o){console.error("[main.js] ❌ Could not fetch CSRF token:",o)}}const e=$e();v.config.globalProperties.$socket=e;for(const t in Y)v.component(t,Y[t]);v.mount("#app")})}xe();export{we as a,T as s,Re as u};
//# sourceMappingURL=index-BnoztT4B.js.map
