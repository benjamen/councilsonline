var B=(N,V,f)=>new Promise((j,u)=>{var o=m=>{try{p(f.next(m))}catch(s){u(s)}},w=m=>{try{p(f.throw(m))}catch(s){u(s)}},p=m=>m.done?j(m.value):Promise.resolve(m.value).then(o,w);p((f=f.apply(N,V)).next())});import{f as G,a9 as J,aa as K,j as H,r as x,q as O,b1 as _,p as Q,c as a,o as r,a as e,d as b,$ as c,t as d,b as v,w as k,h as y,m as W,u as h,I as C,i as I,ab as X}from"./index-pC62wxWx.js";const ee={class:"min-h-screen bg-gray-50"},te={class:"bg-white shadow-sm border-b border-gray-200"},oe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},se={class:"flex justify-between items-center py-4"},le={class:"flex items-center space-x-3"},ae={key:0,class:"h-8"},re=["src","alt"],ne={class:"text-xs text-gray-500"},ie={key:0,class:"text-sm"},de={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ue={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center"},me={key:1,class:"space-y-6"},ce={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},ve={class:"flex items-center space-x-6 mb-8"},ge={key:0,class:"text-3xl font-bold"},pe=["src"],fe={class:"text-lg font-semibold text-gray-900"},xe={class:"text-sm text-gray-500"},ye={class:"text-xs text-gray-400 mt-1"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ke={class:"flex justify-end space-x-4"},we={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},_e={class:"text-gray-600 mb-6"},Ce={class:"flex items-start space-x-4"},Ve={key:0,class:"h-16 flex-shrink-0"},je=["src","alt"],Me={class:"flex-1"},Be={class:"font-semibold text-gray-900 text-lg mb-2"},He={key:0,class:"text-sm text-gray-600 mb-3"},Ne={class:"space-y-2 text-sm"},Pe={key:0,class:"flex items-center text-gray-700"},Se={key:1,class:"flex items-center text-gray-700"},Ue={key:2,class:"flex items-center text-gray-700"},Le=["href"],qe={class:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4"},Ae={class:"flex items-center gap-3"},De={class:"flex items-center gap-3"},Fe={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},Ie={__name:"CouncilAccount",setup(N){const V=G(),f=J(),j=K(),u=H(()=>{var l;return(l=f.params.councilCode)==null?void 0:l.toUpperCase()}),o=x(null),w=x(!0),p=x(!1),m=x(!1),s=x({}),i=x({first_name:"",last_name:"",mobile_no:"",phone:""}),n=H(()=>{var l;return((l=o.value)==null?void 0:l.primary_color)||"#2563eb"}),R=H(()=>{const l=s.value.full_name||"",t=l.split(" ");return t.length>=2?(t[0][0]+t[1][0]).toUpperCase():l.substring(0,2).toUpperCase()});O(()=>B(this,null,function*(){try{o.value=yield j.getCouncilSettings(u.value),yield _.promise,s.value=_.data||{},i.value={first_name:s.value.first_name||"",last_name:s.value.last_name||"",mobile_no:s.value.mobile_no||"",phone:s.value.phone||""}}catch(l){console.error("Failed to load account data:",l)}finally{w.value=!1}}));const E=l=>l?new Date(l).toLocaleDateString("en-NZ",{year:"numeric",month:"long",day:"numeric"}):"N/A",T=()=>B(this,null,function*(){p.value=!0;try{yield X("frappe.client.set_value",{doctype:"User",name:s.value.name,fieldname:i.value}),yield _.reload(),s.value=_.data||{},alert("Profile updated successfully!")}catch(l){console.error("Failed to update profile:",l),alert("Failed to update profile. Please try again.")}finally{p.value=!1}}),Y=()=>{i.value={first_name:s.value.first_name||"",last_name:s.value.last_name||"",mobile_no:s.value.mobile_no||"",phone:s.value.phone||""}},Z=()=>{V.push({name:"CouncilDashboard",params:{councilCode:u.value}})};return(l,t)=>{var P,S,U,L,q,A,D,F,$,z;const M=Q("router-link");return r(),a("div",ee,[e("header",te,[e("div",oe,[e("div",se,[e("div",le,[e("button",{onClick:Z,class:"text-gray-500 hover:text-gray-700"},[...t[5]||(t[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])]),(P=o.value)!=null&&P.logo?(r(),a("div",ae,[e("img",{src:o.value.logo,alt:o.value.council_name,class:"h-full object-contain"},null,8,re)])):(r(),a("div",{key:1,class:"w-8 h-8 rounded flex items-center justify-center",style:c({backgroundColor:n.value})},[...t[6]||(t[6]=[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)])],4)),e("div",null,[t[7]||(t[7]=e("h1",{class:"text-xl font-bold text-gray-900"},"My Account",-1)),e("p",ne,d(((S=o.value)==null?void 0:S.council_name)||u.value),1)])]),(U=o.value)!=null&&U.allow_system_wide_dashboard?(r(),a("div",ie,[v(M,{to:{name:"Settings"},class:"text-gray-600 hover:text-gray-900"},{default:k(()=>[...t[8]||(t[8]=[y(" View All Councils â†’ ",-1)])]),_:1})])):b("",!0)])])]),e("main",de,[w.value?(r(),a("div",ue,[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2",style:c({borderColor:n.value})},null,4),t[9]||(t[9]=e("p",{class:"mt-4 text-gray-500"},"Loading account information...",-1))])):(r(),a("div",me,[e("div",ce,[t[16]||(t[16]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-6"},"Profile Information",-1)),e("div",ve,[e("div",{class:"w-24 h-24 rounded-full flex items-center justify-center",style:c({backgroundColor:`${n.value}20`,color:n.value})},[s.value.user_image?(r(),a("img",{key:1,src:s.value.user_image,alt:"Profile",class:"w-full h-full rounded-full object-cover"},null,8,pe)):(r(),a("span",ge,d(R.value),1))],4),e("div",null,[e("h3",fe,d(s.value.full_name),1),e("p",xe,d(s.value.email),1),e("p",ye,"Member since "+d(E(s.value.creation)),1)])]),e("form",{onSubmit:W(T,["prevent"]),class:"space-y-6"},[e("div",he,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"First Name",-1)),v(h(C),{modelValue:i.value.first_name,"onUpdate:modelValue":t[0]||(t[0]=g=>i.value.first_name=g),type:"text",required:""},null,8,["modelValue"])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Last Name",-1)),v(h(C),{modelValue:i.value.last_name,"onUpdate:modelValue":t[1]||(t[1]=g=>i.value.last_name=g),type:"text",required:""},null,8,["modelValue"])])]),e("div",be,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mobile Phone",-1)),v(h(C),{modelValue:i.value.mobile_no,"onUpdate:modelValue":t[2]||(t[2]=g=>i.value.mobile_no=g),type:"tel"},null,8,["modelValue"])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Phone",-1)),v(h(C),{modelValue:i.value.phone,"onUpdate:modelValue":t[3]||(t[3]=g=>i.value.phone=g),type:"tel"},null,8,["modelValue"])])]),e("div",ke,[v(h(I),{onClick:Y,variant:"outline",theme:"gray"},{default:k(()=>[...t[14]||(t[14]=[y(" Cancel ",-1)])]),_:1}),v(h(I),{type:"submit",variant:"solid",loading:p.value,style:c({backgroundColor:n.value,borderColor:n.value})},{default:k(()=>[...t[15]||(t[15]=[y(" Save Changes ",-1)])]),_:1},8,["loading","style"])])],32)]),e("div",we,[t[27]||(t[27]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"Council Information",-1)),e("p",_e,"You are registered with "+d(((L=o.value)==null?void 0:L.council_name)||u.value),1),e("div",{class:"p-6 rounded-lg",style:c({backgroundColor:`${n.value}10`,borderLeft:`4px solid ${n.value}`})},[e("div",Ce,[(q=o.value)!=null&&q.logo?(r(),a("div",Ve,[e("img",{src:o.value.logo,alt:o.value.council_name,class:"h-full object-contain"},null,8,je)])):(r(),a("div",{key:1,class:"w-16 h-16 rounded-lg flex items-center justify-center flex-shrink-0",style:c({backgroundColor:n.value})},[...t[17]||(t[17]=[e("svg",{class:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)])],4)),e("div",Me,[e("h3",Be,d((A=o.value)==null?void 0:A.council_name),1),(D=o.value)!=null&&D.official_name?(r(),a("p",He,d(o.value.official_name),1)):b("",!0),e("div",Ne,[(F=o.value)!=null&&F.contact_email?(r(),a("div",Pe,[t[18]||(t[18]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),y(" "+d(o.value.contact_email),1)])):b("",!0),($=o.value)!=null&&$.contact_phone?(r(),a("div",Se,[t[19]||(t[19]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})],-1)),y(" "+d(o.value.contact_phone),1)])):b("",!0),(z=o.value)!=null&&z.website?(r(),a("div",Ue,[t[20]||(t[20]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})],-1)),e("a",{href:o.value.website,target:"_blank",class:"hover:underline",style:c({color:n.value})},d(o.value.website),13,Le)])):b("",!0)])])])],4),e("div",qe,[v(M,{to:{name:"CouncilDashboard",params:{councilCode:u.value}},class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition"},{default:k(()=>[e("div",Ae,[(r(),a("svg",{class:"w-5 h-5",style:c({color:n.value}),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[21]||(t[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])],4)),t[22]||(t[22]=e("span",{class:"font-medium text-gray-900"},"My Requests",-1))]),t[23]||(t[23]=e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))]),_:1},8,["to"]),v(M,{to:{name:"NewRequest",query:{council:u.value,locked:"true"}},class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition"},{default:k(()=>[e("div",De,[(r(),a("svg",{class:"w-5 h-5",style:c({color:n.value}),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[24]||(t[24]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"},null,-1)])],4)),t[25]||(t[25]=e("span",{class:"font-medium text-gray-900"},"New Application",-1))]),t[26]||(t[26]=e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))]),_:1},8,["to"])])]),e("div",Fe,[t[29]||(t[29]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"Security",-1)),t[30]||(t[30]=e("p",{class:"text-gray-600 mb-6"},"Manage your password and security settings",-1)),e("button",{onClick:t[4]||(t[4]=g=>m.value=!0),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50"},[...t[28]||(t[28]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})],-1),y(" Change Password ",-1)])])])]))])])}}};export{Ie as default};
//# sourceMappingURL=CouncilAccount-icrIPwxs.js.map
