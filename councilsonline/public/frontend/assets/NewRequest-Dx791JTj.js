const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SaveDraftModal-CSep5FJ8.js","assets/frappe-ui-D6fYUZUl.js","assets/vue-vendor-B0shnPjy.js","assets/ui-components-CzNebsXy.js","assets/frappe-ui-BcYQ_VTL.css","assets/ValidationErrorModal-DAknucdX.js","assets/BookMeetingModal-DAzWoozx.js","assets/SubmissionSuccessModal-Cr8b_Xku.js","assets/SubmissionSuccessModal-ydH3POPv.css","assets/DynamicStepRenderer-BgnTH38c.js","assets/request.service--9QsRanG.js","assets/index-BiafFojb.js","assets/index-CUI3IHTd.css","assets/RequestHeader-CFcOgVuT.js","assets/DynamicStepRenderer-DrL_tQ_8.css"])))=>i.map(i=>d[i]);
var ee=Object.defineProperty,te=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var P=(e,t,s)=>t in e?ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,A=(e,t)=>{for(var s in t||(t={}))se.call(t,s)&&P(e,s,t[s]);if(F)for(var s of F(t))re.call(t,s)&&P(e,s,t[s]);return e},M=(e,t)=>te(e,oe(t));var b=(e,t,s)=>new Promise((r,p)=>{var n=c=>{try{i(s.next(c))}catch(g){p(g)}},l=c=>{try{i(s.throw(c))}catch(g){p(g)}},i=c=>c.done?r(c.value):Promise.resolve(c.value).then(n,l);i((s=s.apply(e,t)).next())});import{c as call,h as _sfc_main$6,k as _export_sfc,_ as __vitePreload}from"./frappe-ui-D6fYUZUl.js";import{am as defineStore,a5 as useRouter,B as ref,c as computed,aq as useRoute,w as watch,ar as onBeforeRouteLeave,a as createElementBlock,o as openBlock,b as createBaseVNode,Q as normalizeStyle,t as toDisplayString,O as createBlock,e as createCommentVNode,P as withCtx,a2 as createTextVNode,u as unref,ab as createSlots,F as Fragment,W as renderList,n as normalizeClass,aj as createStaticVNode,D as onMounted,R as createVNode,as as defineAsyncComponent,y as isRef}from"./vue-vendor-B0shnPjy.js";import{r as requestService}from"./request.service--9QsRanG.js";import{a as useSiteCouncilStore,s as session}from"./index-BiafFojb.js";import{_ as _sfc_main$7}from"./RequestHeader-CFcOgVuT.js";const useRequestStore=defineStore("request",{persist:{key:"requestStore",storage:localStorage,paths:["currentRequestId","formData","currentStep","requestTypeCode"]},state:()=>({currentRequestId:null,requestTypeCode:null,requestTypeConfig:null,formData:{},currentStep:0,stepValidationStatus:{},isSaving:!1,isSubmitting:!1,lastSaved:null,error:null}),getters:{isFirstStep:e=>e.currentStep===0,totalSteps:e=>{var t;return(t=e.requestTypeConfig)!=null&&t.steps?e.requestTypeConfig.steps.length+3:3},isLastStep:e=>e.currentStep===e.totalSteps-1,currentStepConfig:e=>{var t,s;return(s=(t=e.requestTypeConfig)==null?void 0:t.steps)==null?void 0:s[e.currentStep]},canNavigateNext:e=>e.stepValidationStatus[e.currentStep]===!0,completionPercentage:e=>e.totalSteps===0?0:Math.round((e.currentStep+1)/e.totalSteps*100),hasUnsavedChanges:e=>e.lastSaved?new Date-e.lastSaved>3e4:Object.keys(e.formData).length>0},actions:{nextStep(){var r;const e=this.currentStep+1,t=this.totalSteps-1;if(e>t){console.error("[Store] Navigation beyond bounds prevented",{currentStep:this.currentStep,newStep:e,maxStep:t});return}if(e>=2&&e<t&&((r=this.requestTypeConfig)!=null&&r.steps)){const p=e-2;if(!this.requestTypeConfig.steps[p]){console.error("[Store] Missing step config, redirecting to review",{currentStep:this.currentStep,newStep:e,configIndex:p,totalConfigSteps:this.requestTypeConfig.steps.length}),this.currentStep=t;return}}this.currentStep=e},previousStep(){this.isFirstStep||this.currentStep--},goToStep(e){e>=0&&e<this.totalSteps&&(this.currentStep=e)},initialize(e,t=null){return b(this,null,function*(){try{this.requestTypeCode=e,this.error=null,console.log("[RequestStore] initialize called:",{requestTypeCode:e,draftId:t});const s=requestService.getRequestTypeConfig(e);yield new Promise(r=>{const p=setInterval(()=>{s.loading||(clearInterval(p),r())},100)}),this.requestTypeConfig=s.data,t&&(yield this.loadDraft(t))}catch(s){console.error("Failed to initialize request:",s),this.error=s.message||"Failed to load request type"}})},loadDraft(e){return b(this,null,function*(){try{const t=requestService.getRequest(e);yield new Promise(n=>{const l=setInterval(()=>{t.loading||(clearInterval(l),n())},100)});const s=t.data;if(this.currentRequestId=e,s.draft_full_data)try{this.formData=JSON.parse(s.draft_full_data)}catch(n){console.error("Failed to parse draft_full_data:",n),this.formData=s.form_data||{}}else this.formData=s.form_data||{};const r=s.draft_current_step||0,p=this.totalSteps-1;this.currentStep=Math.min(Math.max(0,r),p),r!==this.currentStep&&console.warn(`[RequestStore] Draft had invalid step ${r}, clamped to ${this.currentStep} (max: ${p})`)}catch(t){console.error("Failed to load draft:",t),this.error=t.message||"Failed to load draft"}})},saveProgress(){return b(this,null,function*(){if(this.isSaving){console.log("[RequestStore] Save already in progress, skipping");return}this.currentRequestId&&!this.formData.request_id&&(console.warn("[RequestStore] Syncing request_id to formData"),this.formData.request_id=this.currentRequestId),console.log("[RequestStore] saveProgress called",{hasRequestId:!!this.currentRequestId,formDataHasId:!!this.formData.request_id,currentStep:this.currentStep,isSaving:this.isSaving}),this.isSaving=!0,this.error=null;try{const e={};for(const[s,r]of Object.entries(this.formData)){if(r instanceof File){console.warn(`[RequestStore] Skipping File object for key: ${s}`);continue}if(Array.isArray(r)&&r.length>0&&r.some(n=>n&&typeof n=="object"&&n.file_url)){const n=r[0].file_url;if(n&&typeof n=="string"){console.log(`[RequestStore] Converting file array to URL string for ${s}:`,n),e[s]=n;continue}else{console.warn(`[RequestStore] File array for ${s} does not have valid file_url, skipping`);continue}}r!=null&&(e[s]=r)}if(Object.keys(e).length===0&&!this.currentRequestId)throw new Error("No form data to save. Please fill in at least one field.");console.log("[RequestStore] Sending sanitized data with",Object.keys(e).length,"fields"),console.log("[RequestStore] Sanitized data keys:",Object.keys(e)),console.log("[RequestStore] Sanitized data:",JSON.stringify(e,null,2));const t=yield requestService.createDraft(e,this.currentStep);return this.currentRequestId||(this.currentRequestId=t.request_id,this.formData.request_id=t.request_id,localStorage.setItem("current_draft_id",t.request_id)),this.lastSaved=new Date,t}catch(e){throw console.error("Save failed:",e),this.error=e.message||"Failed to save progress",e}finally{this.isSaving=!1}})},saveDraft(){return b(this,null,function*(){return this.saveProgress()})},submitRequest(){return b(this,null,function*(){this.isSubmitting=!0,this.error=null;try{this.currentRequestId||(yield this.saveProgress());const e=yield requestService.submitRequest(this.currentRequestId);return this.reset(),e}catch(e){throw console.error("Submit failed:",e),this.error=e.message||"Failed to submit request",e}finally{this.isSubmitting=!1}})},updateField(e,t){this.formData[e]=t},updateFields(e){Object.assign(this.formData,e)},setStepValidation(e,t){this.stepValidationStatus[e]=t},clearError(){this.error=null},reset(){console.log("[RequestStore] reset() called - clearing all state"),this.currentRequestId=null,this.requestTypeCode=null,this.requestTypeConfig=null,Object.keys(this.formData).forEach(e=>{delete this.formData[e]}),this.formData={},this.currentStep=0,this.stepValidationStatus={},this.isSaving=!1,this.isSubmitting=!1,this.lastSaved=null,this.error=null,localStorage.removeItem("current_draft_id")}}});function useRequestModals(){const e=useRouter(),t=useRequestStore(),s=ref(!1),r=ref(!1),p=ref(!1),n=ref(!1),l=ref(null);function i(){p.value=!0}function c(d){console.log("Meeting booked:",d),p.value=!1}function g(d){r.value=!0}function o(){return b(this,null,function*(){try{yield t.saveDraft(),t.currentRequestId?e.push(`/request/${t.currentRequestId}`):s.value=!0}catch(d){console.error("Failed to save draft:",d)}})}function a(){return b(this,null,function*(){try{yield t.saveDraft(),t.reset(),e.push({name:"Dashboard"})}catch(d){console.error("Failed to save draft:",d)}})}function u(){return b(this,null,function*(){try{const d=yield t.submitRequest();l.value=d,n.value=!0,yield _(),yield y()}catch(d){console.error("Failed to submit request:",d)}})}function _(){return b(this,null,function*(){const d=t.formData;if(!d)return;const f={};if(d.birth_date&&(f.birth_date=d.birth_date),d.sex&&(f.sex=d.sex),d.civil_status&&(f.civil_status=d.civil_status),d.mobile_number&&(f.mobile_number=d.mobile_number),d.address_line&&(f.address_line=d.address_line),d.barangay&&(f.barangay=d.barangay),d.municipality&&(f.municipality=d.municipality),d.province&&(f.province=d.province),d.philsys_id&&(f.philsys_id=d.philsys_id),d.sss_number&&(f.sss_number=d.sss_number),d.osca_id&&(f.osca_id=d.osca_id),d.monthly_income!==void 0&&(f.monthly_income=d.monthly_income),d.income_source&&(f.income_source=d.income_source),d.household_size!==void 0&&(f.household_size=d.household_size),d.living_arrangement&&(f.living_arrangement=d.living_arrangement),d.is_4ps_beneficiary!==void 0&&(f.is_4ps_beneficiary=d.is_4ps_beneficiary),d.payment_preference&&(f.payment_preference=d.payment_preference),d.bank_name&&(f.bank_name=d.bank_name),d.bank_account_number&&(f.bank_account_number=d.bank_account_number),d.bank_account_holder&&(f.bank_account_holder=d.bank_account_holder),Object.keys(f).length>0)try{const x=yield call("councilsonline.api.auth.save_personal_info_to_profile",f);x&&x.fields_count>0&&console.log(`Saved ${x.fields_count} fields to user profile`)}catch(x){console.error("Failed to save personal info to profile:",x)}})}function y(){return b(this,null,function*(){const d=t.formData;if(!d)return;const f=["residential_address","address","property_address","applicant_address"];for(const x of f){const B=d[x];if(B&&typeof B=="object"&&B._save_to_profile)try{yield call("councilsonline.api.auth.add_user_property",{street:B.address_line,barangay:B.barangay,municipality:B.municipality,province:B.province,zip_code:B.zip_code,is_default:!1}),console.log(`Property saved to profile from field: ${x}`)}catch(C){console.error(`Failed to save property from ${x}:`,C)}}})}function h(d){n.value=!1,e.push(`/request/${d}`)}function V(){n.value=!1;const d=t.formData.council;d?e.push(`/council/${d}/dashboard`):e.push("/dashboard")}return{showSaveDraftModal:s,showValidationModal:r,showMeetingModal:p,showSubmissionSuccessModal:n,submissionResult:l,handleBookMeeting:i,handleMeetingBooked:c,showValidationErrors:g,handleSaveDraft:o,handleSaveAndClose:a,handleSubmit:u,handleViewRequestFromModal:h,handleGoToDashboardFromModal:V}}function useStepConfiguration(){const e=useRequestStore(),t=useSiteCouncilStore(),s=computed(()=>{var o;return(o=e.requestTypeConfig)!=null&&o.steps?e.requestTypeConfig.steps.length+3:3}),r=computed(()=>{var a;const o=["Type","Process Info"];return(a=e.requestTypeConfig)!=null&&a.steps&&o.push(...e.requestTypeConfig.steps.map(u=>u.step_title)),o.push("Review"),o}),p=computed(()=>{var o;return((o=e.requestTypeConfig)==null?void 0:o.steps)&&e.requestTypeConfig.steps.length>0}),n=computed(()=>{var a;if(!((a=e.requestTypeConfig)!=null&&a.steps))return null;const o=e.currentStep-2;return o>=0&&o<e.requestTypeConfig.steps.length?e.requestTypeConfig.steps[o]:null}),l=computed(()=>{var o;return e.currentStep>1&&e.currentStep<s.value-1&&((o=e.requestTypeConfig)==null?void 0:o.council_meeting_available)===1});function i(){const o=e.currentStep;return o>=0&&o<r.value.length?r.value[o]:""}function c(){var u;const o=e.currentStep,a=2;if(o<a||o>=s.value-1)return null;if((u=e.requestTypeConfig)!=null&&u.steps){const _=o-a;if(_>=0&&_<e.requestTypeConfig.steps.length)return e.requestTypeConfig.steps[_]}return null}function g(){var o;return((o=t.councilData)==null?void 0:o.council_name)||"Council"}return{totalSteps:s,stepTitles:r,usesConfigurableSteps:p,currentStepConfig:n,shouldShowMeetingBanner:l,getCurrentStepTitle:i,getCurrentStepConfig:c,getCouncilName:g}}function evaluateCondition(e,t){if(!e||e.trim()==="")return!0;let s=e.trim();s.startsWith("eval:")&&(s=s.substring(5).trim());try{return new Function("formData","doc",`
      'use strict';
      try {
        return Boolean(${s});
      } catch (e) {
        console.warn('[Conditional Logic] Evaluation error:', e.message);
        return false;
      }
    `)(t,t)}catch(r){return console.error("[Conditional Logic] Failed to evaluate expression:",e,r),!0}}function isSectionVisible(e,t){return!e||!e.is_enabled?!1:e.depends_on?evaluateCondition(e.depends_on,t):!0}function isFieldVisible(e,t){return e?e.depends_on?evaluateCondition(e.depends_on,t):!0:!1}function validateEmail(e){return e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e):!0}function validatePhone(e){return e?/^[\+]?[(]?[0-9]{1,4}[)]?[-\s\.]?[(]?[0-9]{1,4}[)]?[-\s\.]?[0-9]{1,9}$/.test(e.replace(/\s/g,"")):!0}function validateUrl(e){if(!e)return!0;try{return new URL(e),!0}catch(t){return!1}}function validateNumber(e){return e===""||e===null||e===void 0?!0:!isNaN(Number.parseFloat(e))&&isFinite(e)}function evaluateCustomValidation(e,t,s){let r=e.trim();r.startsWith("eval:")&&(r=r.substring(5).trim());try{return new Function("formData","value",`
			'use strict';
			try {
				return Boolean(${r});
			} catch (e) {
				console.warn('[Field Validation] Evaluation error:', e.message);
				return true; // Fail open on evaluation error
			}
		`)(s,t)}catch(p){return console.error("[Field Validation] Failed to evaluate expression:",e,p),!0}}function validateField(e,t,s={}){if(!t)return{valid:!0,message:""};const r=t.toLowerCase();switch(r){case"email":if(!validateEmail(e))return{valid:!1,message:"Please enter a valid email address"};break;case"phone":if(!validatePhone(e))return{valid:!1,message:"Please enter a valid phone number"};break;case"url":if(!validateUrl(e))return{valid:!1,message:"Please enter a valid URL"};break;case"number":if(!validateNumber(e))return{valid:!1,message:"Please enter a valid number"};break;default:if(r.startsWith("min_age:")){const p=parseInt(r.split(":")[1],10);if(e&&!isNaN(p)){const n=new Date,l=new Date(e);let i=n.getFullYear()-l.getFullYear();const c=n.getMonth()-l.getMonth();if((c<0||c===0&&n.getDate()<l.getDate())&&i--,i<p)return{valid:!1,message:`Applicant must be ${p} years or older`}}break}if(t.startsWith("eval:")&&!evaluateCustomValidation(t,e,s))return{valid:!1,message:"Validation failed"}}return{valid:!0,message:""}}function useStepValidation(){const e=ref({}),t=ref(!1);function s(i,c,g,o={}){const a=validateField(c,g.validation,o);return a.valid?g.is_required&&(c===""||c===null||c===void 0)?(e.value[i]=`${g.field_label} is required`,!1):(delete e.value[i],!0):(e.value[i]=a.message,!1)}function r(i,c){return b(this,null,function*(){t.value=!0,e.value={};let g=!0;for(const o of i.sections||[])if(!(o.depends_on&&!p(o.depends_on,c)))for(const a of o.fields||[]){if(a.depends_on&&!p(a.depends_on,c))continue;let u=c[a.field_name];if(["barangay","municipality","province","city","region","zip_code","postal_code"].includes(a.field_name)&&!u){const h=c.address_line||c.street||c.residential_address||c.property_address;h&&typeof h=="object"&&(u=h[a.field_name])}s(a.field_name,u,a,c)||(g=!1)}return t.value=!1,g})}function p(i,c){try{return evaluateCondition(i,c)}catch(g){return console.error("Error evaluating depends_on:",g),!0}}function n(){e.value={}}function l(i){delete e.value[i]}return{errors:e,isValidating:t,validateConfigField:s,validateStep:r,clearErrors:n,clearFieldError:l}}function useRequestFormNavigation(e={}){const t=useRouter(),s=useRequestStore(),{errors:r,validateStep:p}=useStepValidation(),{getCurrentStepConfig:n=()=>null,totalSteps:l=computed(()=>3),usesConfigurableSteps:i=computed(()=>!1),onValidationError:c=()=>{}}=e,g=computed(()=>!0),o=computed(()=>s.currentStep>=2);function a(){return b(this,null,function*(){if(s.currentStep===0&&!s.formData.request_type){alert("Please select a request type before continuing.");return}if(s.currentStep>=1&&i.value&&n()){const y=n();if(!(yield p(y,s.formData))){console.error("[Navigation] Validation failed:",r.value),c(r.value);return}}if(s.currentStep===1&&!s.currentRequestId&&(console.log("[Navigation] Auto-saving draft after Process Info step..."),yield s.saveDraft(),console.log("[Navigation] Draft saved with ID:",s.currentRequestId),!i.value&&s.currentRequestId)){console.log("[Navigation] No dynamic steps, redirecting to detail page..."),t.push(`/request/${s.currentRequestId}`);return}s.currentRequestId&&(yield s.saveProgress()),s.currentStep<l.value-1&&s.nextStep()})}function u(){s.previousStep()}function _(){s.reset(),t.push("/dashboard")}return{canNavigateNext:g,canSaveDraft:o,validationErrors:r,handleNext:a,handlePrevious:u,goBack:_}}const userProfile=ref(null),loading=ref(!1),error=ref(null);function useUserProfile(){const e=()=>b(this,null,function*(){loading.value=!0,error.value=null;try{const o={"Content-Type":"application/json"};window.csrf_token&&(o["X-Frappe-CSRF-Token"]=window.csrf_token);const u=yield(yield fetch("/api/method/councilsonline.api.get_user_profile",{method:"GET",headers:o,credentials:"include"})).json();if(u.message)return userProfile.value=u.message,userProfile.value;throw new Error("Failed to load profile")}catch(o){return error.value=o.message,console.error("Error loading user profile:",o),null}finally{loading.value=!1}}),t=computed(()=>{var o;return(o=userProfile.value)!=null&&o.properties?userProfile.value.properties.find(a=>a.is_default)||userProfile.value.properties[0]:null}),s=computed(()=>{var o;return(o=userProfile.value)!=null&&o.councils?userProfile.value.councils.find(a=>a.is_default)||userProfile.value.councils[0]:null}),r=()=>{if(!userProfile.value)return{};const o=userProfile.value,a={};if(s.value&&(a.council=s.value.council_id,a.council_name=s.value.council_name),a.requester_name=o.full_name,a.requester_email=o.user,a.requester_phone=o.phone,a.requester_type=o.user_role,o.user_role==="Individual"&&o.postal_street&&(a.applicant_address=`${o.postal_street}, ${o.postal_suburb||""}, ${o.postal_city||""} ${o.postal_postcode||""}`.trim()),o.user_role==="Agent"&&(a.agent_required=!0,a.agent_id=o.user,a.agent_company=o.company_name,a.agent_email=o.business_email||o.user,a.agent_phone=o.business_phone||o.phone,o.business_street&&(a.agent_address=`${o.business_street}, ${o.business_suburb||""}, ${o.business_city||""} ${o.business_postcode||""}`.trim()),o.default_communication_route&&(a.correspondence_recipient=o.default_communication_route==="Agent Only"?"Agent":"Both"),o.default_invoice_recipient&&(a.invoice_responsible_party=o.default_invoice_recipient)),t.value){const u=t.value;a.property=`${u.street}, ${u.suburb||""}, ${u.city||""} ${u.postcode||""}`.trim(),a.property_address=a.property,a.property_legal_description=u.legal_description,a.ownership_status=u.ownership_status}return(o.comm_email||o.comm_phone||o.comm_post)&&(a.communication_preferences={email:o.comm_email||!1,phone:o.comm_phone||!1,post:o.comm_post||!1}),o.invoice_preference&&(a.invoice_delivery_method=o.invoice_preference),o.birth_date&&(a.birth_date=o.birth_date),o.sex&&(a.sex=o.sex),o.civil_status&&(a.civil_status=o.civil_status),o.phone&&(a.mobile_number=o.phone),o.postal_street&&(a.address_line=o.postal_street),o.postal_suburb&&(a.barangay=o.postal_suburb),o.postal_city&&(a.municipality=o.postal_city),o.postal_province&&(a.province=o.postal_province),o.philsys_id&&(a.philsys_id=o.philsys_id),o.sss_number&&(a.sss_number=o.sss_number),o.osca_id&&(a.osca_id=o.osca_id),o.monthly_income!==void 0&&o.monthly_income!==null&&(a.monthly_income=o.monthly_income),o.income_source&&(a.income_source=o.income_source),o.household_size!==void 0&&o.household_size!==null&&(a.household_size=o.household_size),o.living_arrangement&&(a.living_arrangement=o.living_arrangement),o.is_4ps_beneficiary!==void 0&&(a.is_4ps_beneficiary=o.is_4ps_beneficiary),o.preferred_payment_method&&(a.payment_preference=o.preferred_payment_method),o.bank_name&&(a.bank_name=o.bank_name),o.bank_account_number&&(a.bank_account_number=o.bank_account_number),o.bank_account_holder&&(a.bank_account_holder=o.bank_account_holder),a},p=(o,a={})=>{const{overrideExisting:u=!1,fieldsToSkip:_=[]}=a,y=r();return Object.keys(y).forEach(h=>{_.includes(h)||!u&&o[h]||(o[h]=y[h])}),o},n=computed(()=>{var o;return((o=userProfile.value)==null?void 0:o.properties)||[]}),l=computed(()=>{var o;return((o=userProfile.value)==null?void 0:o.councils)||[]}),i=computed(()=>{var o;return((o=userProfile.value)==null?void 0:o.clients)||[]}),c=computed(()=>{var u,_,y;if(!userProfile.value)return!1;const o=userProfile.value,a=o.full_name&&o.phone&&o.user_role;return o.user_role==="Individual"?a&&(((u=o.properties)==null?void 0:u.length)>0||!1)&&(((_=o.councils)==null?void 0:_.length)>0||!1):o.user_role==="Agent"?a&&o.company_name&&(((y=o.councils)==null?void 0:y.length)>0||!1):a}),g=computed(()=>{if(!userProfile.value)return 0;const o=userProfile.value;let a=0,u=0;return["full_name","phone","user_role"].forEach(y=>{u++,o[y]&&a++}),u++,(o.comm_email||o.comm_phone||o.comm_post)&&a++,u++,o.properties&&o.properties.length>0&&a++,u++,o.councils&&o.councils.length>0&&a++,o.user_role==="Agent"?(u++,o.company_name&&a++):(u++,o.postal_street&&a++),Math.round(a/u*100)});return{userProfile,loading,error,loadUserProfile:e,getApplicationAutoFill:r,applyAutoFill:p,defaultProperty:t,defaultCouncil:s,getAllProperties:n,getAllCouncils:l,getAllClients:i,isProfileComplete:c,profileCompletionPercentage:g}}function useRequestLifecycle(e={}){const t=useRoute();useRouter();const s=useRequestStore(),r=useSiteCouncilStore(),{onRequestTypeSelected:p=()=>{}}=e,n=ref({loading:!1,data:[]}),l=ref(null);function i(){return b(this,null,function*(){n.value.loading=!0,yield r.loadCouncil(),n.value={loading:!1,data:r.availableRequestTypes||[]}})}function c(u){return b(this,null,function*(){if(s.updateField("request_type",u),yield s.initialize(u),l.value=s.requestTypeConfig,!s.requestTypeConfig){console.error("[Lifecycle] Failed to load request type config");return}p(u)})}function g(){return b(this,null,function*(){const u=t.query.type,_=t.query.draft;if(console.log("[Lifecycle] Initialization - type:",u,"draft:",_),!_&&!t.query.draft&&s.reset(),!_){const{getApplicationAutoFill:y,applyAutoFill:h}=useUserProfile();try{yield y(),h(s.formData,{overrideExisting:!1})}catch(V){console.warn("[Lifecycle] Failed to load user profile for auto-fill:",V)}}if(_&&u){yield s.initialize(u,_),l.value=s.requestTypeConfig;return}yield i(),u&&!_&&(console.log("[Lifecycle] Request type provided in URL:",u),yield s.initialize(u),l.value=s.requestTypeConfig,s.updateField("request_type",u),s.currentStep=1,console.log("[Lifecycle] Advanced to step 1 (Process Info)"))})}function o(){onBeforeRouteLeave((u,_,y)=>{if(s.isSubmitting||!s.currentRequestId){s.reset(),y();return}s.formData&&Object.keys(s.formData).some(V=>s.formData[V]!==void 0&&s.formData[V]!==null&&s.formData[V]!=="")&&!confirm("You have unsaved changes. Do you want to leave without saving?")?y(!1):(u.path.includes("/request/")||s.reset(),y())})}function a(){watch(()=>s.formData.birth_date,u=>{if(u){const _=new Date,y=new Date(u);let h=_.getFullYear()-y.getFullYear();const V=_.getMonth()-y.getMonth();(V<0||V===0&&_.getDate()<y.getDate())&&h--,s.updateField("age",h)}})}return{requestTypes:n,selectedRequestTypeDetails:l,loadRequestTypes:i,selectRequestType:c,initialize:g,setupRouteGuard:o,setupAgeValidation:a}}const _hoisted_1$5={class:"mb-8"},_hoisted_2$5={class:"relative mb-6"},_hoisted_3$5={class:"overflow-hidden h-2 text-xs flex rounded bg-gray-200"},_hoisted_4$4={class:"flex justify-between mt-2"},_hoisted_5$4={class:"text-sm font-medium text-gray-700"},_hoisted_6$4={class:"text-sm font-medium text-gray-700"},_sfc_main$5={__name:"RequestProgress",props:{currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0},stepTitles:{type:Array,default:()=>[]}},setup(e){const t=e,s=computed(()=>t.totalSteps===0?0:Math.round((t.currentStep+1)/t.totalSteps*100));return(r,p)=>(openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("div",_hoisted_2$5,[createBaseVNode("div",_hoisted_3$5,[createBaseVNode("div",{style:normalizeStyle({width:s.value+"%"}),class:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-600 transition-all duration-500"},null,4)]),createBaseVNode("div",_hoisted_4$4,[createBaseVNode("span",_hoisted_5$4,toDisplayString(e.stepTitles[e.currentStep]||`Step ${e.currentStep+1}`),1),createBaseVNode("span",_hoisted_6$4,toDisplayString(s.value)+"% Complete ",1)])])]))}},_hoisted_1$4={class:"mt-8 pt-6 border-t border-gray-200"},_hoisted_2$4={class:"flex items-center justify-between"},_hoisted_3$4={class:"flex items-center space-x-3"},_sfc_main$4={__name:"StepNavigation",props:{currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0},isLastStep:{type:Boolean,default:!1},canGoNext:{type:Boolean,default:!0},canSaveDraft:{type:Boolean,default:!0},isSaving:{type:Boolean,default:!1},isSubmitting:{type:Boolean,default:!1}},emits:["next","previous","save-draft","submit"],setup(e,{emit:t}){const s=t,r=()=>{s("next")},p=()=>{s("previous")},n=()=>{s("save-draft")},l=()=>{s("submit")};return(i,c)=>(openBlock(),createElementBlock("div",_hoisted_1$4,[createBaseVNode("div",_hoisted_2$4,[createBaseVNode("div",null,[e.currentStep>0?(openBlock(),createBlock(unref(_sfc_main$6),{key:0,onClick:p,variant:"outline",disabled:e.isSaving||e.isSubmitting},{prefix:withCtx(()=>[...c[0]||(c[0]=[createBaseVNode("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),default:withCtx(()=>[c[1]||(c[1]=createTextVNode(" Previous ",-1))]),_:1},8,["disabled"])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_3$4,[e.canSaveDraft?(openBlock(),createBlock(unref(_sfc_main$6),{key:0,onClick:n,variant:"outline",loading:e.isSaving,disabled:e.isSubmitting},createSlots({default:withCtx(()=>[createTextVNode(" "+toDisplayString(e.isSaving?"Saving...":"Save Draft"),1)]),_:2},[e.isSaving?void 0:{name:"prefix",fn:withCtx(()=>[c[2]||(c[2]=createBaseVNode("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})],-1))]),key:"0"}]),1032,["loading","disabled"])):createCommentVNode("",!0),e.isLastStep?(openBlock(),createBlock(unref(_sfc_main$6),{key:2,onClick:l,variant:"solid",theme:"green",loading:e.isSubmitting,disabled:!e.canGoNext||e.isSaving},createSlots({default:withCtx(()=>[createTextVNode(" "+toDisplayString(e.isSubmitting?"Submitting...":"Submit Application"),1)]),_:2},[e.isSubmitting?void 0:{name:"prefix",fn:withCtx(()=>[c[5]||(c[5]=createBaseVNode("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1))]),key:"0"}]),1032,["loading","disabled"])):(openBlock(),createBlock(unref(_sfc_main$6),{key:1,onClick:r,variant:"solid",theme:"blue",disabled:!e.canGoNext||e.isSaving||e.isSubmitting},{suffix:withCtx(()=>[...c[3]||(c[3]=[createBaseVNode("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])]),default:withCtx(()=>[c[4]||(c[4]=createTextVNode(" Next ",-1))]),_:1},8,["disabled"]))])]),c[6]||(c[6]=createBaseVNode("div",{class:"mt-4 text-center"},[createBaseVNode("p",{class:"text-sm text-gray-500"}," Your progress is automatically saved. You can return to complete this application later. ")],-1))]))}},_hoisted_1$3={key:0,class:"text-center py-12"},_hoisted_2$3={key:1,class:"grid md:grid-cols-2 gap-4"},_hoisted_3$3=["onClick"],_hoisted_4$3={class:"flex items-start justify-between"},_hoisted_5$3={class:"flex-1"},_hoisted_6$3={class:"text-lg font-semibold text-gray-900 mb-2"},_hoisted_7$3=["innerHTML"],_hoisted_8$3={class:"mt-4 flex items-center space-x-4 text-xs text-gray-500"},_hoisted_9$3={key:0},_hoisted_10$3={key:1},_hoisted_11$3={key:2,class:"px-2 py-1 bg-gray-100 rounded"},_hoisted_12$3={key:0,class:"ml-4"},_sfc_main$3={__name:"Step2RequestType",props:{modelValue:{type:Object,required:!0},requestTypes:{type:Object,required:!0}},emits:["update:modelValue","type-selected"],setup(e,{emit:t}){const s=e,r=t,p=n=>{console.log("[Step2RequestType] selectType called with:",n.name),console.log("[Step2RequestType] props.modelValue:",s.modelValue),console.log("[Step2RequestType] props.modelValue.council:",s.modelValue.council);const l=M(A({},s.modelValue),{request_type:n.name});console.log("[Step2RequestType] Emitting updatedValue:",l),r("update:modelValue",l),r("type-selected",n.name)};return(n,l)=>(openBlock(),createElementBlock("div",null,[l[2]||(l[2]=createBaseVNode("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Select Application Type",-1)),l[3]||(l[3]=createBaseVNode("p",{class:"text-gray-600 mb-8"},"Choose the type of consent you wish to apply for",-1)),e.requestTypes.loading?(openBlock(),createElementBlock("div",_hoisted_1$3,[...l[0]||(l[0]=[createBaseVNode("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)])])):(openBlock(),createElementBlock("div",_hoisted_2$3,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.requestTypes.data,i=>(openBlock(),createElementBlock("div",{key:i.name,onClick:c=>p(i),class:normalizeClass(["border-2 rounded-lg p-6 cursor-pointer transition-all hover:shadow-md",e.modelValue.request_type===i.name?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-300"])},[createBaseVNode("div",_hoisted_4$3,[createBaseVNode("div",_hoisted_5$3,[createBaseVNode("h3",_hoisted_6$3,toDisplayString(i.type_name),1),createBaseVNode("p",{class:"text-sm text-gray-600",innerHTML:i.description||"No description available"},null,8,_hoisted_7$3),createBaseVNode("div",_hoisted_8$3,[i.base_fee?(openBlock(),createElementBlock("span",_hoisted_9$3,"Fee: $"+toDisplayString(i.base_fee),1)):createCommentVNode("",!0),i.processing_sla_days?(openBlock(),createElementBlock("span",_hoisted_10$3,toDisplayString(i.processing_sla_days)+" days",1)):createCommentVNode("",!0),i.category?(openBlock(),createElementBlock("span",_hoisted_11$3,toDisplayString(i.category),1)):createCommentVNode("",!0)])]),e.modelValue.request_type===i.name?(openBlock(),createElementBlock("div",_hoisted_12$3,[...l[1]||(l[1]=[createBaseVNode("div",{class:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center"},[createBaseVNode("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)])])):createCommentVNode("",!0)])],10,_hoisted_3$3))),128))]))]))}},_hoisted_1$2={class:"text-gray-600 mb-6"},_hoisted_2$2={key:0,class:"space-y-6"},_hoisted_3$2={class:"bg-white border border-gray-200 rounded-lg p-6"},_hoisted_4$2={class:"flex items-start justify-between mb-4"},_hoisted_5$2={class:"text-xl font-semibold text-gray-900"},_hoisted_6$2={key:0,class:"text-sm text-gray-500 mt-1"},_hoisted_7$2={class:"grid md:grid-cols-3 gap-4 mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"},_hoisted_8$2={class:"text-2xl font-bold text-blue-900 mt-1"},_hoisted_9$2={class:"text-2xl font-bold text-blue-900 mt-1"},_hoisted_10$2={class:"text-2xl font-bold text-blue-900 mt-1"},_hoisted_11$2={key:0,class:"bg-white border border-gray-200 rounded-lg p-6"},_hoisted_12$2=["innerHTML"],_hoisted_13$2={key:1,class:"bg-white border border-gray-200 rounded-lg p-6"},_hoisted_14$1=["innerHTML"],_hoisted_15$1={key:1,class:"text-center py-12"},_sfc_main$2={__name:"Step3ProcessInfo",props:{requestTypeDetails:{type:Object,default:null},councilName:{type:String,default:""},modelValue:{type:Object,default:()=>({})}},emits:["continue","update:modelValue"],setup(e,{emit:t}){const s=useRouter(),r=t,p=()=>{if(!session.isLoggedIn){const n=window.location.pathname+window.location.search;s.push({name:"Login",query:{redirect:n}});return}r("continue")};return(n,l)=>(openBlock(),createElementBlock("div",null,[l[11]||(l[11]=createBaseVNode("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Council Process Information",-1)),createBaseVNode("p",_hoisted_1$2,"Understanding "+toDisplayString(e.councilName)+"'s process for this application",1),e.requestTypeDetails?(openBlock(),createElementBlock("div",_hoisted_2$2,[createBaseVNode("div",_hoisted_3$2,[createBaseVNode("div",_hoisted_4$2,[createBaseVNode("div",null,[createBaseVNode("h3",_hoisted_5$2,toDisplayString(e.requestTypeDetails.request_type_name),1),e.requestTypeDetails.category?(openBlock(),createElementBlock("p",_hoisted_6$2,toDisplayString(e.requestTypeDetails.category),1)):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_7$2,[createBaseVNode("div",null,[l[0]||(l[0]=createBaseVNode("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Application Fee",-1)),createBaseVNode("div",_hoisted_8$2," $"+toDisplayString(e.requestTypeDetails.base_fee||"0"),1),l[1]||(l[1]=createBaseVNode("div",{class:"text-xs text-blue-600 mt-1"},"Plus any additional costs",-1))]),createBaseVNode("div",null,[l[3]||(l[3]=createBaseVNode("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Processing Time",-1)),createBaseVNode("div",_hoisted_9$2,[createTextVNode(toDisplayString(e.requestTypeDetails.sla_days||"N/A")+" ",1),l[2]||(l[2]=createBaseVNode("span",{class:"text-base"},"days",-1))]),l[4]||(l[4]=createBaseVNode("div",{class:"text-xs text-blue-600 mt-1"},"Standard timeframe",-1))]),createBaseVNode("div",null,[l[5]||(l[5]=createBaseVNode("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Payment Required",-1)),createBaseVNode("div",_hoisted_10$2,toDisplayString(e.requestTypeDetails.requires_payment?"Yes":"No"),1),l[6]||(l[6]=createBaseVNode("div",{class:"text-xs text-blue-600 mt-1"},"Before processing",-1))])])]),e.requestTypeDetails.process_description?(openBlock(),createElementBlock("div",_hoisted_11$2,[l[7]||(l[7]=createBaseVNode("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"How This Works",-1)),createBaseVNode("div",{class:"prose prose-sm max-w-none text-gray-700",innerHTML:e.requestTypeDetails.process_description},null,8,_hoisted_12$2)])):e.requestTypeDetails.description?(openBlock(),createElementBlock("div",_hoisted_13$2,[l[8]||(l[8]=createBaseVNode("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"About This Application",-1)),createBaseVNode("div",{class:"prose prose-sm max-w-none text-gray-700",innerHTML:e.requestTypeDetails.description},null,8,_hoisted_14$1)])):createCommentVNode("",!0),l[9]||(l[9]=createStaticVNode('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><div class="flex items-start"><svg class="w-5 h-5 text-yellow-600 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg><div><h5 class="font-semibold text-yellow-900 text-sm">Before You Continue</h5><p class="text-yellow-800 text-sm mt-1"> Please review this information carefully. Make sure you understand the process, fees, and timeframes before proceeding with your application. </p></div></div></div>',1)),createBaseVNode("div",{class:"flex justify-center pt-4"},[createBaseVNode("button",{type:"button",onClick:p,class:"px-8 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors"}," I Understand - Continue to Application ")])])):(openBlock(),createElementBlock("div",_hoisted_15$1,[...l[10]||(l[10]=[createBaseVNode("p",{class:"text-gray-500"},"No request type selected. Please go back and select a request type.",-1)])]))]))}},_hoisted_1$1={class:"px-4 sm:px-0"},_hoisted_2$1={class:"space-y-4 sm:space-y-6"},_hoisted_3$1={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 sm:p-6"},_hoisted_4$1={class:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-0"},_hoisted_5$1={class:"text-base sm:text-lg font-semibold text-blue-900"},_hoisted_6$1={class:"text-xs sm:text-sm text-blue-700 mt-1"},_hoisted_7$1={class:"sm:text-right"},_hoisted_8$1={class:"text-xl sm:text-2xl font-bold text-blue-900"},_hoisted_9$1={key:0,class:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg overflow-hidden"},_hoisted_10$1={class:"p-4 sm:p-6"},_hoisted_11$1={class:"grid md:grid-cols-3 gap-4"},_hoisted_12$1={class:"flex items-center gap-3"},_hoisted_13$1={key:0,class:"text-xs text-green-600"},_hoisted_14={key:1,class:"text-xs text-red-600"},_hoisted_15={class:"flex items-center gap-3"},_hoisted_16={key:0,class:"text-xs text-green-600"},_hoisted_17={key:1,class:"text-xs text-yellow-600"},_hoisted_18={class:"flex items-center gap-3"},_hoisted_19={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_hoisted_20={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_hoisted_21={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},_hoisted_22={class:"p-4 sm:p-6 space-y-3"},_hoisted_23={class:"grid md:grid-cols-2 gap-4"},_hoisted_24={class:"font-medium"},_hoisted_25={class:"font-medium"},_hoisted_26={class:"font-medium"},_hoisted_27={key:0},_hoisted_28={class:"font-medium"},_hoisted_29={key:1,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},_hoisted_30={class:"p-4 sm:p-6"},_hoisted_31={key:0,class:"space-y-2"},_hoisted_32={class:"font-medium"},_hoisted_33={key:0},_hoisted_34={class:"font-medium"},_hoisted_35={key:1,class:"text-gray-500"},_hoisted_36={key:2,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},_hoisted_37={class:"p-4 sm:p-6 space-y-3"},_hoisted_38={class:"font-medium"},_hoisted_39={class:"font-medium"},_hoisted_40={class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200 flex items-center justify-between"},_hoisted_41={class:"font-semibold text-gray-900 text-sm sm:text-base"},_hoisted_42={key:0,class:"text-xs text-green-600 flex items-center gap-1"},_hoisted_43={class:"p-4 sm:p-6 space-y-4"},_hoisted_44={key:0,class:"space-y-3"},_hoisted_45={key:0,class:"text-sm font-medium text-gray-700 border-b border-gray-100 pb-1"},_hoisted_46={class:"grid md:grid-cols-2 gap-4"},_hoisted_47={class:"text-sm text-gray-500"},_hoisted_48={class:"font-medium"},_hoisted_49={key:0,class:"flex items-center gap-2 text-green-600"},_hoisted_50=["href"],_hoisted_51={key:1,class:"text-gray-400"},_hoisted_52={key:0,class:"text-gray-500 text-sm ml-2"},_hoisted_53={key:0},_hoisted_54={key:1,class:"text-gray-400"},_hoisted_55={key:0,class:"text-gray-500 text-sm"},_hoisted_56={key:4,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},_hoisted_57={class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},_hoisted_58={class:"font-semibold text-gray-900 text-sm sm:text-base flex items-center gap-2"},_hoisted_59={class:"p-4 sm:p-6"},_hoisted_60={class:"grid md:grid-cols-2 gap-3"},_hoisted_61={class:"flex-1 min-w-0"},_hoisted_62={class:"text-sm font-medium text-gray-900 truncate"},_hoisted_63=["href"],_hoisted_64={key:5,class:"bg-orange-50 border border-orange-200 rounded-lg p-4"},_hoisted_65={class:"flex items-start gap-2 sm:gap-3"},_hoisted_66={class:"mt-1 text-orange-800 text-xs sm:text-sm list-disc list-inside"},_hoisted_67={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},_hoisted_68={class:"p-4 sm:p-6"},_hoisted_69={class:"space-y-3"},_hoisted_70={class:"mt-2 flex flex-wrap gap-2"},_hoisted_71={key:0,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium"},_hoisted_72={key:1,class:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},_hoisted_73={key:2,class:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium"},_hoisted_74={key:3,class:"px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full text-sm font-medium"},_hoisted_75={key:4,class:"px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-sm font-medium"},_hoisted_76={key:5,class:"text-gray-500"},_hoisted_77={class:"mt-1 inline-flex items-center"},_hoisted_78={key:0},_hoisted_79={class:"font-medium break-words"},_hoisted_80={key:0,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},_hoisted_81={class:"p-4 sm:p-6"},_hoisted_82={class:"flex flex-wrap gap-2"},_hoisted_83={key:0,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},_hoisted_84={key:1,class:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},_hoisted_85={key:2,class:"px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},_hoisted_86={key:3,class:"px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},_hoisted_87={key:1,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},_hoisted_88={class:"p-4 sm:p-6"},_hoisted_89={class:"space-y-3"},_hoisted_90={class:"font-medium"},_hoisted_91={key:0},_hoisted_92={class:"text-sm mt-1 line-clamp-3"},_hoisted_93={key:1},_hoisted_94={class:"text-sm mt-1 line-clamp-3"},_hoisted_95={class:"flex items-center gap-2"},_hoisted_96={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},_hoisted_97={class:"p-4 sm:p-6"},_hoisted_98={class:"space-y-4"},_hoisted_99={key:0},_hoisted_100=["innerHTML"],_hoisted_101={key:1},_hoisted_102=["innerHTML"],_hoisted_103={key:2},_hoisted_104={class:"text-sm mt-1 line-clamp-3"},_hoisted_105={key:3},_hoisted_106={class:"text-sm mt-1 space-y-1 list-disc list-inside"},_hoisted_107={key:0},_hoisted_108={key:1},_hoisted_109={key:2},_hoisted_110={key:4},_hoisted_111=["innerHTML"],_hoisted_112={key:5,class:"text-gray-500 text-sm"},_hoisted_113={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},_hoisted_114={class:"p-4 sm:p-6"},_hoisted_115={class:"space-y-2"},_hoisted_116={class:"flex items-start gap-2"},_hoisted_117={class:"flex items-start gap-2"},_hoisted_118={class:"flex items-start gap-2"},_hoisted_119={key:0,class:"mt-4 pt-4 border-t border-gray-200"},_hoisted_120={class:"font-medium"},_hoisted_121={key:0,class:"text-sm text-gray-500"},_hoisted_122={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 sm:p-6"},_hoisted_123={class:"flex items-start gap-2 sm:gap-3"},_hoisted_124={class:"mt-2 text-xs sm:text-sm text-yellow-800 space-y-1 list-disc list-inside"},_hoisted_125={key:0},_hoisted_126={key:1},_hoisted_127={key:7,class:"bg-red-50 border border-red-200 rounded-lg p-4"},_hoisted_128={class:"flex items-start gap-2 sm:gap-3"},_hoisted_129={key:0,class:"mt-2 text-red-700 text-xs list-disc list-inside"},_hoisted_130={key:0},_sfc_main$1={__name:"ReviewStep",props:{modelValue:{type:Object,required:!0},councilName:{type:String,default:"Council"},requestTypeName:{type:String,default:"Application"},applicationFee:{type:String,default:"TBD"},isResourceConsent:{type:Boolean,default:!1},stepConfigs:{type:Array,default:()=>[]},usesConfigurableSteps:{type:Boolean,default:!1},requestTypeDetails:{type:Object,default:null}},setup(__props){const props=__props,isSPISCApplication=computed(()=>{var t;const e=((t=props.requestTypeName)==null?void 0:t.toLowerCase())||"";return e.includes("spisc")||e.includes("social pension")}),applicantName=computed(()=>props.modelValue.requester_name||props.modelValue.full_name||props.modelValue.applicant_name||null),applicantEmail=computed(()=>props.modelValue.requester_email||props.modelValue.email||props.modelValue.applicant_email||null),applicantPhone=computed(()=>props.modelValue.requester_phone||props.modelValue.mobile_number||props.modelValue.phone||props.modelValue.applicant_phone||null),calculatedAge=computed(()=>{const e=props.modelValue.birth_date;if(!e)return null;const t=new Date,s=new Date(e);let r=t.getFullYear()-s.getFullYear();const p=t.getMonth()-s.getMonth();return(p<0||p===0&&t.getDate()<s.getDate())&&r--,r}),ageEligible=computed(()=>calculatedAge.value!==null&&calculatedAge.value>=60),incomeEligible=computed(()=>{const e=props.modelValue.monthly_income;return e==null?!0:Number(e)<1e4}),overallEligible=computed(()=>ageEligible.value&&incomeEligible.value),allStepsWithData=computed(()=>!props.usesConfigurableSteps||!props.stepConfigs?[]:props.stepConfigs.filter(e=>e.show_on_review?!0:hasAnyContent(e))),hasPropertyDetails=computed(()=>props.isResourceConsent?!0:!!(props.modelValue.property||props.modelValue.property_address)),getFieldValue=e=>{var s;const t=props.modelValue[e];return t==null||t===""?null:Array.isArray(t)&&t.length>0&&(s=t[0])!=null&&s.file_url?t[0].file_url:t},getAttachmentUrl=e=>{var s;const t=props.modelValue[e];return t?Array.isArray(t)&&t.length>0?((s=t[0])==null?void 0:s.file_url)||t[0]:typeof t=="string"&&t.startsWith("/")?t:null:null},shouldShowSection=section=>{if(section.depends_on){const condition=section.depends_on.replace("eval:","").replace(/doc\./g,"props.modelValue.");try{if(!eval(condition))return!1}catch(e){}}if(section.show_on_review)return!0;for(const e of section.fields||[])if(getFieldValue(e.field_name))return!0;return!1},shouldShowField=field=>{if(field.depends_on){const condition=field.depends_on.replace("eval:","").replace(/doc\./g,"props.modelValue.");try{if(!eval(condition))return!1}catch(e){}}return field.show_on_review||getFieldValue(field.field_name)!==null},isLongField=e=>e.field_type==="Text Editor"||e.field_type==="Small Text"||e.field_type==="Long Text"||e.field_type==="Data"&&(e.field_label||"").length>50,hasAnyContent=e=>{if(!e.sections)return!1;for(const t of e.sections)for(const s of t.fields||[])if(getFieldValue(s.field_name)!==null)return!0;return!1},getStepCompleteness=e=>{if(!e.sections)return!1;for(const t of e.sections)for(const s of t.fields||[])if(s.is_required&&!getFieldValue(s.field_name))return!1;return!0},uploadedDocuments=computed(()=>{const e=[];for(const t of props.stepConfigs||[])for(const s of t.sections||[])for(const r of s.fields||[])(r.field_type==="Attach"||r.field_type==="Attach Image")&&getFieldValue(r.field_name)&&e.push({field_name:r.field_name,label:r.field_label,url:getAttachmentUrl(r.field_name)});return e}),missingRequiredDocuments=computed(()=>{const e=[];for(const t of props.stepConfigs||[])for(const s of t.sections||[])for(const r of s.fields||[])(r.field_type==="Attach"||r.field_type==="Attach Image")&&r.is_required&&!getFieldValue(r.field_name)&&e.push({field_name:r.field_name,label:r.field_label});return e}),missingFields=computed(()=>{const missing=[];for(const step of props.stepConfigs||[])for(const section of step.sections||[]){if(section.depends_on){const condition=section.depends_on.replace("eval:","").replace(/doc\./g,"props.modelValue.");try{if(!eval(condition))continue}catch(e){}}for(const field of section.fields||[])if(field.is_required){if(field.depends_on){const condition=field.depends_on.replace("eval:","").replace(/doc\./g,"props.modelValue.");try{if(!eval(condition))continue}catch(e){}}getFieldValue(field.field_name)||missing.push(field.field_label)}}return missing}),formatFieldValue=(e,t)=>t==null||t===""?"Not provided":e.field_type==="Check"?t?"Yes":"No":e.field_type==="Date"&&t?formatDate(t):e.field_type==="Currency"&&t?formatCurrency(t):e.field_type==="Select"?t:e.field_type==="Attach"||e.field_type==="Attach Image"?t?"File attached":"Not provided":e.field_type==="Int"?String(t):t,formatDate=e=>{if(!e)return"Not provided";try{return new Date(e).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"})}catch(t){return e}},formatCurrency=e=>e==null||e===""?"Not provided":`PHP ${Number(e).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})}`,formatPickupSchedule=e=>e?typeof e=="object"?`${e.date||"Date TBD"} at ${e.time||"Time TBD"}`:e:"Not scheduled",hasAnyConsentType=computed(()=>!!(props.modelValue.consent_type_land_use||props.modelValue.consent_type_subdivision||props.modelValue.consent_type_discharge||props.modelValue.consent_type_water||props.modelValue.consent_type_coastal)),activityStatusClass=computed(()=>{const e=props.modelValue.activity_status_type;return e==="Permitted"?"bg-green-100 text-green-800":e==="Controlled"?"bg-blue-100 text-blue-800":e==="Restricted Discretionary"?"bg-yellow-100 text-yellow-800":e==="Discretionary"?"bg-orange-100 text-orange-800":e==="Non-Complying"?"bg-red-100 text-red-800":e==="Prohibited"?"bg-gray-800 text-white":"bg-gray-100 text-gray-800"}),hasNaturalHazards=computed(()=>!!(props.modelValue.hazard_flooding||props.modelValue.hazard_earthquake||props.modelValue.hazard_landslip||props.modelValue.hazard_coastal)),hasConsultation=computed(()=>!!(props.modelValue.consultation_undertaken||props.modelValue.consultation_summary||props.modelValue.affected_parties_details||props.modelValue.written_approvals_obtained)),hasAEEContent=computed(()=>!!(props.modelValue.activity_description||props.modelValue.aee_full_assessment||props.modelValue.positive_effects_description||props.modelValue.effects_visual_amenity||props.modelValue.effects_traffic_parking||props.modelValue.effects_noise||props.modelValue.mitigation_measures||props.modelValue.aee_activity_description||props.modelValue.aee_existing_environment||props.modelValue.assessment_of_effects||props.modelValue.aee_document)),stripHtml=e=>{if(!e)return"";const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},truncate=(e,t)=>{if(!e)return"";const s=stripHtml(e);return s.length<=t?s:s.substring(0,t)+"..."},formatSignatureDate=e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("en-PH",{year:"numeric",month:"long",day:"numeric"})}catch(t){return e}},isComplete=computed(()=>{if(isSPISCApplication.value)return missingFields.value.length===0&&missingRequiredDocuments.value.length===0;const e=!!(props.modelValue.council&&props.modelValue.request_type&&(props.modelValue.requester_name||props.modelValue.full_name)&&(props.modelValue.requester_email||props.modelValue.email));if(props.isResourceConsent){const t=!!(hasAnyConsentType.value&&props.modelValue.activity_status_type&&props.modelValue.activity_description&&props.modelValue.aee_full_assessment&&props.modelValue.declaration_accuracy&&props.modelValue.declaration_authority&&props.modelValue.declaration_acknowledgment);return e&&t}return e});return(e,t)=>{var s;return openBlock(),createElementBlock("div",_hoisted_1$1,[t[57]||(t[57]=createBaseVNode("h2",{class:"text-xl sm:text-2xl font-bold text-gray-900 mb-2"},"Review & Submit",-1)),t[58]||(t[58]=createBaseVNode("p",{class:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8"},"Review your application details before submitting",-1)),createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",_hoisted_3$1,[createBaseVNode("div",_hoisted_4$1,[createBaseVNode("div",null,[createBaseVNode("h3",_hoisted_5$1,toDisplayString(__props.requestTypeName),1),createBaseVNode("p",_hoisted_6$1,toDisplayString(__props.councilName),1)]),createBaseVNode("div",_hoisted_7$1,[t[0]||(t[0]=createBaseVNode("div",{class:"text-xs sm:text-sm text-blue-600 font-medium"},"Application Fee",-1)),createBaseVNode("div",_hoisted_8$1,toDisplayString(__props.applicationFee),1)])])]),isSPISCApplication.value?(openBlock(),createElementBlock("div",_hoisted_9$1,[t[9]||(t[9]=createBaseVNode("div",{class:"bg-green-100 px-4 sm:px-6 py-3 border-b border-green-200"},[createBaseVNode("h3",{class:"font-semibold text-green-900 text-sm sm:text-base flex items-center gap-2"},[createBaseVNode("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})]),createTextVNode(" Eligibility Summary ")])],-1)),createBaseVNode("div",_hoisted_10$1,[createBaseVNode("div",_hoisted_11$1,[createBaseVNode("div",_hoisted_12$1,[createBaseVNode("div",{class:normalizeClass([ageEligible.value?"bg-green-100 text-green-600":"bg-red-100 text-red-600","p-2 rounded-full"])},[...t[1]||(t[1]=[createBaseVNode("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)])],2),createBaseVNode("div",null,[t[2]||(t[2]=createBaseVNode("p",{class:"text-sm text-gray-500"},"Age",-1)),createBaseVNode("p",{class:normalizeClass(["font-semibold",ageEligible.value?"text-green-700":"text-red-700"])},toDisplayString(calculatedAge.value!==null?`${calculatedAge.value} years old`:"Not provided"),3),ageEligible.value?(openBlock(),createElementBlock("p",_hoisted_13$1,"Meets 60+ requirement")):calculatedAge.value!==null?(openBlock(),createElementBlock("p",_hoisted_14,"Must be 60 or older")):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_15,[createBaseVNode("div",{class:normalizeClass([incomeEligible.value?"bg-green-100 text-green-600":"bg-yellow-100 text-yellow-600","p-2 rounded-full"])},[...t[3]||(t[3]=[createBaseVNode("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],2),createBaseVNode("div",null,[t[4]||(t[4]=createBaseVNode("p",{class:"text-sm text-gray-500"},"Monthly Income",-1)),createBaseVNode("p",{class:normalizeClass(["font-semibold",incomeEligible.value?"text-green-700":"text-yellow-700"])},toDisplayString(formatCurrency(__props.modelValue.monthly_income)),3),incomeEligible.value?(openBlock(),createElementBlock("p",_hoisted_16,"Below poverty threshold")):(openBlock(),createElementBlock("p",_hoisted_17,"May affect eligibility"))])]),createBaseVNode("div",_hoisted_18,[createBaseVNode("div",{class:normalizeClass([overallEligible.value?"bg-green-100 text-green-600":"bg-yellow-100 text-yellow-600","p-2 rounded-full"])},[overallEligible.value?(openBlock(),createElementBlock("svg",_hoisted_19,[...t[5]||(t[5]=[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):(openBlock(),createElementBlock("svg",_hoisted_20,[...t[6]||(t[6]=[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])]))],2),createBaseVNode("div",null,[t[7]||(t[7]=createBaseVNode("p",{class:"text-sm text-gray-500"},"Preliminary Status",-1)),createBaseVNode("p",{class:normalizeClass(["font-semibold",overallEligible.value?"text-green-700":"text-yellow-700"])},toDisplayString(overallEligible.value?"Likely Eligible":"Needs Review"),3),t[8]||(t[8]=createBaseVNode("p",{class:"text-xs text-gray-500"},"Final assessment by council",-1))])])])])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_21,[t[14]||(t[14]=createBaseVNode("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[createBaseVNode("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Applicant Details")],-1)),createBaseVNode("div",_hoisted_22,[createBaseVNode("div",_hoisted_23,[createBaseVNode("div",null,[t[10]||(t[10]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Name:",-1)),createBaseVNode("p",_hoisted_24,toDisplayString(applicantName.value||"Not provided"),1)]),createBaseVNode("div",null,[t[11]||(t[11]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Email:",-1)),createBaseVNode("p",_hoisted_25,toDisplayString(applicantEmail.value||"Not provided"),1)]),createBaseVNode("div",null,[t[12]||(t[12]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Phone:",-1)),createBaseVNode("p",_hoisted_26,toDisplayString(applicantPhone.value||"Not provided"),1)]),__props.modelValue.applicant_company?(openBlock(),createElementBlock("div",_hoisted_27,[t[13]||(t[13]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Company:",-1)),createBaseVNode("p",_hoisted_28,toDisplayString(__props.modelValue.applicant_company),1)])):createCommentVNode("",!0)])])]),hasPropertyDetails.value?(openBlock(),createElementBlock("div",_hoisted_29,[t[17]||(t[17]=createBaseVNode("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[createBaseVNode("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Property Details")],-1)),createBaseVNode("div",_hoisted_30,[__props.modelValue.property_address?(openBlock(),createElementBlock("div",_hoisted_31,[createBaseVNode("div",null,[t[15]||(t[15]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Address:",-1)),createBaseVNode("p",_hoisted_32,toDisplayString(__props.modelValue.property_address),1)]),__props.modelValue.legal_description?(openBlock(),createElementBlock("div",_hoisted_33,[t[16]||(t[16]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Legal Description:",-1)),createBaseVNode("p",_hoisted_34,toDisplayString(__props.modelValue.legal_description),1)])):createCommentVNode("",!0)])):(openBlock(),createElementBlock("p",_hoisted_35,"No property selected"))])])):createCommentVNode("",!0),(s=__props.requestTypeDetails)!=null&&s.collect_payment?(openBlock(),createElementBlock("div",_hoisted_36,[t[20]||(t[20]=createBaseVNode("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[createBaseVNode("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Delivery & Payment")],-1)),createBaseVNode("div",_hoisted_37,[createBaseVNode("div",null,[t[18]||(t[18]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Delivery Preference:",-1)),createBaseVNode("p",_hoisted_38,toDisplayString(__props.modelValue.delivery_preference||"Not selected"),1)]),createBaseVNode("div",null,[t[19]||(t[19]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Invoice To:",-1)),createBaseVNode("p",_hoisted_39,toDisplayString(__props.modelValue.invoice_to||"Not specified"),1)])])])):createCommentVNode("",!0),__props.usesConfigurableSteps&&allStepsWithData.value.length>0?(openBlock(!0),createElementBlock(Fragment,{key:3},renderList(allStepsWithData.value,r=>(openBlock(),createElementBlock("div",{key:r.step_code,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},[createBaseVNode("div",_hoisted_40,[createBaseVNode("h3",_hoisted_41,toDisplayString(r.step_title),1),getStepCompleteness(r)?(openBlock(),createElementBlock("span",_hoisted_42,[...t[21]||(t[21]=[createBaseVNode("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),createTextVNode(" Complete ",-1)])])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_43,[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.sections,p=>(openBlock(),createElementBlock(Fragment,{key:p.section_code},[shouldShowSection(p)?(openBlock(),createElementBlock("div",_hoisted_44,[p.section_title?(openBlock(),createElementBlock("h4",_hoisted_45,toDisplayString(p.section_title),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_46,[(openBlock(!0),createElementBlock(Fragment,null,renderList(p.fields,n=>(openBlock(),createElementBlock(Fragment,{key:n.field_name},[shouldShowField(n)?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(isLongField(n)?"md:col-span-2":"")},[createBaseVNode("span",_hoisted_47,toDisplayString(n.review_label||n.field_label)+":",1),createBaseVNode("div",_hoisted_48,[n.field_type==="Attach"||n.field_type==="Attach Image"?(openBlock(),createElementBlock(Fragment,{key:0},[getFieldValue(n.field_name)?(openBlock(),createElementBlock("div",_hoisted_49,[t[22]||(t[22]=createBaseVNode("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[23]||(t[23]=createBaseVNode("span",null,"File uploaded",-1)),getAttachmentUrl(n.field_name)?(openBlock(),createElementBlock("a",{key:0,href:getAttachmentUrl(n.field_name),target:"_blank",class:"text-blue-600 hover:underline text-sm"},"(View)",8,_hoisted_50)):createCommentVNode("",!0)])):(openBlock(),createElementBlock("span",_hoisted_51,"Not uploaded"))],64)):n.field_type==="Check"?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(__props.modelValue[n.field_name]?"text-green-600":"text-gray-400")},toDisplayString(__props.modelValue[n.field_name]?"Yes":"No"),3)):n.field_type==="Date"?(openBlock(),createElementBlock(Fragment,{key:2},[createBaseVNode("span",null,toDisplayString(formatDate(__props.modelValue[n.field_name])),1),n.field_name==="birth_date"&&calculatedAge.value!==null?(openBlock(),createElementBlock("span",_hoisted_52," ("+toDisplayString(calculatedAge.value)+" years old) ",1)):createCommentVNode("",!0)],64)):n.field_type==="Currency"?(openBlock(),createElementBlock(Fragment,{key:3},[createTextVNode(toDisplayString(formatCurrency(__props.modelValue[n.field_name])),1)],64)):n.field_type==="Pickup Schedule"?(openBlock(),createElementBlock(Fragment,{key:4},[__props.modelValue[n.field_name]?(openBlock(),createElementBlock("span",_hoisted_53,toDisplayString(formatPickupSchedule(__props.modelValue[n.field_name])),1)):(openBlock(),createElementBlock("span",_hoisted_54,"Not scheduled"))],64)):(openBlock(),createElementBlock(Fragment,{key:5},[createTextVNode(toDisplayString(formatFieldValue(n,__props.modelValue[n.field_name])),1)],64))])],2)):createCommentVNode("",!0)],64))),128))])])):createCommentVNode("",!0)],64))),128)),hasAnyContent(r)?createCommentVNode("",!0):(openBlock(),createElementBlock("p",_hoisted_55," No information entered for this step "))])]))),128)):createCommentVNode("",!0),uploadedDocuments.value.length>0?(openBlock(),createElementBlock("div",_hoisted_56,[createBaseVNode("div",_hoisted_57,[createBaseVNode("h3",_hoisted_58,[t[24]||(t[24]=createBaseVNode("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),createTextVNode(" Uploaded Documents ("+toDisplayString(uploadedDocuments.value.length)+") ",1)])]),createBaseVNode("div",_hoisted_59,[createBaseVNode("div",_hoisted_60,[(openBlock(!0),createElementBlock(Fragment,null,renderList(uploadedDocuments.value,r=>(openBlock(),createElementBlock("div",{key:r.field_name,class:"flex items-center gap-3 p-2 bg-gray-50 rounded"},[t[25]||(t[25]=createBaseVNode("svg",{class:"w-5 h-5 text-green-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),createBaseVNode("div",_hoisted_61,[createBaseVNode("p",_hoisted_62,toDisplayString(r.label),1),r.url?(openBlock(),createElementBlock("a",{key:0,href:r.url,target:"_blank",class:"text-xs text-blue-600 hover:underline"},"View file",8,_hoisted_63)):createCommentVNode("",!0)])]))),128))])])])):createCommentVNode("",!0),missingRequiredDocuments.value.length>0?(openBlock(),createElementBlock("div",_hoisted_64,[createBaseVNode("div",_hoisted_65,[t[27]||(t[27]=createBaseVNode("svg",{class:"w-5 h-5 text-orange-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),createBaseVNode("div",null,[t[26]||(t[26]=createBaseVNode("h5",{class:"font-semibold text-orange-900 text-xs sm:text-sm"},"Missing Required Documents",-1)),createBaseVNode("ul",_hoisted_66,[(openBlock(!0),createElementBlock(Fragment,null,renderList(missingRequiredDocuments.value,r=>(openBlock(),createElementBlock("li",{key:r.field_name},toDisplayString(r.label),1))),128))])])])])):createCommentVNode("",!0),__props.isResourceConsent?(openBlock(),createElementBlock(Fragment,{key:6},[createBaseVNode("div",_hoisted_67,[t[31]||(t[31]=createBaseVNode("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[createBaseVNode("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Consent Types & Activity Status")],-1)),createBaseVNode("div",_hoisted_68,[createBaseVNode("div",_hoisted_69,[createBaseVNode("div",null,[t[28]||(t[28]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Consent Types:",-1)),createBaseVNode("div",_hoisted_70,[__props.modelValue.consent_type_land_use?(openBlock(),createElementBlock("span",_hoisted_71," Land Use Consent ")):createCommentVNode("",!0),__props.modelValue.consent_type_subdivision?(openBlock(),createElementBlock("span",_hoisted_72," Subdivision Consent ")):createCommentVNode("",!0),__props.modelValue.consent_type_discharge?(openBlock(),createElementBlock("span",_hoisted_73," Discharge Permit ")):createCommentVNode("",!0),__props.modelValue.consent_type_water?(openBlock(),createElementBlock("span",_hoisted_74," Water Permit ")):createCommentVNode("",!0),__props.modelValue.consent_type_coastal?(openBlock(),createElementBlock("span",_hoisted_75," Coastal Permit ")):createCommentVNode("",!0),hasAnyConsentType.value?createCommentVNode("",!0):(openBlock(),createElementBlock("span",_hoisted_76," None selected "))])]),createBaseVNode("div",null,[t[29]||(t[29]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Activity Status:",-1)),createBaseVNode("div",_hoisted_77,[createBaseVNode("span",{class:normalizeClass(["px-3 py-1 rounded-full text-sm font-medium",activityStatusClass.value])},toDisplayString(__props.modelValue.activity_status_type||"Not specified"),3)])]),__props.modelValue.activity_title?(openBlock(),createElementBlock("div",_hoisted_78,[t[30]||(t[30]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Activity Title:",-1)),createBaseVNode("p",_hoisted_79,toDisplayString(__props.modelValue.activity_title),1)])):createCommentVNode("",!0)])])]),hasNaturalHazards.value?(openBlock(),createElementBlock("div",_hoisted_80,[t[32]||(t[32]=createBaseVNode("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[createBaseVNode("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Natural Hazards")],-1)),createBaseVNode("div",_hoisted_81,[createBaseVNode("div",_hoisted_82,[__props.modelValue.hazard_flooding?(openBlock(),createElementBlock("span",_hoisted_83," Flood Hazard ")):createCommentVNode("",!0),__props.modelValue.hazard_earthquake?(openBlock(),createElementBlock("span",_hoisted_84," Earthquake/Fault Line ")):createCommentVNode("",!0),__props.modelValue.hazard_landslip?(openBlock(),createElementBlock("span",_hoisted_85," Landslip/Slope Instability ")):createCommentVNode("",!0),__props.modelValue.hazard_coastal?(openBlock(),createElementBlock("span",_hoisted_86," Coastal Hazard ")):createCommentVNode("",!0)])])])):createCommentVNode("",!0),hasConsultation.value?(openBlock(),createElementBlock("div",_hoisted_87,[t[37]||(t[37]=createBaseVNode("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[createBaseVNode("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Consultation & Affected Parties")],-1)),createBaseVNode("div",_hoisted_88,[createBaseVNode("div",_hoisted_89,[createBaseVNode("div",null,[t[33]||(t[33]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Consultation Undertaken:",-1)),createBaseVNode("p",_hoisted_90,toDisplayString(__props.modelValue.consultation_undertaken||"Not specified"),1)]),__props.modelValue.consultation_summary?(openBlock(),createElementBlock("div",_hoisted_91,[t[34]||(t[34]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Consultation Summary:",-1)),createBaseVNode("p",_hoisted_92,toDisplayString(__props.modelValue.consultation_summary),1)])):createCommentVNode("",!0),__props.modelValue.affected_parties_details?(openBlock(),createElementBlock("div",_hoisted_93,[t[35]||(t[35]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Affected Parties:",-1)),createBaseVNode("p",_hoisted_94,toDisplayString(stripHtml(__props.modelValue.affected_parties_details)),1)])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_95,[(openBlock(),createElementBlock("svg",{class:normalizeClass(["w-5 h-5",__props.modelValue.written_approvals_obtained?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[36]||(t[36]=[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),createBaseVNode("span",{class:normalizeClass(__props.modelValue.written_approvals_obtained?"text-gray-900":"text-gray-500")}," Written Approvals "+toDisplayString(__props.modelValue.written_approvals_obtained?"Obtained":"Not Obtained"),3)])])])])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_96,[t[43]||(t[43]=createBaseVNode("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[createBaseVNode("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Assessment of Environmental Effects")],-1)),createBaseVNode("div",_hoisted_97,[createBaseVNode("div",_hoisted_98,[__props.modelValue.activity_description?(openBlock(),createElementBlock("div",_hoisted_99,[t[38]||(t[38]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Activity Description:",-1)),createBaseVNode("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:__props.modelValue.activity_description},null,8,_hoisted_100)])):createCommentVNode("",!0),__props.modelValue.aee_full_assessment?(openBlock(),createElementBlock("div",_hoisted_101,[t[39]||(t[39]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Full Assessment:",-1)),createBaseVNode("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:__props.modelValue.aee_full_assessment},null,8,_hoisted_102)])):createCommentVNode("",!0),__props.modelValue.positive_effects_description?(openBlock(),createElementBlock("div",_hoisted_103,[t[40]||(t[40]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Positive Effects:",-1)),createBaseVNode("p",_hoisted_104,toDisplayString(__props.modelValue.positive_effects_description),1)])):createCommentVNode("",!0),__props.modelValue.effects_visual_amenity||__props.modelValue.effects_traffic_parking||__props.modelValue.effects_noise?(openBlock(),createElementBlock("div",_hoisted_105,[t[41]||(t[41]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Adverse Effects Summary:",-1)),createBaseVNode("ul",_hoisted_106,[__props.modelValue.effects_visual_amenity?(openBlock(),createElementBlock("li",_hoisted_107,"Visual/Amenity: "+toDisplayString(truncate(__props.modelValue.effects_visual_amenity,50)),1)):createCommentVNode("",!0),__props.modelValue.effects_traffic_parking?(openBlock(),createElementBlock("li",_hoisted_108,"Traffic/Parking: "+toDisplayString(truncate(__props.modelValue.effects_traffic_parking,50)),1)):createCommentVNode("",!0),__props.modelValue.effects_noise?(openBlock(),createElementBlock("li",_hoisted_109,"Noise: "+toDisplayString(truncate(__props.modelValue.effects_noise,50)),1)):createCommentVNode("",!0)])])):createCommentVNode("",!0),__props.modelValue.mitigation_measures?(openBlock(),createElementBlock("div",_hoisted_110,[t[42]||(t[42]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Mitigation Measures:",-1)),createBaseVNode("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:__props.modelValue.mitigation_measures},null,8,_hoisted_111)])):createCommentVNode("",!0),hasAEEContent.value?createCommentVNode("",!0):(openBlock(),createElementBlock("p",_hoisted_112," AEE not yet completed "))])])]),createBaseVNode("div",_hoisted_113,[t[48]||(t[48]=createBaseVNode("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[createBaseVNode("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Statutory Declarations")],-1)),createBaseVNode("div",_hoisted_114,[createBaseVNode("div",_hoisted_115,[createBaseVNode("div",_hoisted_116,[(openBlock(),createElementBlock("svg",{class:normalizeClass(["w-5 h-5 flex-shrink-0 mt-0.5",__props.modelValue.declaration_accuracy||__props.modelValue.declaration_rma_compliance?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[44]||(t[44]=[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),createBaseVNode("span",{class:normalizeClass(["text-sm",__props.modelValue.declaration_accuracy||__props.modelValue.declaration_rma_compliance?"text-gray-900":"text-gray-500"])}," Declaration of Accuracy & RMA Compliance ",2)]),createBaseVNode("div",_hoisted_117,[(openBlock(),createElementBlock("svg",{class:normalizeClass(["w-5 h-5 flex-shrink-0 mt-0.5",__props.modelValue.declaration_authority||__props.modelValue.declaration_authorized?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[45]||(t[45]=[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),createBaseVNode("span",{class:normalizeClass(["text-sm",__props.modelValue.declaration_authority||__props.modelValue.declaration_authorized?"text-gray-900":"text-gray-500"])}," Declaration of Authority to Apply ",2)]),createBaseVNode("div",_hoisted_118,[(openBlock(),createElementBlock("svg",{class:normalizeClass(["w-5 h-5 flex-shrink-0 mt-0.5",__props.modelValue.declaration_acknowledgment||__props.modelValue.declaration_public_information?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[46]||(t[46]=[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),createBaseVNode("span",{class:normalizeClass(["text-sm",__props.modelValue.declaration_acknowledgment||__props.modelValue.declaration_public_information?"text-gray-900":"text-gray-500"])}," Public Information & Privacy Acknowledgment ",2)]),__props.modelValue.requester_signature?(openBlock(),createElementBlock("div",_hoisted_119,[t[47]||(t[47]=createBaseVNode("span",{class:"text-sm text-gray-500"},"Signed by:",-1)),createBaseVNode("p",_hoisted_120,toDisplayString(__props.modelValue.requester_signature),1),__props.modelValue.signature_date?(openBlock(),createElementBlock("p",_hoisted_121," Date: "+toDisplayString(formatSignatureDate(__props.modelValue.signature_date)),1)):createCommentVNode("",!0)])):createCommentVNode("",!0)])])])],64)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_122,[createBaseVNode("div",_hoisted_123,[t[53]||(t[53]=createBaseVNode("svg",{class:"w-5 h-5 sm:w-6 sm:h-6 text-yellow-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),createBaseVNode("div",null,[t[52]||(t[52]=createBaseVNode("h4",{class:"font-semibold text-yellow-900 text-sm sm:text-base"},"Before You Submit",-1)),createBaseVNode("ul",_hoisted_124,[t[49]||(t[49]=createBaseVNode("li",null,"Review all information carefully for accuracy and completeness",-1)),t[50]||(t[50]=createBaseVNode("li",null,"Ensure all required fields are completed",-1)),__props.isResourceConsent?(openBlock(),createElementBlock("li",_hoisted_125,"For Resource Consent applications, verify all statutory declarations are confirmed")):createCommentVNode("",!0),isSPISCApplication.value?(openBlock(),createElementBlock("li",_hoisted_126,"Ensure all required documents are uploaded")):createCommentVNode("",!0),t[51]||(t[51]=createBaseVNode("li",null,"Once submitted, you cannot edit the application (you may need to withdraw and resubmit)",-1))])])])]),isComplete.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_127,[createBaseVNode("div",_hoisted_128,[t[56]||(t[56]=createBaseVNode("svg",{class:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),createBaseVNode("div",null,[t[54]||(t[54]=createBaseVNode("h5",{class:"font-semibold text-red-900 text-xs sm:text-sm"},"Application Incomplete",-1)),t[55]||(t[55]=createBaseVNode("p",{class:"text-red-800 text-xs sm:text-sm mt-1"}," Please complete all required sections before submitting. Use the Previous button to go back and fill in missing information. ",-1)),missingFields.value.length>0?(openBlock(),createElementBlock("ul",_hoisted_129,[(openBlock(!0),createElementBlock(Fragment,null,renderList(missingFields.value.slice(0,5),r=>(openBlock(),createElementBlock("li",{key:r},toDisplayString(r),1))),128)),missingFields.value.length>5?(openBlock(),createElementBlock("li",_hoisted_130,"...and "+toDisplayString(missingFields.value.length-5)+" more",1)):createCommentVNode("",!0)])):createCommentVNode("",!0)])])]))])])}}},ReviewStep=_export_sfc(_sfc_main$1,[["__scopeId","data-v-35ac5f07"]]),_hoisted_1={class:"min-h-screen bg-gray-50"},_hoisted_2={class:"bg-white border-b border-gray-200"},_hoisted_3={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},_hoisted_4={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},_hoisted_5={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},_hoisted_6={key:0},_hoisted_7={key:1},_hoisted_8={key:2},_hoisted_9={key:4,class:"text-center py-12"},_hoisted_10={class:"flex gap-3 justify-center"},_hoisted_11={key:0,class:"mt-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6 shadow-sm"},_hoisted_12={class:"flex items-start justify-between"},_hoisted_13={class:"flex-1"},_sfc_main={__name:"NewRequest",setup(e){const t=defineAsyncComponent(()=>__vitePreload(()=>import("./SaveDraftModal-CSep5FJ8.js"),__vite__mapDeps([0,1,2,3,4]))),s=defineAsyncComponent(()=>__vitePreload(()=>import("./ValidationErrorModal-DAknucdX.js"),__vite__mapDeps([5,1,2,3,4]))),r=defineAsyncComponent(()=>__vitePreload(()=>import("./BookMeetingModal-DAzWoozx.js"),__vite__mapDeps([6,2,1,3,4]))),p=defineAsyncComponent(()=>__vitePreload(()=>import("./SubmissionSuccessModal-Cr8b_Xku.js"),__vite__mapDeps([7,1,2,3,4,8]))),n=defineAsyncComponent(()=>__vitePreload(()=>import("./DynamicStepRenderer-BgnTH38c.js"),__vite__mapDeps([9,2,1,3,4,10,11,12,13,14]))),l=useRouter(),i=useRequestStore(),{totalSteps:c,stepTitles:g,usesConfigurableSteps:o,shouldShowMeetingBanner:a,getCurrentStepTitle:u,getCurrentStepConfig:_,getCouncilName:y}=useStepConfiguration(),{showSaveDraftModal:h,showValidationModal:V,showMeetingModal:d,showSubmissionSuccessModal:f,submissionResult:x,handleBookMeeting:B,handleMeetingBooked:C,handleSaveDraft:$,handleSaveAndClose:z,handleSubmit:L,handleViewRequestFromModal:I,handleGoToDashboardFromModal:j}=useRequestModals(),{canNavigateNext:H,canSaveDraft:q,validationErrors:O,handleNext:T,handlePrevious:D,goBack:U}=useRequestFormNavigation({getCurrentStepConfig:_,totalSteps:c,usesConfigurableSteps:o,onValidationError:()=>{V.value=!0}}),{requestTypes:Y,selectedRequestTypeDetails:W,selectRequestType:G,initialize:J,setupRouteGuard:Q,setupAgeValidation:X}=useRequestLifecycle();Q(),X();const Z=computed(()=>(i.formData.request_type||"").toLowerCase().includes("resource consent")),K=k=>{var N,S;if(!k&&k!==0||k===0)return"Free";const m=((N=i.formData.council)==null?void 0:N.includes("TAYTAY"))||((S=i.formData.council)==null?void 0:S.includes("PH")),w=m?"PHP":"NZD";return`${m?"":"$"}${Number(k).toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2})} ${w}`};return onMounted(()=>{J()}),(k,m)=>{var w,E,N,S,R;return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(_sfc_main$7,{title:"New Application",onBack:unref(U)},{actions:withCtx(()=>[unref(q)?(openBlock(),createBlock(unref(_sfc_main$6),{key:0,onClick:unref($),variant:"outline",theme:"gray",loading:unref(i).isSaving},{default:withCtx(()=>[...m[12]||(m[12]=[createTextVNode(" Save Draft ",-1)])]),_:1},8,["onClick","loading"])):createCommentVNode("",!0),unref(q)?(openBlock(),createBlock(unref(_sfc_main$6),{key:1,onClick:unref(z),variant:"outline",theme:"gray",loading:unref(i).isSaving},{default:withCtx(()=>[...m[13]||(m[13]=[createTextVNode(" Save and Close ",-1)])]),_:1},8,["onClick","loading"])):createCommentVNode("",!0)]),_:1},8,["onBack"]),createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createVNode(_sfc_main$5,{"current-step":unref(i).currentStep,"total-steps":unref(c),"step-titles":unref(g)},null,8,["current-step","total-steps","step-titles"])])]),createBaseVNode("main",_hoisted_4,[createBaseVNode("div",_hoisted_5,[unref(u)()==="Type"?(openBlock(),createElementBlock("div",_hoisted_6,[createVNode(_sfc_main$3,{modelValue:unref(i).formData,"onUpdate:modelValue":m[0]||(m[0]=v=>unref(i).formData=v),"request-types":unref(Y),onTypeSelected:unref(G)},null,8,["modelValue","request-types","onTypeSelected"])])):unref(u)()==="Process Info"?(openBlock(),createElementBlock("div",_hoisted_7,[createVNode(_sfc_main$2,{"request-type-details":unref(W),"council-name":unref(y)(),modelValue:unref(i).formData,"onUpdate:modelValue":m[1]||(m[1]=v=>unref(i).formData=v),onContinue:unref(T)},null,8,["request-type-details","council-name","modelValue","onContinue"])])):unref(i).currentStep>=unref(c)-1?(openBlock(),createElementBlock("div",_hoisted_8,[createVNode(ReviewStep,{modelValue:unref(i).formData,"onUpdate:modelValue":m[2]||(m[2]=v=>unref(i).formData=v),"council-name":unref(i).formData.council||"Council","request-type-name":unref(i).formData.request_type||"Application","application-fee":K((w=unref(i).requestTypeConfig)==null?void 0:w.base_fee),"is-resource-consent":Z.value,"step-configs":((E=unref(i).requestTypeConfig)==null?void 0:E.steps)||[],"uses-configurable-steps":unref(o),"request-type-details":unref(i).requestTypeConfig},null,8,["modelValue","council-name","request-type-name","application-fee","is-resource-consent","step-configs","uses-configurable-steps","request-type-details"])])):unref(o)&&unref(_)()?(openBlock(),createBlock(unref(n),{key:3,stepConfig:unref(_)(),modelValue:unref(i).formData,"onUpdate:modelValue":m[3]||(m[3]=v=>unref(i).formData=v)},null,8,["stepConfig","modelValue"])):(openBlock(),createElementBlock("div",_hoisted_9,[m[14]||(m[14]=createStaticVNode('<div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4"><svg class="h-8 w-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">Unable to Load This Step</h3><p class="text-sm text-gray-600 mb-6"> We&#39;re having trouble loading this step. Please try refreshing or go back to continue your application. </p>',3)),createBaseVNode("div",_hoisted_10,[createBaseVNode("button",{onClick:m[4]||(m[4]=v=>k.location.reload()),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"}," Refresh Page "),createBaseVNode("button",{onClick:m[5]||(m[5]=(...v)=>unref(D)&&unref(D)(...v)),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition"}," Go Back "),createBaseVNode("button",{onClick:m[6]||(m[6]=v=>unref(l).push("/dashboard")),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition"}," Return to Dashboard ")])]))]),unref(a)?(openBlock(),createElementBlock("div",_hoisted_11,[createBaseVNode("div",_hoisted_12,[createBaseVNode("div",_hoisted_13,[m[15]||(m[15]=createStaticVNode('<div class="flex items-center gap-2 mb-2"><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><h3 class="text-lg font-semibold text-gray-900">Council Meeting Available</h3></div><p class="text-sm text-gray-700 mb-3"> Schedule a meeting with council planners to discuss your application before submitting. This optional step can help clarify requirements and improve your application. </p>',2)),createBaseVNode("button",{onClick:m[7]||(m[7]=(...v)=>unref(B)&&unref(B)(...v)),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium"}," Request Council Meeting ")])])])):createCommentVNode("",!0),createVNode(_sfc_main$4,{"current-step":unref(i).currentStep,"total-steps":unref(c),"is-last-step":unref(i).isLastStep,"can-go-next":unref(H),"can-save-draft":unref(q),"is-saving":unref(i).isSaving,"is-submitting":unref(i).isSubmitting,onNext:unref(T),onPrevious:unref(D),onSaveDraft:unref($),onSubmit:unref(L)},null,8,["current-step","total-steps","is-last-step","can-go-next","can-save-draft","is-saving","is-submitting","onNext","onPrevious","onSaveDraft","onSubmit"])]),createVNode(unref(t),{show:unref(h),"onUpdate:show":m[8]||(m[8]=v=>isRef(h)?h.value=v:null),"draft-id":unref(i).currentRequestId},null,8,["show","draft-id"]),createVNode(unref(s),{show:unref(V),"onUpdate:show":m[9]||(m[9]=v=>isRef(V)?V.value=v:null),errors:unref(O)},null,8,["show","errors"]),createVNode(unref(r),{show:unref(d),"onUpdate:show":m[10]||(m[10]=v=>isRef(d)?d.value=v:null),"request-id":unref(i).currentRequestId,"request-type-code":unref(i).formData.request_type,"council-code":unref(i).formData.council,onBooked:unref(C)},null,8,["show","request-id","request-type-code","council-code","onBooked"]),createVNode(unref(p),{open:unref(f),"request-number":(N=unref(x))==null?void 0:N.request_number,"request-id":(S=unref(x))==null?void 0:S.request_id,"sla-info":(R=unref(x))==null?void 0:R.sla_info,onClose:m[11]||(m[11]=v=>f.value=!1),onViewRequest:unref(I),onGoToDashboard:unref(j)},null,8,["open","request-number","request-id","sla-info","onViewRequest","onGoToDashboard"])])}}},NewRequest=Object.freeze(Object.defineProperty({__proto__:null,default:_sfc_main},Symbol.toStringTag,{value:"Module"}));export{NewRequest as N,useStepValidation as a,isSectionVisible as b,isFieldVisible as i,useUserProfile as u};
//# sourceMappingURL=NewRequest-Dx791JTj.js.map
