const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SaveDraftModal-CSep5FJ8.js","assets/frappe-ui-D6fYUZUl.js","assets/vue-vendor-B0shnPjy.js","assets/ui-components-CzNebsXy.js","assets/frappe-ui-BcYQ_VTL.css","assets/ValidationErrorModal-DAknucdX.js","assets/BookMeetingModal-DAzWoozx.js","assets/SubmissionSuccessModal-Cr8b_Xku.js","assets/SubmissionSuccessModal-ydH3POPv.css","assets/DynamicStepRenderer-B3q79Kbn.js","assets/request.service--9QsRanG.js","assets/index-D-F-VjFK.js","assets/index-C2WcRZli.css","assets/RequestHeader-CFcOgVuT.js","assets/DynamicStepRenderer-DrL_tQ_8.css"])))=>i.map(i=>d[i]);
var qe=Object.defineProperty,Ve=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var le=(e,s,n)=>s in e?qe(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,ue=(e,s)=>{for(var n in s||(s={}))De.call(s,n)&&le(e,n,s[n]);if(ie)for(var n of ie(s))Te.call(s,n)&&le(e,n,s[n]);return e},de=(e,s)=>Ve(e,Ce(s));var T=(e,s,n)=>new Promise((m,v)=>{var g=p=>{try{d(n.next(p))}catch(k){v(k)}},c=p=>{try{d(n.throw(p))}catch(k){v(k)}},d=p=>p.done?m(p.value):Promise.resolve(p.value).then(g,c);d((n=n.apply(e,s)).next())});import{h as E,k as Re,_ as z}from"./frappe-ui-D6fYUZUl.js";import{am as $e,a5 as G,B as $,c as S,aq as Me,w as Ne,ar as Pe,a as u,o as a,b as t,Q as Fe,t as b,O as B,e as y,P as M,a2 as N,u as i,ab as ce,F as H,W as J,n as F,aj as U,D as Ae,R as P,as as O,y as X}from"./vue-vendor-B0shnPjy.js";import{r as W}from"./request.service--9QsRanG.js";import{a as me,s as Le}from"./index-D-F-VjFK.js";import{_ as Ie}from"./RequestHeader-CFcOgVuT.js";const Y=$e("request",{persist:{key:"requestStore",storage:localStorage,paths:["currentRequestId","formData","currentStep","requestTypeCode"]},state:()=>({currentRequestId:null,requestTypeCode:null,requestTypeConfig:null,formData:{},currentStep:0,stepValidationStatus:{},isSaving:!1,isSubmitting:!1,lastSaved:null,error:null}),getters:{isFirstStep:e=>e.currentStep===0,totalSteps:e=>{var s;return(s=e.requestTypeConfig)!=null&&s.steps?e.requestTypeConfig.steps.length+3:3},isLastStep:e=>e.currentStep===e.totalSteps-1,currentStepConfig:e=>{var s,n;return(n=(s=e.requestTypeConfig)==null?void 0:s.steps)==null?void 0:n[e.currentStep]},canNavigateNext:e=>e.stepValidationStatus[e.currentStep]===!0,completionPercentage:e=>e.totalSteps===0?0:Math.round((e.currentStep+1)/e.totalSteps*100),hasUnsavedChanges:e=>e.lastSaved?new Date-e.lastSaved>3e4:Object.keys(e.formData).length>0},actions:{nextStep(){var m;const e=this.currentStep+1,s=this.totalSteps-1;if(e>s){console.error("[Store] Navigation beyond bounds prevented",{currentStep:this.currentStep,newStep:e,maxStep:s});return}if(e>=2&&e<s&&((m=this.requestTypeConfig)!=null&&m.steps)){const v=e-2;if(!this.requestTypeConfig.steps[v]){console.error("[Store] Missing step config, redirecting to review",{currentStep:this.currentStep,newStep:e,configIndex:v,totalConfigSteps:this.requestTypeConfig.steps.length}),this.currentStep=s;return}}this.currentStep=e},previousStep(){this.isFirstStep||this.currentStep--},goToStep(e){e>=0&&e<this.totalSteps&&(this.currentStep=e)},initialize(e,s=null){return T(this,null,function*(){try{this.requestTypeCode=e,this.error=null,console.log("[RequestStore] initialize called:",{requestTypeCode:e,draftId:s});const n=W.getRequestTypeConfig(e);yield new Promise(m=>{const v=setInterval(()=>{n.loading||(clearInterval(v),m())},100)}),this.requestTypeConfig=n.data,s&&(yield this.loadDraft(s))}catch(n){console.error("Failed to initialize request:",n),this.error=n.message||"Failed to load request type"}})},loadDraft(e){return T(this,null,function*(){try{const s=W.getRequest(e);yield new Promise(g=>{const c=setInterval(()=>{s.loading||(clearInterval(c),g())},100)});const n=s.data;if(this.currentRequestId=e,n.draft_full_data)try{this.formData=JSON.parse(n.draft_full_data)}catch(g){console.error("Failed to parse draft_full_data:",g),this.formData=n.form_data||{}}else this.formData=n.form_data||{};const m=n.draft_current_step||0,v=this.totalSteps-1;this.currentStep=Math.min(Math.max(0,m),v),m!==this.currentStep&&console.warn(`[RequestStore] Draft had invalid step ${m}, clamped to ${this.currentStep} (max: ${v})`)}catch(s){console.error("Failed to load draft:",s),this.error=s.message||"Failed to load draft"}})},saveProgress(){return T(this,null,function*(){if(this.isSaving){console.log("[RequestStore] Save already in progress, skipping");return}this.currentRequestId&&!this.formData.request_id&&(console.warn("[RequestStore] Syncing request_id to formData"),this.formData.request_id=this.currentRequestId),console.log("[RequestStore] saveProgress called",{hasRequestId:!!this.currentRequestId,formDataHasId:!!this.formData.request_id,currentStep:this.currentStep,isSaving:this.isSaving}),this.isSaving=!0,this.error=null;try{const e={};for(const[n,m]of Object.entries(this.formData)){if(m instanceof File){console.warn(`[RequestStore] Skipping File object for key: ${n}`);continue}if(Array.isArray(m)&&m.length>0&&m.some(g=>g&&typeof g=="object"&&g.file_url)){const g=m[0].file_url;if(g&&typeof g=="string"){console.log(`[RequestStore] Converting file array to URL string for ${n}:`,g),e[n]=g;continue}else{console.warn(`[RequestStore] File array for ${n} does not have valid file_url, skipping`);continue}}m!=null&&(e[n]=m)}if(Object.keys(e).length===0&&!this.currentRequestId)throw new Error("No form data to save. Please fill in at least one field.");console.log("[RequestStore] Sending sanitized data with",Object.keys(e).length,"fields"),console.log("[RequestStore] Sanitized data keys:",Object.keys(e)),console.log("[RequestStore] Sanitized data:",JSON.stringify(e,null,2));const s=yield W.createDraft(e,this.currentStep);return this.currentRequestId||(this.currentRequestId=s.request_id,this.formData.request_id=s.request_id,localStorage.setItem("current_draft_id",s.request_id)),this.lastSaved=new Date,s}catch(e){throw console.error("Save failed:",e),this.error=e.message||"Failed to save progress",e}finally{this.isSaving=!1}})},saveDraft(){return T(this,null,function*(){return this.saveProgress()})},submitRequest(){return T(this,null,function*(){this.isSubmitting=!0,this.error=null;try{this.currentRequestId||(yield this.saveProgress());const e=yield W.submitRequest(this.currentRequestId);return this.reset(),e}catch(e){throw console.error("Submit failed:",e),this.error=e.message||"Failed to submit request",e}finally{this.isSubmitting=!1}})},updateField(e,s){this.formData[e]=s},updateFields(e){Object.assign(this.formData,e)},setStepValidation(e,s){this.stepValidationStatus[e]=s},clearError(){this.error=null},reset(){console.log("[RequestStore] reset() called - clearing all state"),this.currentRequestId=null,this.requestTypeCode=null,this.requestTypeConfig=null,Object.keys(this.formData).forEach(e=>{delete this.formData[e]}),this.formData={},this.currentStep=0,this.stepValidationStatus={},this.isSaving=!1,this.isSubmitting=!1,this.lastSaved=null,this.error=null,localStorage.removeItem("current_draft_id")}}});function Be(){const e=G(),s=Y(),n=$(!1),m=$(!1),v=$(!1),g=$(!1),c=$(null);function d(){v.value=!0}function p(h){console.log("Meeting booked:",h),v.value=!1}function k(h){m.value=!0}function o(){return T(this,null,function*(){try{yield s.saveDraft(),s.currentRequestId?e.push(`/request/${s.currentRequestId}`):n.value=!0}catch(h){console.error("Failed to save draft:",h)}})}function l(){return T(this,null,function*(){try{yield s.saveDraft(),s.reset(),e.push({name:"Dashboard"})}catch(h){console.error("Failed to save draft:",h)}})}function f(){return T(this,null,function*(){try{const h=yield s.submitRequest();c.value=h,g.value=!0}catch(h){console.error("Failed to submit request:",h)}})}function w(h){g.value=!1,e.push(`/request/${h}`)}function q(){g.value=!1;const h=s.formData.council;h?e.push(`/council/${h}/dashboard`):e.push("/dashboard")}return{showSaveDraftModal:n,showValidationModal:m,showMeetingModal:v,showSubmissionSuccessModal:g,submissionResult:c,handleBookMeeting:d,handleMeetingBooked:p,showValidationErrors:k,handleSaveDraft:o,handleSaveAndClose:l,handleSubmit:f,handleViewRequestFromModal:w,handleGoToDashboardFromModal:q}}function je(){const e=Y(),s=me(),n=S(()=>{var o;return(o=e.requestTypeConfig)!=null&&o.steps?e.requestTypeConfig.steps.length+3:3}),m=S(()=>{var l;const o=["Type","Process Info"];return(l=e.requestTypeConfig)!=null&&l.steps&&o.push(...e.requestTypeConfig.steps.map(f=>f.step_title)),o.push("Review"),o}),v=S(()=>{var o;return((o=e.requestTypeConfig)==null?void 0:o.steps)&&e.requestTypeConfig.steps.length>0}),g=S(()=>{var l;if(!((l=e.requestTypeConfig)!=null&&l.steps))return null;const o=e.currentStep-2;return o>=0&&o<e.requestTypeConfig.steps.length?e.requestTypeConfig.steps[o]:null}),c=S(()=>{var o;return e.currentStep>1&&e.currentStep<n.value-1&&((o=e.requestTypeConfig)==null?void 0:o.council_meeting_available)===1});function d(){const o=e.currentStep;return o>=0&&o<m.value.length?m.value[o]:""}function p(){var f;const o=e.currentStep,l=2;if(o<l||o>=n.value-1)return null;if((f=e.requestTypeConfig)!=null&&f.steps){const w=o-l;if(w>=0&&w<e.requestTypeConfig.steps.length)return e.requestTypeConfig.steps[w]}return null}function k(){var o;return((o=s.councilData)==null?void 0:o.council_name)||"Council"}return{totalSteps:n,stepTitles:m,usesConfigurableSteps:v,currentStepConfig:g,shouldShowMeetingBanner:c,getCurrentStepTitle:d,getCurrentStepConfig:p,getCouncilName:k}}function te(e,s){if(!e||e.trim()==="")return!0;let n=e.trim();n.startsWith("eval:")&&(n=n.substring(5).trim());try{return new Function("formData","doc",`
      'use strict';
      try {
        return Boolean(${n});
      } catch (e) {
        console.warn('[Conditional Logic] Evaluation error:', e.message);
        return false;
      }
    `)(s,s)}catch(m){return console.error("[Conditional Logic] Failed to evaluate expression:",e,m),!0}}function Oo(e,s){return!e||!e.is_enabled?!1:e.depends_on?te(e.depends_on,s):!0}function Ho(e,s){return e?e.depends_on?te(e.depends_on,s):!0:!1}function Ee(e){return e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e):!0}function ze(e){return e?/^[\+]?[(]?[0-9]{1,4}[)]?[-\s\.]?[(]?[0-9]{1,4}[)]?[-\s\.]?[0-9]{1,9}$/.test(e.replace(/\s/g,"")):!0}function Oe(e){if(!e)return!0;try{return new URL(e),!0}catch(s){return!1}}function He(e){return e===""||e===null||e===void 0?!0:!isNaN(Number.parseFloat(e))&&isFinite(e)}function Ue(e,s,n){let m=e.trim();m.startsWith("eval:")&&(m=m.substring(5).trim());try{return new Function("formData","value",`
			'use strict';
			try {
				return Boolean(${m});
			} catch (e) {
				console.warn('[Field Validation] Evaluation error:', e.message);
				return true; // Fail open on evaluation error
			}
		`)(n,s)}catch(v){return console.error("[Field Validation] Failed to evaluate expression:",e,v),!0}}function Ge(e,s,n={}){if(!s)return{valid:!0,message:""};switch(s.toLowerCase()){case"email":if(!Ee(e))return{valid:!1,message:"Please enter a valid email address"};break;case"phone":if(!ze(e))return{valid:!1,message:"Please enter a valid phone number"};break;case"url":if(!Oe(e))return{valid:!1,message:"Please enter a valid URL"};break;case"number":if(!He(e))return{valid:!1,message:"Please enter a valid number"};break;default:if(s.startsWith("eval:")&&!Ue(s,e,n))return{valid:!1,message:"Validation failed"}}return{valid:!0,message:""}}function Ye(){const e=$({}),s=$(!1);function n(d,p,k,o={}){const l=Ge(p,k.validation,o);return l.valid?k.is_required&&(p===""||p===null||p===void 0)?(e.value[d]=`${k.field_label} is required`,!1):(delete e.value[d],!0):(e.value[d]=l.message,!1)}function m(d,p){return T(this,null,function*(){s.value=!0,e.value={};let k=!0;for(const o of d.sections||[])if(!(o.depends_on&&!v(o.depends_on,p)))for(const l of o.fields||[]){if(l.depends_on&&!v(l.depends_on,p))continue;let f=p[l.field_name];if(["barangay","municipality","province","city","region","zip_code","postal_code"].includes(l.field_name)&&!f){const h=p.address_line||p.street||p.residential_address||p.property_address;h&&typeof h=="object"&&(f=h[l.field_name])}n(l.field_name,f,l,p)||(k=!1)}return s.value=!1,k})}function v(d,p){try{return te(d,p)}catch(k){return console.error("Error evaluating depends_on:",k),!0}}function g(){e.value={}}function c(d){delete e.value[d]}return{errors:e,isValidating:s,validateConfigField:n,validateStep:m,clearErrors:g,clearFieldError:c}}function We(e={}){const s=G(),n=Y(),{errors:m,validateStep:v}=Ye(),{getCurrentStepConfig:g=()=>null,totalSteps:c=S(()=>3),usesConfigurableSteps:d=S(()=>!1),onValidationError:p=()=>{}}=e,k=S(()=>!0),o=S(()=>n.currentStep>=2);function l(){return T(this,null,function*(){if(n.currentStep===0&&!n.formData.request_type){alert("Please select a request type before continuing.");return}if(n.currentStep>=1&&d.value&&g()){const q=g();if(!(yield v(q,n.formData))){console.error("[Navigation] Validation failed:",m.value),p(m.value);return}}if(n.currentStep===1&&!n.currentRequestId&&(console.log("[Navigation] Auto-saving draft after Process Info step..."),yield n.saveDraft(),console.log("[Navigation] Draft saved with ID:",n.currentRequestId),!d.value&&n.currentRequestId)){console.log("[Navigation] No dynamic steps, redirecting to detail page..."),s.push(`/request/${n.currentRequestId}`);return}n.currentRequestId&&(yield n.saveProgress()),n.currentStep<c.value-1&&n.nextStep()})}function f(){n.previousStep()}function w(){n.reset(),s.push("/dashboard")}return{canNavigateNext:k,canSaveDraft:o,validationErrors:m,handleNext:l,handlePrevious:f,goBack:w}}const C=$(null),K=$(!1),ee=$(null);function Je(){const e=()=>T(this,null,function*(){K.value=!0,ee.value=null;try{const o={"Content-Type":"application/json"};window.csrf_token&&(o["X-Frappe-CSRF-Token"]=window.csrf_token);const f=yield(yield fetch("/api/method/councilsonline.api.get_user_profile",{method:"GET",headers:o,credentials:"include"})).json();if(f.message)return C.value=f.message,C.value;throw new Error("Failed to load profile")}catch(o){return ee.value=o.message,console.error("Error loading user profile:",o),null}finally{K.value=!1}}),s=S(()=>{var o;return(o=C.value)!=null&&o.properties?C.value.properties.find(l=>l.is_default)||C.value.properties[0]:null}),n=S(()=>{var o;return(o=C.value)!=null&&o.councils?C.value.councils.find(l=>l.is_default)||C.value.councils[0]:null}),m=()=>{if(!C.value)return{};const o=C.value,l={};if(n.value&&(l.council=n.value.council_id,l.council_name=n.value.council_name),l.requester_name=o.full_name,l.requester_email=o.user,l.requester_phone=o.phone,l.requester_type=o.user_role,o.user_role==="Individual"&&o.postal_street&&(l.applicant_address=`${o.postal_street}, ${o.postal_suburb||""}, ${o.postal_city||""} ${o.postal_postcode||""}`.trim()),o.user_role==="Agent"&&(l.agent_required=!0,l.agent_id=o.user,l.agent_company=o.company_name,l.agent_email=o.business_email||o.user,l.agent_phone=o.business_phone||o.phone,o.business_street&&(l.agent_address=`${o.business_street}, ${o.business_suburb||""}, ${o.business_city||""} ${o.business_postcode||""}`.trim()),o.default_communication_route&&(l.correspondence_recipient=o.default_communication_route==="Agent Only"?"Agent":"Both"),o.default_invoice_recipient&&(l.invoice_responsible_party=o.default_invoice_recipient)),s.value){const f=s.value;l.property=`${f.street}, ${f.suburb||""}, ${f.city||""} ${f.postcode||""}`.trim(),l.property_address=l.property,l.property_legal_description=f.legal_description,l.ownership_status=f.ownership_status}return(o.comm_email||o.comm_phone||o.comm_post)&&(l.communication_preferences={email:o.comm_email||!1,phone:o.comm_phone||!1,post:o.comm_post||!1}),o.invoice_preference&&(l.invoice_delivery_method=o.invoice_preference),l},v=(o,l={})=>{const{overrideExisting:f=!1,fieldsToSkip:w=[]}=l,q=m();return Object.keys(q).forEach(h=>{w.includes(h)||!f&&o[h]||(o[h]=q[h])}),o},g=S(()=>{var o;return((o=C.value)==null?void 0:o.properties)||[]}),c=S(()=>{var o;return((o=C.value)==null?void 0:o.councils)||[]}),d=S(()=>{var o;return((o=C.value)==null?void 0:o.clients)||[]}),p=S(()=>{var f,w,q;if(!C.value)return!1;const o=C.value,l=o.full_name&&o.phone&&o.user_role;return o.user_role==="Individual"?l&&(((f=o.properties)==null?void 0:f.length)>0||!1)&&(((w=o.councils)==null?void 0:w.length)>0||!1):o.user_role==="Agent"?l&&o.company_name&&(((q=o.councils)==null?void 0:q.length)>0||!1):l}),k=S(()=>{if(!C.value)return 0;const o=C.value;let l=0,f=0;return["full_name","phone","user_role"].forEach(q=>{f++,o[q]&&l++}),f++,(o.comm_email||o.comm_phone||o.comm_post)&&l++,f++,o.properties&&o.properties.length>0&&l++,f++,o.councils&&o.councils.length>0&&l++,o.user_role==="Agent"?(f++,o.company_name&&l++):(f++,o.postal_street&&l++),Math.round(l/f*100)});return{userProfile:C,loading:K,error:ee,loadUserProfile:e,getApplicationAutoFill:m,applyAutoFill:v,defaultProperty:s,defaultCouncil:n,getAllProperties:g,getAllCouncils:c,getAllClients:d,isProfileComplete:p,profileCompletionPercentage:k}}function Ze(e={}){const s=Me();G();const n=Y(),m=me(),{onRequestTypeSelected:v=()=>{}}=e,g=$({loading:!1,data:[]}),c=$(null);function d(){return T(this,null,function*(){g.value.loading=!0,yield m.loadCouncil(),g.value={loading:!1,data:m.availableRequestTypes||[]}})}function p(f){return T(this,null,function*(){if(n.updateField("request_type",f),yield n.initialize(f),c.value=n.requestTypeConfig,!n.requestTypeConfig){console.error("[Lifecycle] Failed to load request type config");return}v(f)})}function k(){return T(this,null,function*(){const f=s.query.type,w=s.query.draft;if(console.log("[Lifecycle] Initialization - type:",f,"draft:",w),!w&&!s.query.draft&&n.reset(),!w){const{getApplicationAutoFill:q,applyAutoFill:h}=Je();try{yield q(),h(n.formData,{overrideExisting:!1})}catch(D){console.warn("[Lifecycle] Failed to load user profile for auto-fill:",D)}}if(w&&f){yield n.initialize(f,w),c.value=n.requestTypeConfig;return}yield d(),f&&!w&&(console.log("[Lifecycle] Request type provided in URL:",f),yield n.initialize(f),c.value=n.requestTypeConfig,n.updateField("request_type",f),n.currentStep=1,console.log("[Lifecycle] Advanced to step 1 (Process Info)"))})}function o(){Pe((f,w,q)=>{if(n.isSubmitting||!n.currentRequestId){n.reset(),q();return}n.formData&&Object.keys(n.formData).some(D=>n.formData[D]!==void 0&&n.formData[D]!==null&&n.formData[D]!=="")&&!confirm("You have unsaved changes. Do you want to leave without saving?")?q(!1):(f.path.includes("/request/")||n.reset(),q())})}function l(f){Ne(()=>n.formData.birth_date,w=>{var q;if(w&&((q=n.formData.request_type)!=null&&q.includes("SPISC"))){const h=new Date,D=new Date(w);let A=h.getFullYear()-D.getFullYear();const x=h.getMonth()-D.getMonth();(x<0||x===0&&h.getDate()<D.getDate())&&A--,n.updateField("age",A),A<60?f.value.birth_date="Applicant must be 60 years or older for SPISC":delete f.value.birth_date}})}return{requestTypes:g,selectedRequestTypeDetails:c,loadRequestTypes:d,selectRequestType:p,initialize:k,setupRouteGuard:o,setupAgeValidation:l}}const Qe={class:"mb-8"},Xe={class:"relative mb-6"},Ke={class:"overflow-hidden h-2 text-xs flex rounded bg-gray-200"},et={class:"flex justify-between mt-2"},tt={class:"text-sm font-medium text-gray-700"},st={class:"text-sm font-medium text-gray-700"},ot={__name:"RequestProgress",props:{currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0},stepTitles:{type:Array,default:()=>[]}},setup(e){const s=e,n=S(()=>s.totalSteps===0?0:Math.round((s.currentStep+1)/s.totalSteps*100));return(m,v)=>(a(),u("div",Qe,[t("div",Xe,[t("div",Ke,[t("div",{style:Fe({width:n.value+"%"}),class:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-600 transition-all duration-500"},null,4)]),t("div",et,[t("span",tt,b(e.stepTitles[e.currentStep]||`Step ${e.currentStep+1}`),1),t("span",st,b(n.value)+"% Complete ",1)])])]))}},nt={class:"mt-8 pt-6 border-t border-gray-200"},rt={class:"flex items-center justify-between"},at={class:"flex items-center space-x-3"},it={__name:"StepNavigation",props:{currentStep:{type:Number,required:!0},totalSteps:{type:Number,required:!0},isLastStep:{type:Boolean,default:!1},canGoNext:{type:Boolean,default:!0},canSaveDraft:{type:Boolean,default:!0},isSaving:{type:Boolean,default:!1},isSubmitting:{type:Boolean,default:!1}},emits:["next","previous","save-draft","submit"],setup(e,{emit:s}){const n=s,m=()=>{n("next")},v=()=>{n("previous")},g=()=>{n("save-draft")},c=()=>{n("submit")};return(d,p)=>(a(),u("div",nt,[t("div",rt,[t("div",null,[e.currentStep>0?(a(),B(i(E),{key:0,onClick:v,variant:"outline",disabled:e.isSaving||e.isSubmitting},{prefix:M(()=>[...p[0]||(p[0]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),default:M(()=>[p[1]||(p[1]=N(" Previous ",-1))]),_:1},8,["disabled"])):y("",!0)]),t("div",at,[e.canSaveDraft?(a(),B(i(E),{key:0,onClick:g,variant:"outline",loading:e.isSaving,disabled:e.isSubmitting},ce({default:M(()=>[N(" "+b(e.isSaving?"Saving...":"Save Draft"),1)]),_:2},[e.isSaving?void 0:{name:"prefix",fn:M(()=>[p[2]||(p[2]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})],-1))]),key:"0"}]),1032,["loading","disabled"])):y("",!0),e.isLastStep?(a(),B(i(E),{key:2,onClick:c,variant:"solid",theme:"green",loading:e.isSubmitting,disabled:!e.canGoNext||e.isSaving},ce({default:M(()=>[N(" "+b(e.isSubmitting?"Submitting...":"Submit Application"),1)]),_:2},[e.isSubmitting?void 0:{name:"prefix",fn:M(()=>[p[5]||(p[5]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1))]),key:"0"}]),1032,["loading","disabled"])):(a(),B(i(E),{key:1,onClick:m,variant:"solid",theme:"blue",disabled:!e.canGoNext||e.isSaving||e.isSubmitting},{suffix:M(()=>[...p[3]||(p[3]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])]),default:M(()=>[p[4]||(p[4]=N(" Next ",-1))]),_:1},8,["disabled"]))])]),p[6]||(p[6]=t("div",{class:"mt-4 text-center"},[t("p",{class:"text-sm text-gray-500"}," Your progress is automatically saved. You can return to complete this application later. ")],-1))]))}},lt={key:0,class:"text-center py-12"},ut={key:1,class:"grid md:grid-cols-2 gap-4"},dt=["onClick"],ct={class:"flex items-start justify-between"},mt={class:"flex-1"},ft={class:"text-lg font-semibold text-gray-900 mb-2"},pt=["innerHTML"],gt={class:"mt-4 flex items-center space-x-4 text-xs text-gray-500"},yt={key:0},vt={key:1},ht={key:2,class:"px-2 py-1 bg-gray-100 rounded"},bt={key:0,class:"ml-4"},xt={__name:"Step2RequestType",props:{modelValue:{type:Object,required:!0},requestTypes:{type:Object,required:!0}},emits:["update:modelValue","type-selected"],setup(e,{emit:s}){const n=e,m=s,v=g=>{console.log("[Step2RequestType] selectType called with:",g.name),console.log("[Step2RequestType] props.modelValue:",n.modelValue),console.log("[Step2RequestType] props.modelValue.council:",n.modelValue.council);const c=de(ue({},n.modelValue),{request_type:g.name});console.log("[Step2RequestType] Emitting updatedValue:",c),m("update:modelValue",c),m("type-selected",g.name)};return(g,c)=>(a(),u("div",null,[c[2]||(c[2]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Select Application Type",-1)),c[3]||(c[3]=t("p",{class:"text-gray-600 mb-8"},"Choose the type of consent you wish to apply for",-1)),e.requestTypes.loading?(a(),u("div",lt,[...c[0]||(c[0]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)])])):(a(),u("div",ut,[(a(!0),u(H,null,J(e.requestTypes.data,d=>(a(),u("div",{key:d.name,onClick:p=>v(d),class:F(["border-2 rounded-lg p-6 cursor-pointer transition-all hover:shadow-md",e.modelValue.request_type===d.name?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-300"])},[t("div",ct,[t("div",mt,[t("h3",ft,b(d.type_name),1),t("p",{class:"text-sm text-gray-600",innerHTML:d.description||"No description available"},null,8,pt),t("div",gt,[d.base_fee?(a(),u("span",yt,"Fee: $"+b(d.base_fee),1)):y("",!0),d.processing_sla_days?(a(),u("span",vt,b(d.processing_sla_days)+" days",1)):y("",!0),d.category?(a(),u("span",ht,b(d.category),1)):y("",!0)])]),e.modelValue.request_type===d.name?(a(),u("div",bt,[...c[1]||(c[1]=[t("div",{class:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center"},[t("svg",{class:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)])])):y("",!0)])],10,dt))),128))]))]))}},_t={class:"text-gray-600 mb-6"},wt={key:0,class:"space-y-6"},St={class:"bg-white border border-gray-200 rounded-lg p-6"},kt={class:"flex items-start justify-between mb-4"},qt={class:"text-xl font-semibold text-gray-900"},Vt={key:0,class:"text-sm text-gray-500 mt-1"},Ct={class:"grid md:grid-cols-3 gap-4 mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg"},Dt={class:"text-2xl font-bold text-blue-900 mt-1"},Tt={class:"text-2xl font-bold text-blue-900 mt-1"},Rt={class:"text-2xl font-bold text-blue-900 mt-1"},$t={key:0,class:"bg-white border border-gray-200 rounded-lg p-6"},Mt=["innerHTML"],Nt={key:1,class:"bg-white border border-gray-200 rounded-lg p-6"},Pt=["innerHTML"],Ft={key:1,class:"text-center py-12"},At={__name:"Step3ProcessInfo",props:{requestTypeDetails:{type:Object,default:null},councilName:{type:String,default:""},modelValue:{type:Object,default:()=>({})}},emits:["continue","update:modelValue"],setup(e,{emit:s}){const n=G(),m=s,v=()=>{if(!Le.isLoggedIn){const g=window.location.pathname+window.location.search;n.push({name:"Login",query:{redirect:g}});return}m("continue")};return(g,c)=>(a(),u("div",null,[c[11]||(c[11]=t("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Council Process Information",-1)),t("p",_t,"Understanding "+b(e.councilName)+"'s process for this application",1),e.requestTypeDetails?(a(),u("div",wt,[t("div",St,[t("div",kt,[t("div",null,[t("h3",qt,b(e.requestTypeDetails.request_type_name),1),e.requestTypeDetails.category?(a(),u("p",Vt,b(e.requestTypeDetails.category),1)):y("",!0)])]),t("div",Ct,[t("div",null,[c[0]||(c[0]=t("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Application Fee",-1)),t("div",Dt," $"+b(e.requestTypeDetails.base_fee||"0"),1),c[1]||(c[1]=t("div",{class:"text-xs text-blue-600 mt-1"},"Plus any additional costs",-1))]),t("div",null,[c[3]||(c[3]=t("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Processing Time",-1)),t("div",Tt,[N(b(e.requestTypeDetails.sla_days||"N/A")+" ",1),c[2]||(c[2]=t("span",{class:"text-base"},"days",-1))]),c[4]||(c[4]=t("div",{class:"text-xs text-blue-600 mt-1"},"Standard timeframe",-1))]),t("div",null,[c[5]||(c[5]=t("div",{class:"text-xs text-blue-600 font-medium uppercase"},"Payment Required",-1)),t("div",Rt,b(e.requestTypeDetails.requires_payment?"Yes":"No"),1),c[6]||(c[6]=t("div",{class:"text-xs text-blue-600 mt-1"},"Before processing",-1))])])]),e.requestTypeDetails.process_description?(a(),u("div",$t,[c[7]||(c[7]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"How This Works",-1)),t("div",{class:"prose prose-sm max-w-none text-gray-700",innerHTML:e.requestTypeDetails.process_description},null,8,Mt)])):e.requestTypeDetails.description?(a(),u("div",Nt,[c[8]||(c[8]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"About This Application",-1)),t("div",{class:"prose prose-sm max-w-none text-gray-700",innerHTML:e.requestTypeDetails.description},null,8,Pt)])):y("",!0),c[9]||(c[9]=U('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4"><div class="flex items-start"><svg class="w-5 h-5 text-yellow-600 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg><div><h5 class="font-semibold text-yellow-900 text-sm">Before You Continue</h5><p class="text-yellow-800 text-sm mt-1"> Please review this information carefully. Make sure you understand the process, fees, and timeframes before proceeding with your application. </p></div></div></div>',1)),t("div",{class:"flex justify-center pt-4"},[t("button",{type:"button",onClick:v,class:"px-8 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors"}," I Understand - Continue to Application ")])])):(a(),u("div",Ft,[...c[10]||(c[10]=[t("p",{class:"text-gray-500"},"No request type selected. Please go back and select a request type.",-1)])]))]))}},Lt={class:"px-4 sm:px-0"},It={class:"space-y-4 sm:space-y-6"},Bt={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 sm:p-6"},jt={class:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-0"},Et={class:"text-base sm:text-lg font-semibold text-blue-900"},zt={class:"text-xs sm:text-sm text-blue-700 mt-1"},Ot={class:"sm:text-right"},Ht={class:"text-xl sm:text-2xl font-bold text-blue-900"},Ut={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Gt={class:"p-4 sm:p-6 space-y-3"},Yt={class:"grid md:grid-cols-2 gap-4"},Wt={class:"font-medium"},Jt={class:"font-medium"},Zt={class:"font-medium"},Qt={key:0},Xt={class:"font-medium"},Kt={key:0,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},es={class:"p-4 sm:p-6"},ts={key:0,class:"space-y-2"},ss={class:"font-medium"},os={key:0},ns={class:"font-medium"},rs={key:1,class:"text-gray-500"},as={key:1,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},is={class:"p-4 sm:p-6 space-y-3"},ls={class:"font-medium"},us={class:"font-medium"},ds={class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},cs={class:"font-semibold text-gray-900 text-sm sm:text-base"},ms={class:"p-4 sm:p-6 space-y-4"},fs={key:0,class:"text-sm font-medium text-gray-700 mb-2"},ps={class:"grid md:grid-cols-2 gap-4"},gs={class:"text-sm text-gray-500"},ys={class:"font-medium"},vs={key:0,class:"text-gray-500 text-sm"},hs={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},bs={class:"p-4 sm:p-6"},xs={class:"space-y-3"},_s={class:"mt-2 flex flex-wrap gap-2"},ws={key:0,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium"},Ss={key:1,class:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},ks={key:2,class:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-medium"},qs={key:3,class:"px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full text-sm font-medium"},Vs={key:4,class:"px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-sm font-medium"},Cs={key:5,class:"text-gray-500"},Ds={class:"mt-1 inline-flex items-center"},Ts={key:0},Rs={class:"font-medium break-words"},$s={key:0,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Ms={class:"p-4 sm:p-6"},Ns={class:"flex flex-wrap gap-2"},Ps={key:0,class:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Fs={key:1,class:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},As={key:2,class:"px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Ls={key:3,class:"px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full text-sm font-medium inline-flex items-center gap-1"},Is={key:1,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Bs={class:"p-4 sm:p-6"},js={class:"space-y-3"},Es={class:"font-medium"},zs={key:0},Os={class:"text-sm mt-1 line-clamp-3"},Hs={key:1},Us={class:"text-sm mt-1 line-clamp-3"},Gs={class:"flex items-center gap-2"},Ys={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},Ws={class:"p-4 sm:p-6"},Js={class:"space-y-4"},Zs={key:0},Qs=["innerHTML"],Xs={key:1},Ks=["innerHTML"],eo={key:2},to={class:"text-sm mt-1 line-clamp-3"},so={key:3},oo={class:"text-sm mt-1 space-y-1 list-disc list-inside"},no={key:0},ro={key:1},ao={key:2},io={key:4},lo=["innerHTML"],uo={key:5,class:"text-gray-500 text-sm"},co={class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},mo={class:"p-4 sm:p-6"},fo={class:"space-y-2"},po={class:"flex items-start gap-2"},go={class:"flex items-start gap-2"},yo={class:"flex items-start gap-2"},vo={key:0,class:"mt-4 pt-4 border-t border-gray-200"},ho={class:"font-medium"},bo={key:0,class:"text-sm text-gray-500"},xo={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},_o={__name:"ReviewStep",props:{modelValue:{type:Object,required:!0},councilName:{type:String,default:"Council"},requestTypeName:{type:String,default:"Application"},applicationFee:{type:String,default:"TBD"},isResourceConsent:{type:Boolean,default:!1},stepConfigs:{type:Array,default:()=>[]},usesConfigurableSteps:{type:Boolean,default:!1},requestTypeDetails:{type:Object,default:null}},setup(e){const s=e,n=S(()=>s.modelValue.requester_name||s.modelValue.full_name||s.modelValue.applicant_name||null),m=S(()=>s.modelValue.requester_email||s.modelValue.email||s.modelValue.applicant_email||null),v=S(()=>s.modelValue.requester_phone||s.modelValue.mobile_number||s.modelValue.phone||s.modelValue.applicant_phone||null),g=S(()=>!s.usesConfigurableSteps||!s.stepConfigs?[]:s.stepConfigs.filter(x=>x.show_on_review)),c=S(()=>s.isResourceConsent?!0:!!(s.modelValue.property||s.modelValue.property_address)),d=x=>{if(!x.sections)return!1;for(const r of x.sections)if(r.show_on_review){for(const R of r.fields)if(R.show_on_review&&s.modelValue[R.field_name])return!0}return!1},p=(x,r)=>{if(r==null||r==="")return"Not provided";if(x.field_type==="Check")return r?"Yes":"No";if(x.field_type==="Date"&&r)try{return new Date(r).toLocaleDateString("en-NZ",{year:"numeric",month:"long",day:"numeric"})}catch(R){return r}return x.field_type==="Currency"&&r?`₱${Number(r).toLocaleString("en-PH",{minimumFractionDigits:2,maximumFractionDigits:2})}`:x.field_type==="Select"?r:x.field_type==="Attach"||x.field_type==="Attach Image"?r?"✓ File attached":"Not provided":r},k=S(()=>!!(s.modelValue.consent_type_land_use||s.modelValue.consent_type_subdivision||s.modelValue.consent_type_discharge||s.modelValue.consent_type_water||s.modelValue.consent_type_coastal)),o=S(()=>{const x=s.modelValue.activity_status_type;return x==="Permitted"?"bg-green-100 text-green-800":x==="Controlled"?"bg-blue-100 text-blue-800":x==="Restricted Discretionary"?"bg-yellow-100 text-yellow-800":x==="Discretionary"?"bg-orange-100 text-orange-800":x==="Non-Complying"?"bg-red-100 text-red-800":x==="Prohibited"?"bg-gray-800 text-white":"bg-gray-100 text-gray-800"}),l=S(()=>!!(s.modelValue.hazard_flooding||s.modelValue.hazard_earthquake||s.modelValue.hazard_landslip||s.modelValue.hazard_coastal)),f=S(()=>!!(s.modelValue.consultation_undertaken||s.modelValue.consultation_summary||s.modelValue.affected_parties_details||s.modelValue.written_approvals_obtained)),w=S(()=>!!(s.modelValue.activity_description||s.modelValue.aee_full_assessment||s.modelValue.positive_effects_description||s.modelValue.effects_visual_amenity||s.modelValue.effects_traffic_parking||s.modelValue.effects_noise||s.modelValue.mitigation_measures||s.modelValue.aee_activity_description||s.modelValue.aee_existing_environment||s.modelValue.assessment_of_effects||s.modelValue.aee_document)),q=x=>{if(!x)return"";const r=document.createElement("div");return r.innerHTML=x,r.textContent||r.innerText||""},h=(x,r)=>{if(!x)return"";const R=q(x);return R.length<=r?R:R.substring(0,r)+"..."},D=x=>{if(!x)return"";try{return new Date(x).toLocaleDateString("en-NZ",{year:"numeric",month:"long",day:"numeric"})}catch(r){return x}},A=S(()=>{const x=!!(s.modelValue.council&&s.modelValue.request_type&&s.modelValue.requester_name&&s.modelValue.requester_email&&s.modelValue.property_address&&s.modelValue.delivery_preference);if(s.isResourceConsent){const r=!!(k.value&&s.modelValue.activity_status_type&&s.modelValue.activity_description&&s.modelValue.aee_full_assessment&&s.modelValue.declaration_accuracy&&s.modelValue.declaration_authority&&s.modelValue.declaration_acknowledgment);return x&&r}return x});return(x,r)=>{var R;return a(),u("div",Lt,[r[39]||(r[39]=t("h2",{class:"text-xl sm:text-2xl font-bold text-gray-900 mb-2"},"Review & Submit",-1)),r[40]||(r[40]=t("p",{class:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8"},"Review your application details before submitting",-1)),t("div",It,[t("div",Bt,[t("div",jt,[t("div",null,[t("h3",Et,b(e.requestTypeName),1),t("p",zt,b(e.councilName),1)]),t("div",Ot,[r[0]||(r[0]=t("div",{class:"text-xs sm:text-sm text-blue-600 font-medium"},"Application Fee",-1)),t("div",Ht,b(e.applicationFee),1)])])]),t("div",Ut,[r[5]||(r[5]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Applicant Details")],-1)),t("div",Gt,[t("div",Yt,[t("div",null,[r[1]||(r[1]=t("span",{class:"text-sm text-gray-500"},"Name:",-1)),t("p",Wt,b(n.value||"Not provided"),1)]),t("div",null,[r[2]||(r[2]=t("span",{class:"text-sm text-gray-500"},"Email:",-1)),t("p",Jt,b(m.value||"Not provided"),1)]),t("div",null,[r[3]||(r[3]=t("span",{class:"text-sm text-gray-500"},"Phone:",-1)),t("p",Zt,b(v.value||"Not provided"),1)]),e.modelValue.applicant_company?(a(),u("div",Qt,[r[4]||(r[4]=t("span",{class:"text-sm text-gray-500"},"Company:",-1)),t("p",Xt,b(e.modelValue.applicant_company),1)])):y("",!0)])])]),c.value?(a(),u("div",Kt,[r[8]||(r[8]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Property Details")],-1)),t("div",es,[e.modelValue.property_address?(a(),u("div",ts,[t("div",null,[r[6]||(r[6]=t("span",{class:"text-sm text-gray-500"},"Address:",-1)),t("p",ss,b(e.modelValue.property_address),1)]),e.modelValue.legal_description?(a(),u("div",os,[r[7]||(r[7]=t("span",{class:"text-sm text-gray-500"},"Legal Description:",-1)),t("p",ns,b(e.modelValue.legal_description),1)])):y("",!0)])):(a(),u("p",rs,"No property selected"))])])):y("",!0),(R=e.requestTypeDetails)!=null&&R.collect_payment?(a(),u("div",as,[r[11]||(r[11]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Delivery & Payment")],-1)),t("div",is,[t("div",null,[r[9]||(r[9]=t("span",{class:"text-sm text-gray-500"},"Delivery Preference:",-1)),t("p",ls,b(e.modelValue.delivery_preference||"Not selected"),1)]),t("div",null,[r[10]||(r[10]=t("span",{class:"text-sm text-gray-500"},"Invoice To:",-1)),t("p",us,b(e.modelValue.invoice_to||"Not specified"),1)])])])):y("",!0),e.usesConfigurableSteps&&g.value.length>0?(a(!0),u(H,{key:2},J(g.value,j=>(a(),u("div",{key:j.step_code,class:"bg-white border border-gray-200 rounded-lg overflow-hidden"},[t("div",ds,[t("h3",cs,b(j.step_title),1)]),t("div",ms,[(a(!0),u(H,null,J(j.sections.filter(L=>L.show_on_review),L=>(a(),u("div",{key:L.section_code},[L.section_title?(a(),u("h4",fs,b(L.section_title),1)):y("",!0),t("div",ps,[(a(!0),u(H,null,J(L.fields.filter(I=>I.show_on_review),I=>(a(),u("div",{key:I.field_name},[t("span",gs,b(I.review_label||I.field_label)+":",1),t("p",ys,b(p(I,e.modelValue[I.field_name])),1)]))),128))])]))),128)),d(j)?y("",!0):(a(),u("p",vs," No information to display for review "))])]))),128)):y("",!0),e.isResourceConsent?(a(),u(H,{key:3},[t("div",hs,[r[15]||(r[15]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Consent Types & Activity Status")],-1)),t("div",bs,[t("div",xs,[t("div",null,[r[12]||(r[12]=t("span",{class:"text-sm text-gray-500"},"Consent Types:",-1)),t("div",_s,[e.modelValue.consent_type_land_use?(a(),u("span",ws," Land Use Consent ")):y("",!0),e.modelValue.consent_type_subdivision?(a(),u("span",Ss," Subdivision Consent ")):y("",!0),e.modelValue.consent_type_discharge?(a(),u("span",ks," Discharge Permit ")):y("",!0),e.modelValue.consent_type_water?(a(),u("span",qs," Water Permit ")):y("",!0),e.modelValue.consent_type_coastal?(a(),u("span",Vs," Coastal Permit ")):y("",!0),k.value?y("",!0):(a(),u("span",Cs," None selected "))])]),t("div",null,[r[13]||(r[13]=t("span",{class:"text-sm text-gray-500"},"Activity Status:",-1)),t("div",Ds,[t("span",{class:F(["px-3 py-1 rounded-full text-sm font-medium",o.value])},b(e.modelValue.activity_status_type||"Not specified"),3)])]),e.modelValue.activity_title?(a(),u("div",Ts,[r[14]||(r[14]=t("span",{class:"text-sm text-gray-500"},"Activity Title:",-1)),t("p",Rs,b(e.modelValue.activity_title),1)])):y("",!0)])])]),l.value?(a(),u("div",$s,[r[20]||(r[20]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Natural Hazards")],-1)),t("div",Ms,[t("div",Ns,[e.modelValue.hazard_flooding?(a(),u("span",Ps,[...r[16]||(r[16]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707"})],-1),N(" Flood Hazard ",-1)])])):y("",!0),e.modelValue.hazard_earthquake?(a(),u("span",Fs,[...r[17]||(r[17]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),N(" Earthquake/Fault Line ",-1)])])):y("",!0),e.modelValue.hazard_landslip?(a(),u("span",As,[...r[18]||(r[18]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1),N(" Landslip/Slope Instability ",-1)])])):y("",!0),e.modelValue.hazard_coastal?(a(),u("span",Ls,[...r[19]||(r[19]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7l-2 1m2-1l-2-1m2 1v2.5M14 4l-2-1-2 1M4 7l2-1M4 7l2 1M4 7v2.5"})],-1),N(" Coastal Hazard ",-1)])])):y("",!0)])])])):y("",!0),f.value?(a(),u("div",Is,[r[25]||(r[25]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Consultation & Affected Parties")],-1)),t("div",Bs,[t("div",js,[t("div",null,[r[21]||(r[21]=t("span",{class:"text-sm text-gray-500"},"Consultation Undertaken:",-1)),t("p",Es,b(e.modelValue.consultation_undertaken||"Not specified"),1)]),e.modelValue.consultation_summary?(a(),u("div",zs,[r[22]||(r[22]=t("span",{class:"text-sm text-gray-500"},"Consultation Summary:",-1)),t("p",Os,b(e.modelValue.consultation_summary),1)])):y("",!0),e.modelValue.affected_parties_details?(a(),u("div",Hs,[r[23]||(r[23]=t("span",{class:"text-sm text-gray-500"},"Affected Parties:",-1)),t("p",Us,b(q(e.modelValue.affected_parties_details)),1)])):y("",!0),t("div",Gs,[(a(),u("svg",{class:F(["w-5 h-5",e.modelValue.written_approvals_obtained?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[24]||(r[24]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:F(e.modelValue.written_approvals_obtained?"text-gray-900":"text-gray-500")}," Written Approvals "+b(e.modelValue.written_approvals_obtained?"Obtained":"Not Obtained"),3)])])])])):y("",!0),t("div",Ys,[r[31]||(r[31]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Assessment of Environmental Effects")],-1)),t("div",Ws,[t("div",Js,[e.modelValue.activity_description?(a(),u("div",Zs,[r[26]||(r[26]=t("span",{class:"text-sm text-gray-500"},"Activity Description:",-1)),t("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:e.modelValue.activity_description},null,8,Qs)])):y("",!0),e.modelValue.aee_full_assessment?(a(),u("div",Xs,[r[27]||(r[27]=t("span",{class:"text-sm text-gray-500"},"Full Assessment:",-1)),t("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:e.modelValue.aee_full_assessment},null,8,Ks)])):y("",!0),e.modelValue.positive_effects_description?(a(),u("div",eo,[r[28]||(r[28]=t("span",{class:"text-sm text-gray-500"},"Positive Effects:",-1)),t("p",to,b(e.modelValue.positive_effects_description),1)])):y("",!0),e.modelValue.effects_visual_amenity||e.modelValue.effects_traffic_parking||e.modelValue.effects_noise?(a(),u("div",so,[r[29]||(r[29]=t("span",{class:"text-sm text-gray-500"},"Adverse Effects Summary:",-1)),t("ul",oo,[e.modelValue.effects_visual_amenity?(a(),u("li",no,"Visual/Amenity: "+b(h(e.modelValue.effects_visual_amenity,50)),1)):y("",!0),e.modelValue.effects_traffic_parking?(a(),u("li",ro,"Traffic/Parking: "+b(h(e.modelValue.effects_traffic_parking,50)),1)):y("",!0),e.modelValue.effects_noise?(a(),u("li",ao,"Noise: "+b(h(e.modelValue.effects_noise,50)),1)):y("",!0)])])):y("",!0),e.modelValue.mitigation_measures?(a(),u("div",io,[r[30]||(r[30]=t("span",{class:"text-sm text-gray-500"},"Mitigation Measures:",-1)),t("div",{class:"text-sm mt-1 line-clamp-3",innerHTML:e.modelValue.mitigation_measures},null,8,lo)])):y("",!0),w.value?y("",!0):(a(),u("p",uo," AEE not yet completed "))])])]),t("div",co,[r[36]||(r[36]=t("div",{class:"bg-gray-50 px-4 sm:px-6 py-3 border-b border-gray-200"},[t("h3",{class:"font-semibold text-gray-900 text-sm sm:text-base"},"Statutory Declarations")],-1)),t("div",mo,[t("div",fo,[t("div",po,[(a(),u("svg",{class:F(["w-5 h-5 flex-shrink-0 mt-0.5",e.modelValue.declaration_accuracy||e.modelValue.declaration_rma_compliance?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[32]||(r[32]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:F(["text-sm",e.modelValue.declaration_accuracy||e.modelValue.declaration_rma_compliance?"text-gray-900":"text-gray-500"])}," Declaration of Accuracy & RMA Compliance ",2)]),t("div",go,[(a(),u("svg",{class:F(["w-5 h-5 flex-shrink-0 mt-0.5",e.modelValue.declaration_authority||e.modelValue.declaration_authorized?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[33]||(r[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:F(["text-sm",e.modelValue.declaration_authority||e.modelValue.declaration_authorized?"text-gray-900":"text-gray-500"])}," Declaration of Authority to Apply ",2)]),t("div",yo,[(a(),u("svg",{class:F(["w-5 h-5 flex-shrink-0 mt-0.5",e.modelValue.declaration_acknowledgment||e.modelValue.declaration_public_information?"text-green-600":"text-gray-400"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...r[34]||(r[34]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])],2)),t("span",{class:F(["text-sm",e.modelValue.declaration_acknowledgment||e.modelValue.declaration_public_information?"text-gray-900":"text-gray-500"])}," Public Information & Privacy Acknowledgment ",2)]),e.modelValue.requester_signature?(a(),u("div",vo,[r[35]||(r[35]=t("span",{class:"text-sm text-gray-500"},"Signed by:",-1)),t("p",ho,b(e.modelValue.requester_signature),1),e.modelValue.signature_date?(a(),u("p",bo," Date: "+b(D(e.modelValue.signature_date)),1)):y("",!0)])):y("",!0)])])])],64)):y("",!0),r[38]||(r[38]=U('<div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 sm:p-6" data-v-baae8edc><div class="flex items-start gap-2 sm:gap-3" data-v-baae8edc><svg class="w-5 h-5 sm:w-6 sm:h-6 text-yellow-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-baae8edc><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-baae8edc></path></svg><div data-v-baae8edc><h4 class="font-semibold text-yellow-900 text-sm sm:text-base" data-v-baae8edc>Before You Submit</h4><ul class="mt-2 text-xs sm:text-sm text-yellow-800 space-y-1 list-disc list-inside" data-v-baae8edc><li data-v-baae8edc>Review all information carefully for accuracy and completeness</li><li data-v-baae8edc>Ensure all required fields are completed</li><li data-v-baae8edc>For Resource Consent applications, verify all statutory declarations are confirmed</li><li data-v-baae8edc>Once submitted, you cannot edit the application (you may need to withdraw and resubmit)</li></ul></div></div></div>',1)),A.value?y("",!0):(a(),u("div",xo,[...r[37]||(r[37]=[U('<div class="flex items-start gap-2 sm:gap-3" data-v-baae8edc><svg class="w-5 h-5 text-red-600 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-baae8edc><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" data-v-baae8edc></path></svg><div data-v-baae8edc><h5 class="font-semibold text-red-900 text-xs sm:text-sm" data-v-baae8edc>Application Incomplete</h5><p class="text-red-800 text-xs sm:text-sm mt-1" data-v-baae8edc> Please complete all required sections before submitting. Use the Previous button to go back and fill in missing information. </p></div></div>',1)])]))])])}}},wo=Re(_o,[["__scopeId","data-v-baae8edc"]]),So={class:"min-h-screen bg-gray-50"},ko={class:"bg-white border-b border-gray-200"},qo={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},Vo={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Co={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-8"},Do={key:0},To={key:1},Ro={key:2},$o={key:4,class:"text-center py-12"},Mo={class:"flex gap-3 justify-center"},No={key:0,class:"mt-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6 shadow-sm"},Po={class:"flex items-start justify-between"},Fo={class:"flex-1"},Ao={__name:"NewRequest",setup(e){const s=O(()=>z(()=>import("./SaveDraftModal-CSep5FJ8.js"),__vite__mapDeps([0,1,2,3,4]))),n=O(()=>z(()=>import("./ValidationErrorModal-DAknucdX.js"),__vite__mapDeps([5,1,2,3,4]))),m=O(()=>z(()=>import("./BookMeetingModal-DAzWoozx.js"),__vite__mapDeps([6,2,1,3,4]))),v=O(()=>z(()=>import("./SubmissionSuccessModal-Cr8b_Xku.js"),__vite__mapDeps([7,1,2,3,4,8]))),g=O(()=>z(()=>import("./DynamicStepRenderer-B3q79Kbn.js"),__vite__mapDeps([9,2,1,3,4,10,11,12,13,14]))),c=G(),d=Y(),{totalSteps:p,stepTitles:k,usesConfigurableSteps:o,shouldShowMeetingBanner:l,getCurrentStepTitle:f,getCurrentStepConfig:w,getCouncilName:q}=je(),{showSaveDraftModal:h,showValidationModal:D,showMeetingModal:A,showSubmissionSuccessModal:x,submissionResult:r,handleBookMeeting:R,handleMeetingBooked:j,handleSaveDraft:L,handleSaveAndClose:I,handleSubmit:fe,handleViewRequestFromModal:pe,handleGoToDashboardFromModal:ge}=Be(),{canNavigateNext:ye,canSaveDraft:Z,validationErrors:se,handleNext:oe,handlePrevious:Q,goBack:ve}=We({getCurrentStepConfig:w,totalSteps:p,usesConfigurableSteps:o,onValidationError:()=>{D.value=!0}}),{requestTypes:he,selectedRequestTypeDetails:be,selectRequestType:xe,initialize:_e,setupRouteGuard:we,setupAgeValidation:Se}=Ze();return we(),Se(se),Ae(()=>{_e()}),(ke,_)=>{var ne,re,ae;return a(),u("div",So,[P(Ie,{title:"New Application",onBack:i(ve)},{actions:M(()=>[i(Z)?(a(),B(i(E),{key:0,onClick:i(L),variant:"outline",theme:"gray",loading:i(d).isSaving},{default:M(()=>[..._[12]||(_[12]=[N(" Save Draft ",-1)])]),_:1},8,["onClick","loading"])):y("",!0),i(Z)?(a(),B(i(E),{key:1,onClick:i(I),variant:"outline",theme:"gray",loading:i(d).isSaving},{default:M(()=>[..._[13]||(_[13]=[N(" Save and Close ",-1)])]),_:1},8,["onClick","loading"])):y("",!0)]),_:1},8,["onBack"]),t("div",ko,[t("div",qo,[P(ot,{"current-step":i(d).currentStep,"total-steps":i(p),"step-titles":i(k)},null,8,["current-step","total-steps","step-titles"])])]),t("main",Vo,[t("div",Co,[i(f)()==="Type"?(a(),u("div",Do,[P(xt,{modelValue:i(d).formData,"onUpdate:modelValue":_[0]||(_[0]=V=>i(d).formData=V),"request-types":i(he),onTypeSelected:i(xe)},null,8,["modelValue","request-types","onTypeSelected"])])):i(f)()==="Process Info"?(a(),u("div",To,[P(At,{"request-type-details":i(be),"council-name":i(q)(),modelValue:i(d).formData,"onUpdate:modelValue":_[1]||(_[1]=V=>i(d).formData=V),onContinue:i(oe)},null,8,["request-type-details","council-name","modelValue","onContinue"])])):i(d).currentStep>=i(p)-1?(a(),u("div",Ro,[P(wo,{modelValue:i(d).formData,"onUpdate:modelValue":_[2]||(_[2]=V=>i(d).formData=V),"request-type-config":i(d).requestTypeConfig},null,8,["modelValue","request-type-config"])])):i(o)&&i(w)()?(a(),B(i(g),{key:3,stepConfig:i(w)(),modelValue:i(d).formData,"onUpdate:modelValue":_[3]||(_[3]=V=>i(d).formData=V)},null,8,["stepConfig","modelValue"])):(a(),u("div",$o,[_[14]||(_[14]=U('<div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4"><svg class="h-8 w-8 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">Unable to Load This Step</h3><p class="text-sm text-gray-600 mb-6"> We&#39;re having trouble loading this step. Please try refreshing or go back to continue your application. </p>',3)),t("div",Mo,[t("button",{onClick:_[4]||(_[4]=V=>ke.location.reload()),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition"}," Refresh Page "),t("button",{onClick:_[5]||(_[5]=(...V)=>i(Q)&&i(Q)(...V)),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition"}," Go Back "),t("button",{onClick:_[6]||(_[6]=V=>i(c).push("/dashboard")),class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition"}," Return to Dashboard ")])]))]),i(l)?(a(),u("div",No,[t("div",Po,[t("div",Fo,[_[15]||(_[15]=U('<div class="flex items-center gap-2 mb-2"><svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg><h3 class="text-lg font-semibold text-gray-900">Council Meeting Available</h3></div><p class="text-sm text-gray-700 mb-3"> Schedule a meeting with council planners to discuss your application before submitting. This optional step can help clarify requirements and improve your application. </p>',2)),t("button",{onClick:_[7]||(_[7]=(...V)=>i(R)&&i(R)(...V)),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium"}," Request Council Meeting ")])])])):y("",!0),P(it,{"current-step":i(d).currentStep,"total-steps":i(p),"is-last-step":i(d).isLastStep,"can-go-next":i(ye),"can-save-draft":i(Z),"is-saving":i(d).isSaving,"is-submitting":i(d).isSubmitting,onNext:i(oe),onPrevious:i(Q),onSaveDraft:i(L),onSubmit:i(fe)},null,8,["current-step","total-steps","is-last-step","can-go-next","can-save-draft","is-saving","is-submitting","onNext","onPrevious","onSaveDraft","onSubmit"])]),P(i(s),{show:i(h),"onUpdate:show":_[8]||(_[8]=V=>X(h)?h.value=V:null),"draft-id":i(d).currentRequestId},null,8,["show","draft-id"]),P(i(n),{show:i(D),"onUpdate:show":_[9]||(_[9]=V=>X(D)?D.value=V:null),errors:i(se)},null,8,["show","errors"]),P(i(m),{show:i(A),"onUpdate:show":_[10]||(_[10]=V=>X(A)?A.value=V:null),"request-id":i(d).currentRequestId,"request-type-code":i(d).formData.request_type,"council-code":i(d).formData.council,onBooked:i(j)},null,8,["show","request-id","request-type-code","council-code","onBooked"]),P(i(v),{open:i(x),"request-number":(ne=i(r))==null?void 0:ne.request_number,"request-id":(re=i(r))==null?void 0:re.request_id,"sla-info":(ae=i(r))==null?void 0:ae.sla_info,onClose:_[11]||(_[11]=V=>x.value=!1),onViewRequest:i(pe),onGoToDashboard:i(ge)},null,8,["open","request-number","request-id","sla-info","onViewRequest","onGoToDashboard"])])}}},Uo=Object.freeze(Object.defineProperty({__proto__:null,default:Ao},Symbol.toStringTag,{value:"Module"}));export{Uo as N,Ye as a,Oo as b,Ho as i,Je as u};
//# sourceMappingURL=NewRequest-80Fso0PJ.js.map
